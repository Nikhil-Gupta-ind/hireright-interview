const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Welcome-DC8ELD-4.js","assets/logo-Dwo1ZigQ.js","assets/icon-arrow-forward-EkO6fcUb.js","assets/session-CrLfDL4Y.js","assets/DeviceSetup-oJ8QZgtE.js","assets/Interview-F-x5qzTf.js","assets/TimeoutScreen-BstQl5j9.js","assets/Gradient-BsVXDp_j.js","assets/GuidelinesScreen-BwtHJYIp.js","assets/Feedback-B2fP9KGz.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}})();function qk(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Vd={exports:{}},Ns={};var Fv;function Vk(){if(Fv)return Ns;Fv=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var u in o)u!=="key"&&(c[u]=o[u])}else c=o;return o=c.ref,{$$typeof:i,type:r,key:d,ref:o!==void 0?o:null,props:c}}return Ns.Fragment=e,Ns.jsx=n,Ns.jsxs=n,Ns}var Hv;function Fk(){return Hv||(Hv=1,Vd.exports=Vk()),Vd.exports}var Ce=Fk(),Fd={exports:{}},ye={};var Gv;function Hk(){if(Gv)return ye;Gv=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function T(P){return P===null||typeof P!="object"?null:(P=b&&P[b]||P["@@iterator"],typeof P=="function"?P:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,M={};function R(P,X,se){this.props=P,this.context=X,this.refs=M,this.updater=se||_}R.prototype.isReactComponent={},R.prototype.setState=function(P,X){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,X,"setState")},R.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function B(){}B.prototype=R.prototype;function q(P,X,se){this.props=P,this.context=X,this.refs=M,this.updater=se||_}var E=q.prototype=new B;E.constructor=q,C(E,R.prototype),E.isPureReactComponent=!0;var k=Array.isArray;function D(){}var L={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function G(P,X,se){var oe=se.ref;return{$$typeof:i,type:P,key:X,ref:oe!==void 0?oe:null,props:se}}function Q(P,X){return G(P.type,X,P.props)}function W(P){return typeof P=="object"&&P!==null&&P.$$typeof===i}function ie(P){var X={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(se){return X[se]})}var ve=/\/+/g;function Ne(P,X){return typeof P=="object"&&P!==null&&P.key!=null?ie(""+P.key):X.toString(36)}function tt(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(D,D):(P.status="pending",P.then(function(X){P.status==="pending"&&(P.status="fulfilled",P.value=X)},function(X){P.status==="pending"&&(P.status="rejected",P.reason=X)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function V(P,X,se,oe,pe){var ge=typeof P;(ge==="undefined"||ge==="boolean")&&(P=null);var me=!1;if(P===null)me=!0;else switch(ge){case"bigint":case"string":case"number":me=!0;break;case"object":switch(P.$$typeof){case i:case e:me=!0;break;case g:return me=P._init,V(me(P._payload),X,se,oe,pe)}}if(me)return pe=pe(P),me=oe===""?"."+Ne(P,0):oe,k(pe)?(se="",me!=null&&(se=me.replace(ve,"$&/")+"/"),V(pe,X,se,"",function(Si){return Si})):pe!=null&&(W(pe)&&(pe=Q(pe,se+(pe.key==null||P&&P.key===pe.key?"":(""+pe.key).replace(ve,"$&/")+"/")+me)),X.push(pe)),1;me=0;var Ze=oe===""?".":oe+":";if(k(P))for(var Ge=0;Ge<P.length;Ge++)oe=P[Ge],ge=Ze+Ne(oe,Ge),me+=V(oe,X,se,ge,pe);else if(Ge=T(P),typeof Ge=="function")for(P=Ge.call(P),Ge=0;!(oe=P.next()).done;)oe=oe.value,ge=Ze+Ne(oe,Ge++),me+=V(oe,X,se,ge,pe);else if(ge==="object"){if(typeof P.then=="function")return V(tt(P),X,se,oe,pe);throw X=String(P),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.")}return me}function ae(P,X,se){if(P==null)return P;var oe=[],pe=0;return V(P,oe,"","",function(ge){return X.call(se,ge,pe++)}),oe}function ue(P){if(P._status===-1){var X=P._result;X=X(),X.then(function(se){(P._status===0||P._status===-1)&&(P._status=1,P._result=se)},function(se){(P._status===0||P._status===-1)&&(P._status=2,P._result=se)}),P._status===-1&&(P._status=0,P._result=X)}if(P._status===1)return P._result.default;throw P._result}var Me=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var X=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(X))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},xe={map:ae,forEach:function(P,X,se){ae(P,function(){X.apply(this,arguments)},se)},count:function(P){var X=0;return ae(P,function(){X++}),X},toArray:function(P){return ae(P,function(X){return X})||[]},only:function(P){if(!W(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return ye.Activity=v,ye.Children=xe,ye.Component=R,ye.Fragment=n,ye.Profiler=o,ye.PureComponent=q,ye.StrictMode=r,ye.Suspense=f,ye.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,ye.__COMPILER_RUNTIME={__proto__:null,c:function(P){return L.H.useMemoCache(P)}},ye.cache=function(P){return function(){return P.apply(null,arguments)}},ye.cacheSignal=function(){return null},ye.cloneElement=function(P,X,se){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var oe=C({},P.props),pe=P.key;if(X!=null)for(ge in X.key!==void 0&&(pe=""+X.key),X)!K.call(X,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&X.ref===void 0||(oe[ge]=X[ge]);var ge=arguments.length-2;if(ge===1)oe.children=se;else if(1<ge){for(var me=Array(ge),Ze=0;Ze<ge;Ze++)me[Ze]=arguments[Ze+2];oe.children=me}return G(P.type,pe,oe)},ye.createContext=function(P){return P={$$typeof:d,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:c,_context:P},P},ye.createElement=function(P,X,se){var oe,pe={},ge=null;if(X!=null)for(oe in X.key!==void 0&&(ge=""+X.key),X)K.call(X,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(pe[oe]=X[oe]);var me=arguments.length-2;if(me===1)pe.children=se;else if(1<me){for(var Ze=Array(me),Ge=0;Ge<me;Ge++)Ze[Ge]=arguments[Ge+2];pe.children=Ze}if(P&&P.defaultProps)for(oe in me=P.defaultProps,me)pe[oe]===void 0&&(pe[oe]=me[oe]);return G(P,ge,pe)},ye.createRef=function(){return{current:null}},ye.forwardRef=function(P){return{$$typeof:u,render:P}},ye.isValidElement=W,ye.lazy=function(P){return{$$typeof:g,_payload:{_status:-1,_result:P},_init:ue}},ye.memo=function(P,X){return{$$typeof:h,type:P,compare:X===void 0?null:X}},ye.startTransition=function(P){var X=L.T,se={};L.T=se;try{var oe=P(),pe=L.S;pe!==null&&pe(se,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(D,Me)}catch(ge){Me(ge)}finally{X!==null&&se.types!==null&&(X.types=se.types),L.T=X}},ye.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},ye.use=function(P){return L.H.use(P)},ye.useActionState=function(P,X,se){return L.H.useActionState(P,X,se)},ye.useCallback=function(P,X){return L.H.useCallback(P,X)},ye.useContext=function(P){return L.H.useContext(P)},ye.useDebugValue=function(){},ye.useDeferredValue=function(P,X){return L.H.useDeferredValue(P,X)},ye.useEffect=function(P,X){return L.H.useEffect(P,X)},ye.useEffectEvent=function(P){return L.H.useEffectEvent(P)},ye.useId=function(){return L.H.useId()},ye.useImperativeHandle=function(P,X,se){return L.H.useImperativeHandle(P,X,se)},ye.useInsertionEffect=function(P,X){return L.H.useInsertionEffect(P,X)},ye.useLayoutEffect=function(P,X){return L.H.useLayoutEffect(P,X)},ye.useMemo=function(P,X){return L.H.useMemo(P,X)},ye.useOptimistic=function(P,X){return L.H.useOptimistic(P,X)},ye.useReducer=function(P,X,se){return L.H.useReducer(P,X,se)},ye.useRef=function(P){return L.H.useRef(P)},ye.useState=function(P){return L.H.useState(P)},ye.useSyncExternalStore=function(P,X,se){return L.H.useSyncExternalStore(P,X,se)},ye.useTransition=function(){return L.H.useTransition()},ye.version="19.2.3",ye}var Yv;function dl(){return Yv||(Yv=1,Fd.exports=Hk()),Fd.exports}var A=dl();const fM=qk(A);var Hd={exports:{}},Ls={},Gd={exports:{}},Yd={};var Kv;function Gk(){return Kv||(Kv=1,(function(i){function e(V,ae){var ue=V.length;V.push(ae);e:for(;0<ue;){var Me=ue-1>>>1,xe=V[Me];if(0<o(xe,ae))V[Me]=ae,V[ue]=xe,ue=Me;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var ae=V[0],ue=V.pop();if(ue!==ae){V[0]=ue;e:for(var Me=0,xe=V.length,P=xe>>>1;Me<P;){var X=2*(Me+1)-1,se=V[X],oe=X+1,pe=V[oe];if(0>o(se,ue))oe<xe&&0>o(pe,se)?(V[Me]=pe,V[oe]=ue,Me=oe):(V[Me]=se,V[X]=ue,Me=X);else if(oe<xe&&0>o(pe,ue))V[Me]=pe,V[oe]=ue,Me=oe;else break e}}return ae}function o(V,ae){var ue=V.sortIndex-ae.sortIndex;return ue!==0?ue:V.id-ae.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;i.unstable_now=function(){return c.now()}}else{var d=Date,u=d.now();i.unstable_now=function(){return d.now()-u}}var f=[],h=[],g=1,v=null,b=3,T=!1,_=!1,C=!1,M=!1,R=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,q=typeof setImmediate<"u"?setImmediate:null;function E(V){for(var ae=n(h);ae!==null;){if(ae.callback===null)r(h);else if(ae.startTime<=V)r(h),ae.sortIndex=ae.expirationTime,e(f,ae);else break;ae=n(h)}}function k(V){if(C=!1,E(V),!_)if(n(f)!==null)_=!0,D||(D=!0,ie());else{var ae=n(h);ae!==null&&tt(k,ae.startTime-V)}}var D=!1,L=-1,K=5,G=-1;function Q(){return M?!0:!(i.unstable_now()-G<K)}function W(){if(M=!1,D){var V=i.unstable_now();G=V;var ae=!0;try{e:{_=!1,C&&(C=!1,B(L),L=-1),T=!0;var ue=b;try{t:{for(E(V),v=n(f);v!==null&&!(v.expirationTime>V&&Q());){var Me=v.callback;if(typeof Me=="function"){v.callback=null,b=v.priorityLevel;var xe=Me(v.expirationTime<=V);if(V=i.unstable_now(),typeof xe=="function"){v.callback=xe,E(V),ae=!0;break t}v===n(f)&&r(f),E(V)}else r(f);v=n(f)}if(v!==null)ae=!0;else{var P=n(h);P!==null&&tt(k,P.startTime-V),ae=!1}}break e}finally{v=null,b=ue,T=!1}ae=void 0}}finally{ae?ie():D=!1}}}var ie;if(typeof q=="function")ie=function(){q(W)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,Ne=ve.port2;ve.port1.onmessage=W,ie=function(){Ne.postMessage(null)}}else ie=function(){R(W,0)};function tt(V,ae){L=R(function(){V(i.unstable_now())},ae)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(V){V.callback=null},i.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<V?Math.floor(1e3/V):5},i.unstable_getCurrentPriorityLevel=function(){return b},i.unstable_next=function(V){switch(b){case 1:case 2:case 3:var ae=3;break;default:ae=b}var ue=b;b=ae;try{return V()}finally{b=ue}},i.unstable_requestPaint=function(){M=!0},i.unstable_runWithPriority=function(V,ae){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ue=b;b=V;try{return ae()}finally{b=ue}},i.unstable_scheduleCallback=function(V,ae,ue){var Me=i.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Me+ue:Me):ue=Me,V){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=ue+xe,V={id:g++,callback:ae,priorityLevel:V,startTime:ue,expirationTime:xe,sortIndex:-1},ue>Me?(V.sortIndex=ue,e(h,V),n(f)===null&&V===n(h)&&(C?(B(L),L=-1):C=!0,tt(k,ue-Me))):(V.sortIndex=xe,e(f,V),_||T||(_=!0,D||(D=!0,ie()))),V},i.unstable_shouldYield=Q,i.unstable_wrapCallback=function(V){var ae=b;return function(){var ue=b;b=ae;try{return V.apply(this,arguments)}finally{b=ue}}}})(Yd)),Yd}var Jv;function Yk(){return Jv||(Jv=1,Gd.exports=Gk()),Gd.exports}var Kd={exports:{}},Dt={};var Qv;function Kk(){if(Qv)return Dt;Qv=1;var i=dl();function e(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(f,h,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:f,containerInfo:h,implementation:g}}var d=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Dt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Dt.createPortal=function(f,h){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return c(f,h,null,g)},Dt.flushSync=function(f){var h=d.T,g=r.p;try{if(d.T=null,r.p=2,f)return f()}finally{d.T=h,r.p=g,r.d.f()}},Dt.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(f,h))},Dt.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Dt.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var g=h.as,v=u(g,h.crossOrigin),b=typeof h.integrity=="string"?h.integrity:void 0,T=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;g==="style"?r.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:T}):g==="script"&&r.d.X(f,{crossOrigin:v,integrity:b,fetchPriority:T,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Dt.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var g=u(h.as,h.crossOrigin);r.d.M(f,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(f)},Dt.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var g=h.as,v=u(g,h.crossOrigin);r.d.L(f,g,{crossOrigin:v,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Dt.preloadModule=function(f,h){if(typeof f=="string")if(h){var g=u(h.as,h.crossOrigin);r.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(f)},Dt.requestFormReset=function(f){r.d.r(f)},Dt.unstable_batchedUpdates=function(f,h){return f(h)},Dt.useFormState=function(f,h,g){return d.H.useFormState(f,h,g)},Dt.useFormStatus=function(){return d.H.useHostTransitionStatus()},Dt.version="19.2.3",Dt}var Xv;function Jk(){if(Xv)return Kd.exports;Xv=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Kd.exports=Kk(),Kd.exports}var Zv;function Qk(){if(Zv)return Ls;Zv=1;var i=Yk(),e=dl(),n=Jk();function r(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)a+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function c(t){var a=t,s=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(s=a.return),t=a.return;while(t)}return a.tag===3?s:null}function d(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function u(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function f(t){if(c(t)!==t)throw Error(r(188))}function h(t){var a=t.alternate;if(!a){if(a=c(t),a===null)throw Error(r(188));return a!==t?null:t}for(var s=t,l=a;;){var m=s.return;if(m===null)break;var p=m.alternate;if(p===null){if(l=m.return,l!==null){s=l;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===s)return f(m),t;if(p===l)return f(m),a;p=p.sibling}throw Error(r(188))}if(s.return!==l.return)s=m,l=p;else{for(var y=!1,S=m.child;S;){if(S===s){y=!0,s=m,l=p;break}if(S===l){y=!0,l=m,s=p;break}S=S.sibling}if(!y){for(S=p.child;S;){if(S===s){y=!0,s=p,l=m;break}if(S===l){y=!0,l=p,s=m;break}S=S.sibling}if(!y)throw Error(r(189))}}if(s.alternate!==l)throw Error(r(190))}if(s.tag!==3)throw Error(r(188));return s.stateNode.current===s?t:a}function g(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=g(t),a!==null)return a;t=t.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),B=Symbol.for("react.consumer"),q=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),W=Symbol.iterator;function ie(t){return t===null||typeof t!="object"?null:(t=W&&t[W]||t["@@iterator"],typeof t=="function"?t:null)}var ve=Symbol.for("react.client.reference");function Ne(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===ve?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case C:return"Fragment";case R:return"Profiler";case M:return"StrictMode";case k:return"Suspense";case D:return"SuspenseList";case G:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case _:return"Portal";case q:return t.displayName||"Context";case B:return(t._context.displayName||"Context")+".Consumer";case E:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case L:return a=t.displayName||null,a!==null?a:Ne(t.type)||"Memo";case K:a=t._payload,t=t._init;try{return Ne(t(a))}catch{}}return null}var tt=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue={pending:!1,data:null,method:null,action:null},Me=[],xe=-1;function P(t){return{current:t}}function X(t){0>xe||(t.current=Me[xe],Me[xe]=null,xe--)}function se(t,a){xe++,Me[xe]=t.current,t.current=a}var oe=P(null),pe=P(null),ge=P(null),me=P(null);function Ze(t,a){switch(se(ge,a),se(pe,t),se(oe,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?fv(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=fv(a),t=hv(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}X(oe),se(oe,t)}function Ge(){X(oe),X(pe),X(ge)}function Si(t){t.memoizedState!==null&&se(me,t);var a=oe.current,s=hv(a,t.type);a!==s&&(se(pe,t),se(oe,s))}function uo(t){pe.current===t&&(X(oe),X(pe)),me.current===t&&(X(me),Ds._currentValue=ue)}var El,Vh;function sa(t){if(El===void 0)try{throw Error()}catch(s){var a=s.stack.trim().match(/\n( *(at )?)/);El=a&&a[1]||"",Vh=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+El+t+Vh}var _l=!1;function Rl(t,a){if(!t||_l)return"";_l=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(a){var $=function(){throw Error()};if(Object.defineProperty($.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($,[])}catch(F){var z=F}Reflect.construct(t,[],$)}else{try{$.call()}catch(F){z=F}t.call($.prototype)}}else{try{throw Error()}catch(F){z=F}($=t())&&typeof $.catch=="function"&&$.catch(function(){})}}catch(F){if(F&&z&&typeof F.stack=="string")return[F.stack,z.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=l.DetermineComponentFrameRoot(),y=p[0],S=p[1];if(y&&S){var O=y.split(`
`),I=S.split(`
`);for(m=l=0;l<O.length&&!O[l].includes("DetermineComponentFrameRoot");)l++;for(;m<I.length&&!I[m].includes("DetermineComponentFrameRoot");)m++;if(l===O.length||m===I.length)for(l=O.length-1,m=I.length-1;1<=l&&0<=m&&O[l]!==I[m];)m--;for(;1<=l&&0<=m;l--,m--)if(O[l]!==I[m]){if(l!==1||m!==1)do if(l--,m--,0>m||O[l]!==I[m]){var Y=`
`+O[l].replace(" at new "," at ");return t.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",t.displayName)),Y}while(1<=l&&0<=m);break}}}finally{_l=!1,Error.prepareStackTrace=s}return(s=t?t.displayName||t.name:"")?sa(s):""}function yT(t,a){switch(t.tag){case 26:case 27:case 5:return sa(t.type);case 16:return sa("Lazy");case 13:return t.child!==a&&a!==null?sa("Suspense Fallback"):sa("Suspense");case 19:return sa("SuspenseList");case 0:case 15:return Rl(t.type,!1);case 11:return Rl(t.type.render,!1);case 1:return Rl(t.type,!0);case 31:return sa("Activity");default:return""}}function Fh(t){try{var a="",s=null;do a+=yT(t,s),s=t,t=t.return;while(t);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var wl=Object.prototype.hasOwnProperty,Ol=i.unstable_scheduleCallback,Al=i.unstable_cancelCallback,bT=i.unstable_shouldYield,ST=i.unstable_requestPaint,Qt=i.unstable_now,TT=i.unstable_getCurrentPriorityLevel,Hh=i.unstable_ImmediatePriority,Gh=i.unstable_UserBlockingPriority,fo=i.unstable_NormalPriority,CT=i.unstable_LowPriority,Yh=i.unstable_IdlePriority,kT=i.log,ET=i.unstable_setDisableYieldValue,Vr=null,Xt=null;function Ti(t){if(typeof kT=="function"&&ET(t),Xt&&typeof Xt.setStrictMode=="function")try{Xt.setStrictMode(Vr,t)}catch{}}var Zt=Math.clz32?Math.clz32:wT,_T=Math.log,RT=Math.LN2;function wT(t){return t>>>=0,t===0?32:31-(_T(t)/RT|0)|0}var ho=256,mo=262144,po=4194304;function oa(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function go(t,a,s){var l=t.pendingLanes;if(l===0)return 0;var m=0,p=t.suspendedLanes,y=t.pingedLanes;t=t.warmLanes;var S=l&134217727;return S!==0?(l=S&~p,l!==0?m=oa(l):(y&=S,y!==0?m=oa(y):s||(s=S&~t,s!==0&&(m=oa(s))))):(S=l&~p,S!==0?m=oa(S):y!==0?m=oa(y):s||(s=l&~t,s!==0&&(m=oa(s)))),m===0?0:a!==0&&a!==m&&(a&p)===0&&(p=m&-m,s=a&-a,p>=s||p===32&&(s&4194048)!==0)?a:m}function Fr(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function OT(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kh(){var t=po;return po<<=1,(po&62914560)===0&&(po=4194304),t}function Dl(t){for(var a=[],s=0;31>s;s++)a.push(t);return a}function Hr(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function AT(t,a,s,l,m,p){var y=t.pendingLanes;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=s,t.entangledLanes&=s,t.errorRecoveryDisabledLanes&=s,t.shellSuspendCounter=0;var S=t.entanglements,O=t.expirationTimes,I=t.hiddenUpdates;for(s=y&~s;0<s;){var Y=31-Zt(s),$=1<<Y;S[Y]=0,O[Y]=-1;var z=I[Y];if(z!==null)for(I[Y]=null,Y=0;Y<z.length;Y++){var F=z[Y];F!==null&&(F.lane&=-536870913)}s&=~$}l!==0&&Jh(t,l,0),p!==0&&m===0&&t.tag!==0&&(t.suspendedLanes|=p&~(y&~a))}function Jh(t,a,s){t.pendingLanes|=a,t.suspendedLanes&=~a;var l=31-Zt(a);t.entangledLanes|=a,t.entanglements[l]=t.entanglements[l]|1073741824|s&261930}function Qh(t,a){var s=t.entangledLanes|=a;for(t=t.entanglements;s;){var l=31-Zt(s),m=1<<l;m&a|t[l]&a&&(t[l]|=a),s&=~m}}function Xh(t,a){var s=a&-a;return s=(s&42)!==0?1:Ml(s),(s&(t.suspendedLanes|a))!==0?0:s}function Ml(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function xl(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Zh(){var t=ae.p;return t!==0?t:(t=window.event,t===void 0?32:Uv(t.type))}function Wh(t,a){var s=ae.p;try{return ae.p=t,a()}finally{ae.p=s}}var Ci=Math.random().toString(36).slice(2),kt="__reactFiber$"+Ci,jt="__reactProps$"+Ci,Na="__reactContainer$"+Ci,Pl="__reactEvents$"+Ci,DT="__reactListeners$"+Ci,MT="__reactHandles$"+Ci,$h="__reactResources$"+Ci,Gr="__reactMarker$"+Ci;function Nl(t){delete t[kt],delete t[jt],delete t[Pl],delete t[DT],delete t[MT]}function La(t){var a=t[kt];if(a)return a;for(var s=t.parentNode;s;){if(a=s[Na]||s[kt]){if(s=a.alternate,a.child!==null||s!==null&&s.child!==null)for(t=Sv(t);t!==null;){if(s=t[kt])return s;t=Sv(t)}return a}t=s,s=t.parentNode}return null}function Ua(t){if(t=t[kt]||t[Na]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function Yr(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(r(33))}function Ia(t){var a=t[$h];return a||(a=t[$h]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function bt(t){t[Gr]=!0}var em=new Set,tm={};function ca(t,a){ja(t,a),ja(t+"Capture",a)}function ja(t,a){for(tm[t]=a,t=0;t<a.length;t++)em.add(a[t])}var xT=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nm={},im={};function PT(t){return wl.call(im,t)?!0:wl.call(nm,t)?!1:xT.test(t)?im[t]=!0:(nm[t]=!0,!1)}function vo(t,a,s){if(PT(a))if(s===null)t.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var l=a.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+s)}}function yo(t,a,s){if(s===null)t.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+s)}}function Hn(t,a,s,l){if(l===null)t.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(s);return}t.setAttributeNS(a,s,""+l)}}function cn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function am(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function NT(t,a,s){var l=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,p=l.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return m.call(this)},set:function(y){s=""+y,p.call(this,y)}}),Object.defineProperty(t,a,{enumerable:l.enumerable}),{getValue:function(){return s},setValue:function(y){s=""+y},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function Ll(t){if(!t._valueTracker){var a=am(t)?"checked":"value";t._valueTracker=NT(t,a,""+t[a])}}function rm(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var s=a.getValue(),l="";return t&&(l=am(t)?t.checked?"true":"false":t.value),t=l,t!==s?(a.setValue(t),!0):!1}function bo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var LT=/[\n"\\]/g;function ln(t){return t.replace(LT,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Ul(t,a,s,l,m,p,y,S){t.name="",y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"?t.type=y:t.removeAttribute("type"),a!=null?y==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+cn(a)):t.value!==""+cn(a)&&(t.value=""+cn(a)):y!=="submit"&&y!=="reset"||t.removeAttribute("value"),a!=null?Il(t,y,cn(a)):s!=null?Il(t,y,cn(s)):l!=null&&t.removeAttribute("value"),m==null&&p!=null&&(t.defaultChecked=!!p),m!=null&&(t.checked=m&&typeof m!="function"&&typeof m!="symbol"),S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?t.name=""+cn(S):t.removeAttribute("name")}function sm(t,a,s,l,m,p,y,S){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(t.type=p),a!=null||s!=null){if(!(p!=="submit"&&p!=="reset"||a!=null)){Ll(t);return}s=s!=null?""+cn(s):"",a=a!=null?""+cn(a):s,S||a===t.value||(t.value=a),t.defaultValue=a}l=l??m,l=typeof l!="function"&&typeof l!="symbol"&&!!l,t.checked=S?t.checked:!!l,t.defaultChecked=!!l,y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(t.name=y),Ll(t)}function Il(t,a,s){a==="number"&&bo(t.ownerDocument)===t||t.defaultValue===""+s||(t.defaultValue=""+s)}function Ba(t,a,s,l){if(t=t.options,a){a={};for(var m=0;m<s.length;m++)a["$"+s[m]]=!0;for(s=0;s<t.length;s++)m=a.hasOwnProperty("$"+t[s].value),t[s].selected!==m&&(t[s].selected=m),m&&l&&(t[s].defaultSelected=!0)}else{for(s=""+cn(s),a=null,m=0;m<t.length;m++){if(t[m].value===s){t[m].selected=!0,l&&(t[m].defaultSelected=!0);return}a!==null||t[m].disabled||(a=t[m])}a!==null&&(a.selected=!0)}}function om(t,a,s){if(a!=null&&(a=""+cn(a),a!==t.value&&(t.value=a),s==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=s!=null?""+cn(s):""}function cm(t,a,s,l){if(a==null){if(l!=null){if(s!=null)throw Error(r(92));if(tt(l)){if(1<l.length)throw Error(r(93));l=l[0]}s=l}s==null&&(s=""),a=s}s=cn(a),t.defaultValue=s,l=t.textContent,l===s&&l!==""&&l!==null&&(t.value=l),Ll(t)}function za(t,a){if(a){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=a;return}}t.textContent=a}var UT=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lm(t,a,s){var l=a.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?l?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":l?t.setProperty(a,s):typeof s!="number"||s===0||UT.has(a)?a==="float"?t.cssFloat=s:t[a]=(""+s).trim():t[a]=s+"px"}function um(t,a,s){if(a!=null&&typeof a!="object")throw Error(r(62));if(t=t.style,s!=null){for(var l in s)!s.hasOwnProperty(l)||a!=null&&a.hasOwnProperty(l)||(l.indexOf("--")===0?t.setProperty(l,""):l==="float"?t.cssFloat="":t[l]="");for(var m in a)l=a[m],a.hasOwnProperty(m)&&s[m]!==l&&lm(t,m,l)}else for(var p in a)a.hasOwnProperty(p)&&lm(t,p,a[p])}function jl(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var IT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function So(t){return jT.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function Gn(){}var Bl=null;function zl(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qa=null,Va=null;function dm(t){var a=Ua(t);if(a&&(t=a.stateNode)){var s=t[jt]||null;e:switch(t=a.stateNode,a.type){case"input":if(Ul(t,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),a=s.name,s.type==="radio"&&a!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+ln(""+a)+'"][type="radio"]'),a=0;a<s.length;a++){var l=s[a];if(l!==t&&l.form===t.form){var m=l[jt]||null;if(!m)throw Error(r(90));Ul(l,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<s.length;a++)l=s[a],l.form===t.form&&rm(l)}break e;case"textarea":om(t,s.value,s.defaultValue);break e;case"select":a=s.value,a!=null&&Ba(t,!!s.multiple,a,!1)}}}var ql=!1;function fm(t,a,s){if(ql)return t(a,s);ql=!0;try{var l=t(a);return l}finally{if(ql=!1,(qa!==null||Va!==null)&&(oc(),qa&&(a=qa,t=Va,Va=qa=null,dm(a),t)))for(a=0;a<t.length;a++)dm(t[a])}}function Kr(t,a){var s=t.stateNode;if(s===null)return null;var l=s[jt]||null;if(l===null)return null;s=l[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(t=t.type,l=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!l;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(r(231,a,typeof s));return s}var Yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vl=!1;if(Yn)try{var Jr={};Object.defineProperty(Jr,"passive",{get:function(){Vl=!0}}),window.addEventListener("test",Jr,Jr),window.removeEventListener("test",Jr,Jr)}catch{Vl=!1}var ki=null,Fl=null,To=null;function hm(){if(To)return To;var t,a=Fl,s=a.length,l,m="value"in ki?ki.value:ki.textContent,p=m.length;for(t=0;t<s&&a[t]===m[t];t++);var y=s-t;for(l=1;l<=y&&a[s-l]===m[p-l];l++);return To=m.slice(t,1<l?1-l:void 0)}function Co(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function ko(){return!0}function mm(){return!1}function Bt(t){function a(s,l,m,p,y){this._reactName=s,this._targetInst=m,this.type=l,this.nativeEvent=p,this.target=y,this.currentTarget=null;for(var S in t)t.hasOwnProperty(S)&&(s=t[S],this[S]=s?s(p):p[S]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?ko:mm,this.isPropagationStopped=mm,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=ko)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=ko)},persist:function(){},isPersistent:ko}),a}var la={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eo=Bt(la),Qr=v({},la,{view:0,detail:0}),BT=Bt(Qr),Hl,Gl,Xr,_o=v({},Qr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xr&&(Xr&&t.type==="mousemove"?(Hl=t.screenX-Xr.screenX,Gl=t.screenY-Xr.screenY):Gl=Hl=0,Xr=t),Hl)},movementY:function(t){return"movementY"in t?t.movementY:Gl}}),pm=Bt(_o),zT=v({},_o,{dataTransfer:0}),qT=Bt(zT),VT=v({},Qr,{relatedTarget:0}),Yl=Bt(VT),FT=v({},la,{animationName:0,elapsedTime:0,pseudoElement:0}),HT=Bt(FT),GT=v({},la,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YT=Bt(GT),KT=v({},la,{data:0}),gm=Bt(KT),JT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},XT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZT(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=XT[t])?!!a[t]:!1}function Kl(){return ZT}var WT=v({},Qr,{key:function(t){if(t.key){var a=JT[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=Co(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?QT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kl,charCode:function(t){return t.type==="keypress"?Co(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Co(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$T=Bt(WT),eC=v({},_o,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vm=Bt(eC),tC=v({},Qr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kl}),nC=Bt(tC),iC=v({},la,{propertyName:0,elapsedTime:0,pseudoElement:0}),aC=Bt(iC),rC=v({},_o,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sC=Bt(rC),oC=v({},la,{newState:0,oldState:0}),cC=Bt(oC),lC=[9,13,27,32],Jl=Yn&&"CompositionEvent"in window,Zr=null;Yn&&"documentMode"in document&&(Zr=document.documentMode);var uC=Yn&&"TextEvent"in window&&!Zr,ym=Yn&&(!Jl||Zr&&8<Zr&&11>=Zr),bm=" ",Sm=!1;function Tm(t,a){switch(t){case"keyup":return lC.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Cm(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fa=!1;function dC(t,a){switch(t){case"compositionend":return Cm(a);case"keypress":return a.which!==32?null:(Sm=!0,bm);case"textInput":return t=a.data,t===bm&&Sm?null:t;default:return null}}function fC(t,a){if(Fa)return t==="compositionend"||!Jl&&Tm(t,a)?(t=hm(),To=Fl=ki=null,Fa=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return ym&&a.locale!=="ko"?null:a.data;default:return null}}var hC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function km(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!hC[t.type]:a==="textarea"}function Em(t,a,s,l){qa?Va?Va.push(l):Va=[l]:qa=l,a=mc(a,"onChange"),0<a.length&&(s=new Eo("onChange","change",null,s,l),t.push({event:s,listeners:a}))}var Wr=null,$r=null;function mC(t){sv(t,0)}function Ro(t){var a=Yr(t);if(rm(a))return t}function _m(t,a){if(t==="change")return a}var Rm=!1;if(Yn){var Ql;if(Yn){var Xl="oninput"in document;if(!Xl){var wm=document.createElement("div");wm.setAttribute("oninput","return;"),Xl=typeof wm.oninput=="function"}Ql=Xl}else Ql=!1;Rm=Ql&&(!document.documentMode||9<document.documentMode)}function Om(){Wr&&(Wr.detachEvent("onpropertychange",Am),$r=Wr=null)}function Am(t){if(t.propertyName==="value"&&Ro($r)){var a=[];Em(a,$r,t,zl(t)),fm(mC,a)}}function pC(t,a,s){t==="focusin"?(Om(),Wr=a,$r=s,Wr.attachEvent("onpropertychange",Am)):t==="focusout"&&Om()}function gC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ro($r)}function vC(t,a){if(t==="click")return Ro(a)}function yC(t,a){if(t==="input"||t==="change")return Ro(a)}function bC(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var Wt=typeof Object.is=="function"?Object.is:bC;function es(t,a){if(Wt(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var s=Object.keys(t),l=Object.keys(a);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var m=s[l];if(!wl.call(a,m)||!Wt(t[m],a[m]))return!1}return!0}function Dm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Mm(t,a){var s=Dm(t);t=0;for(var l;s;){if(s.nodeType===3){if(l=t+s.textContent.length,t<=a&&l>=a)return{node:s,offset:a-t};t=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Dm(s)}}function xm(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?xm(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function Pm(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=bo(t.document);a instanceof t.HTMLIFrameElement;){try{var s=typeof a.contentWindow.location.href=="string"}catch{s=!1}if(s)t=a.contentWindow;else break;a=bo(t.document)}return a}function Zl(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var SC=Yn&&"documentMode"in document&&11>=document.documentMode,Ha=null,Wl=null,ts=null,$l=!1;function Nm(t,a,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;$l||Ha==null||Ha!==bo(l)||(l=Ha,"selectionStart"in l&&Zl(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),ts&&es(ts,l)||(ts=l,l=mc(Wl,"onSelect"),0<l.length&&(a=new Eo("onSelect","select",null,a,s),t.push({event:a,listeners:l}),a.target=Ha)))}function ua(t,a){var s={};return s[t.toLowerCase()]=a.toLowerCase(),s["Webkit"+t]="webkit"+a,s["Moz"+t]="moz"+a,s}var Ga={animationend:ua("Animation","AnimationEnd"),animationiteration:ua("Animation","AnimationIteration"),animationstart:ua("Animation","AnimationStart"),transitionrun:ua("Transition","TransitionRun"),transitionstart:ua("Transition","TransitionStart"),transitioncancel:ua("Transition","TransitionCancel"),transitionend:ua("Transition","TransitionEnd")},eu={},Lm={};Yn&&(Lm=document.createElement("div").style,"AnimationEvent"in window||(delete Ga.animationend.animation,delete Ga.animationiteration.animation,delete Ga.animationstart.animation),"TransitionEvent"in window||delete Ga.transitionend.transition);function da(t){if(eu[t])return eu[t];if(!Ga[t])return t;var a=Ga[t],s;for(s in a)if(a.hasOwnProperty(s)&&s in Lm)return eu[t]=a[s];return t}var Um=da("animationend"),Im=da("animationiteration"),jm=da("animationstart"),TC=da("transitionrun"),CC=da("transitionstart"),kC=da("transitioncancel"),Bm=da("transitionend"),zm=new Map,tu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");tu.push("scrollEnd");function Cn(t,a){zm.set(t,a),ca(a,[t])}var wo=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},un=[],Ya=0,nu=0;function Oo(){for(var t=Ya,a=nu=Ya=0;a<t;){var s=un[a];un[a++]=null;var l=un[a];un[a++]=null;var m=un[a];un[a++]=null;var p=un[a];if(un[a++]=null,l!==null&&m!==null){var y=l.pending;y===null?m.next=m:(m.next=y.next,y.next=m),l.pending=m}p!==0&&qm(s,m,p)}}function Ao(t,a,s,l){un[Ya++]=t,un[Ya++]=a,un[Ya++]=s,un[Ya++]=l,nu|=l,t.lanes|=l,t=t.alternate,t!==null&&(t.lanes|=l)}function iu(t,a,s,l){return Ao(t,a,s,l),Do(t)}function fa(t,a){return Ao(t,null,null,a),Do(t)}function qm(t,a,s){t.lanes|=s;var l=t.alternate;l!==null&&(l.lanes|=s);for(var m=!1,p=t.return;p!==null;)p.childLanes|=s,l=p.alternate,l!==null&&(l.childLanes|=s),p.tag===22&&(t=p.stateNode,t===null||t._visibility&1||(m=!0)),t=p,p=p.return;return t.tag===3?(p=t.stateNode,m&&a!==null&&(m=31-Zt(s),t=p.hiddenUpdates,l=t[m],l===null?t[m]=[a]:l.push(a),a.lane=s|536870912),p):null}function Do(t){if(50<ks)throw ks=0,fd=null,Error(r(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var Ka={};function EC(t,a,s,l){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $t(t,a,s,l){return new EC(t,a,s,l)}function au(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Kn(t,a){var s=t.alternate;return s===null?(s=$t(t.tag,a,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=a,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&65011712,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,a=t.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s.refCleanup=t.refCleanup,s}function Vm(t,a){t.flags&=65011714;var s=t.alternate;return s===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=s.childLanes,t.lanes=s.lanes,t.child=s.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=s.memoizedProps,t.memoizedState=s.memoizedState,t.updateQueue=s.updateQueue,t.type=s.type,a=s.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function Mo(t,a,s,l,m,p){var y=0;if(l=t,typeof t=="function")au(t)&&(y=1);else if(typeof t=="string")y=Ak(t,s,oe.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case G:return t=$t(31,s,a,m),t.elementType=G,t.lanes=p,t;case C:return ha(s.children,m,p,a);case M:y=8,m|=24;break;case R:return t=$t(12,s,a,m|2),t.elementType=R,t.lanes=p,t;case k:return t=$t(13,s,a,m),t.elementType=k,t.lanes=p,t;case D:return t=$t(19,s,a,m),t.elementType=D,t.lanes=p,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case q:y=10;break e;case B:y=9;break e;case E:y=11;break e;case L:y=14;break e;case K:y=16,l=null;break e}y=29,s=Error(r(130,t===null?"null":typeof t,"")),l=null}return a=$t(y,s,a,m),a.elementType=t,a.type=l,a.lanes=p,a}function ha(t,a,s,l){return t=$t(7,t,l,a),t.lanes=s,t}function ru(t,a,s){return t=$t(6,t,null,a),t.lanes=s,t}function Fm(t){var a=$t(18,null,null,0);return a.stateNode=t,a}function su(t,a,s){return a=$t(4,t.children!==null?t.children:[],t.key,a),a.lanes=s,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var Hm=new WeakMap;function dn(t,a){if(typeof t=="object"&&t!==null){var s=Hm.get(t);return s!==void 0?s:(a={value:t,source:a,stack:Fh(a)},Hm.set(t,a),a)}return{value:t,source:a,stack:Fh(a)}}var Ja=[],Qa=0,xo=null,ns=0,fn=[],hn=0,Ei=null,Pn=1,Nn="";function Jn(t,a){Ja[Qa++]=ns,Ja[Qa++]=xo,xo=t,ns=a}function Gm(t,a,s){fn[hn++]=Pn,fn[hn++]=Nn,fn[hn++]=Ei,Ei=t;var l=Pn;t=Nn;var m=32-Zt(l)-1;l&=~(1<<m),s+=1;var p=32-Zt(a)+m;if(30<p){var y=m-m%5;p=(l&(1<<y)-1).toString(32),l>>=y,m-=y,Pn=1<<32-Zt(a)+m|s<<m|l,Nn=p+t}else Pn=1<<p|s<<m|l,Nn=t}function ou(t){t.return!==null&&(Jn(t,1),Gm(t,1,0))}function cu(t){for(;t===xo;)xo=Ja[--Qa],Ja[Qa]=null,ns=Ja[--Qa],Ja[Qa]=null;for(;t===Ei;)Ei=fn[--hn],fn[hn]=null,Nn=fn[--hn],fn[hn]=null,Pn=fn[--hn],fn[hn]=null}function Ym(t,a){fn[hn++]=Pn,fn[hn++]=Nn,fn[hn++]=Ei,Pn=a.id,Nn=a.overflow,Ei=t}var Et=null,Qe=null,De=!1,_i=null,mn=!1,lu=Error(r(519));function Ri(t){var a=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw is(dn(a,t)),lu}function Km(t){var a=t.stateNode,s=t.type,l=t.memoizedProps;switch(a[kt]=t,a[jt]=l,s){case"dialog":_e("cancel",a),_e("close",a);break;case"iframe":case"object":case"embed":_e("load",a);break;case"video":case"audio":for(s=0;s<_s.length;s++)_e(_s[s],a);break;case"source":_e("error",a);break;case"img":case"image":case"link":_e("error",a),_e("load",a);break;case"details":_e("toggle",a);break;case"input":_e("invalid",a),sm(a,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":_e("invalid",a);break;case"textarea":_e("invalid",a),cm(a,l.value,l.defaultValue,l.children)}s=l.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||a.textContent===""+s||l.suppressHydrationWarning===!0||uv(a.textContent,s)?(l.popover!=null&&(_e("beforetoggle",a),_e("toggle",a)),l.onScroll!=null&&_e("scroll",a),l.onScrollEnd!=null&&_e("scrollend",a),l.onClick!=null&&(a.onclick=Gn),a=!0):a=!1,a||Ri(t,!0)}function Jm(t){for(Et=t.return;Et;)switch(Et.tag){case 5:case 31:case 13:mn=!1;return;case 27:case 3:mn=!0;return;default:Et=Et.return}}function Xa(t){if(t!==Et)return!1;if(!De)return Jm(t),De=!0,!1;var a=t.tag,s;if((s=a!==3&&a!==27)&&((s=a===5)&&(s=t.type,s=!(s!=="form"&&s!=="button")||wd(t.type,t.memoizedProps)),s=!s),s&&Qe&&Ri(t),Jm(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));Qe=bv(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));Qe=bv(t)}else a===27?(a=Qe,zi(t.type)?(t=xd,xd=null,Qe=t):Qe=a):Qe=Et?gn(t.stateNode.nextSibling):null;return!0}function ma(){Qe=Et=null,De=!1}function uu(){var t=_i;return t!==null&&(Ft===null?Ft=t:Ft.push.apply(Ft,t),_i=null),t}function is(t){_i===null?_i=[t]:_i.push(t)}var du=P(null),pa=null,Qn=null;function wi(t,a,s){se(du,a._currentValue),a._currentValue=s}function Xn(t){t._currentValue=du.current,X(du)}function fu(t,a,s){for(;t!==null;){var l=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,l!==null&&(l.childLanes|=a)):l!==null&&(l.childLanes&a)!==a&&(l.childLanes|=a),t===s)break;t=t.return}}function hu(t,a,s,l){var m=t.child;for(m!==null&&(m.return=t);m!==null;){var p=m.dependencies;if(p!==null){var y=m.child;p=p.firstContext;e:for(;p!==null;){var S=p;p=m;for(var O=0;O<a.length;O++)if(S.context===a[O]){p.lanes|=s,S=p.alternate,S!==null&&(S.lanes|=s),fu(p.return,s,t),l||(y=null);break e}p=S.next}}else if(m.tag===18){if(y=m.return,y===null)throw Error(r(341));y.lanes|=s,p=y.alternate,p!==null&&(p.lanes|=s),fu(y,s,t),y=null}else y=m.child;if(y!==null)y.return=m;else for(y=m;y!==null;){if(y===t){y=null;break}if(m=y.sibling,m!==null){m.return=y.return,y=m;break}y=y.return}m=y}}function Za(t,a,s,l){t=null;for(var m=a,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var y=m.alternate;if(y===null)throw Error(r(387));if(y=y.memoizedProps,y!==null){var S=m.type;Wt(m.pendingProps.value,y.value)||(t!==null?t.push(S):t=[S])}}else if(m===me.current){if(y=m.alternate,y===null)throw Error(r(387));y.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(t!==null?t.push(Ds):t=[Ds])}m=m.return}t!==null&&hu(a,t,s,l),a.flags|=262144}function Po(t){for(t=t.firstContext;t!==null;){if(!Wt(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ga(t){pa=t,Qn=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function _t(t){return Qm(pa,t)}function No(t,a){return pa===null&&ga(t),Qm(t,a)}function Qm(t,a){var s=a._currentValue;if(a={context:a,memoizedValue:s,next:null},Qn===null){if(t===null)throw Error(r(308));Qn=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else Qn=Qn.next=a;return s}var _C=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(s,l){t.push(l)}};this.abort=function(){a.aborted=!0,t.forEach(function(s){return s()})}},RC=i.unstable_scheduleCallback,wC=i.unstable_NormalPriority,dt={$$typeof:q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function mu(){return{controller:new _C,data:new Map,refCount:0}}function as(t){t.refCount--,t.refCount===0&&RC(wC,function(){t.controller.abort()})}var rs=null,pu=0,Wa=0,$a=null;function OC(t,a){if(rs===null){var s=rs=[];pu=0,Wa=yd(),$a={status:"pending",value:void 0,then:function(l){s.push(l)}}}return pu++,a.then(Xm,Xm),a}function Xm(){if(--pu===0&&rs!==null){$a!==null&&($a.status="fulfilled");var t=rs;rs=null,Wa=0,$a=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function AC(t,a){var s=[],l={status:"pending",value:null,reason:null,then:function(m){s.push(m)}};return t.then(function(){l.status="fulfilled",l.value=a;for(var m=0;m<s.length;m++)(0,s[m])(a)},function(m){for(l.status="rejected",l.reason=m,m=0;m<s.length;m++)(0,s[m])(void 0)}),l}var Zm=V.S;V.S=function(t,a){Ng=Qt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&OC(t,a),Zm!==null&&Zm(t,a)};var va=P(null);function gu(){var t=va.current;return t!==null?t:Ye.pooledCache}function Lo(t,a){a===null?se(va,va.current):se(va,a.pool)}function Wm(){var t=gu();return t===null?null:{parent:dt._currentValue,pool:t}}var er=Error(r(460)),vu=Error(r(474)),Uo=Error(r(542)),Io={then:function(){}};function $m(t){return t=t.status,t==="fulfilled"||t==="rejected"}function ep(t,a,s){switch(s=t[s],s===void 0?t.push(a):s!==a&&(a.then(Gn,Gn),a=s),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,np(t),t;default:if(typeof a.status=="string")a.then(Gn,Gn);else{if(t=Ye,t!==null&&100<t.shellSuspendCounter)throw Error(r(482));t=a,t.status="pending",t.then(function(l){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=l}},function(l){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=l}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,np(t),t}throw ba=a,er}}function ya(t){try{var a=t._init;return a(t._payload)}catch(s){throw s!==null&&typeof s=="object"&&typeof s.then=="function"?(ba=s,er):s}}var ba=null;function tp(){if(ba===null)throw Error(r(459));var t=ba;return ba=null,t}function np(t){if(t===er||t===Uo)throw Error(r(483))}var tr=null,ss=0;function jo(t){var a=ss;return ss+=1,tr===null&&(tr=[]),ep(tr,t,a)}function os(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function Bo(t,a){throw a.$$typeof===b?Error(r(525)):(t=Object.prototype.toString.call(a),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function ip(t){function a(N,x){if(t){var U=N.deletions;U===null?(N.deletions=[x],N.flags|=16):U.push(x)}}function s(N,x){if(!t)return null;for(;x!==null;)a(N,x),x=x.sibling;return null}function l(N){for(var x=new Map;N!==null;)N.key!==null?x.set(N.key,N):x.set(N.index,N),N=N.sibling;return x}function m(N,x){return N=Kn(N,x),N.index=0,N.sibling=null,N}function p(N,x,U){return N.index=U,t?(U=N.alternate,U!==null?(U=U.index,U<x?(N.flags|=67108866,x):U):(N.flags|=67108866,x)):(N.flags|=1048576,x)}function y(N){return t&&N.alternate===null&&(N.flags|=67108866),N}function S(N,x,U,Z){return x===null||x.tag!==6?(x=ru(U,N.mode,Z),x.return=N,x):(x=m(x,U),x.return=N,x)}function O(N,x,U,Z){var de=U.type;return de===C?Y(N,x,U.props.children,Z,U.key):x!==null&&(x.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===K&&ya(de)===x.type)?(x=m(x,U.props),os(x,U),x.return=N,x):(x=Mo(U.type,U.key,U.props,null,N.mode,Z),os(x,U),x.return=N,x)}function I(N,x,U,Z){return x===null||x.tag!==4||x.stateNode.containerInfo!==U.containerInfo||x.stateNode.implementation!==U.implementation?(x=su(U,N.mode,Z),x.return=N,x):(x=m(x,U.children||[]),x.return=N,x)}function Y(N,x,U,Z,de){return x===null||x.tag!==7?(x=ha(U,N.mode,Z,de),x.return=N,x):(x=m(x,U),x.return=N,x)}function $(N,x,U){if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return x=ru(""+x,N.mode,U),x.return=N,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case T:return U=Mo(x.type,x.key,x.props,null,N.mode,U),os(U,x),U.return=N,U;case _:return x=su(x,N.mode,U),x.return=N,x;case K:return x=ya(x),$(N,x,U)}if(tt(x)||ie(x))return x=ha(x,N.mode,U,null),x.return=N,x;if(typeof x.then=="function")return $(N,jo(x),U);if(x.$$typeof===q)return $(N,No(N,x),U);Bo(N,x)}return null}function z(N,x,U,Z){var de=x!==null?x.key:null;if(typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint")return de!==null?null:S(N,x,""+U,Z);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case T:return U.key===de?O(N,x,U,Z):null;case _:return U.key===de?I(N,x,U,Z):null;case K:return U=ya(U),z(N,x,U,Z)}if(tt(U)||ie(U))return de!==null?null:Y(N,x,U,Z,null);if(typeof U.then=="function")return z(N,x,jo(U),Z);if(U.$$typeof===q)return z(N,x,No(N,U),Z);Bo(N,U)}return null}function F(N,x,U,Z,de){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return N=N.get(U)||null,S(x,N,""+Z,de);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case T:return N=N.get(Z.key===null?U:Z.key)||null,O(x,N,Z,de);case _:return N=N.get(Z.key===null?U:Z.key)||null,I(x,N,Z,de);case K:return Z=ya(Z),F(N,x,U,Z,de)}if(tt(Z)||ie(Z))return N=N.get(U)||null,Y(x,N,Z,de,null);if(typeof Z.then=="function")return F(N,x,U,jo(Z),de);if(Z.$$typeof===q)return F(N,x,U,No(x,Z),de);Bo(x,Z)}return null}function ce(N,x,U,Z){for(var de=null,Le=null,le=x,Se=x=0,Ae=null;le!==null&&Se<U.length;Se++){le.index>Se?(Ae=le,le=null):Ae=le.sibling;var Ue=z(N,le,U[Se],Z);if(Ue===null){le===null&&(le=Ae);break}t&&le&&Ue.alternate===null&&a(N,le),x=p(Ue,x,Se),Le===null?de=Ue:Le.sibling=Ue,Le=Ue,le=Ae}if(Se===U.length)return s(N,le),De&&Jn(N,Se),de;if(le===null){for(;Se<U.length;Se++)le=$(N,U[Se],Z),le!==null&&(x=p(le,x,Se),Le===null?de=le:Le.sibling=le,Le=le);return De&&Jn(N,Se),de}for(le=l(le);Se<U.length;Se++)Ae=F(le,N,Se,U[Se],Z),Ae!==null&&(t&&Ae.alternate!==null&&le.delete(Ae.key===null?Se:Ae.key),x=p(Ae,x,Se),Le===null?de=Ae:Le.sibling=Ae,Le=Ae);return t&&le.forEach(function(Gi){return a(N,Gi)}),De&&Jn(N,Se),de}function fe(N,x,U,Z){if(U==null)throw Error(r(151));for(var de=null,Le=null,le=x,Se=x=0,Ae=null,Ue=U.next();le!==null&&!Ue.done;Se++,Ue=U.next()){le.index>Se?(Ae=le,le=null):Ae=le.sibling;var Gi=z(N,le,Ue.value,Z);if(Gi===null){le===null&&(le=Ae);break}t&&le&&Gi.alternate===null&&a(N,le),x=p(Gi,x,Se),Le===null?de=Gi:Le.sibling=Gi,Le=Gi,le=Ae}if(Ue.done)return s(N,le),De&&Jn(N,Se),de;if(le===null){for(;!Ue.done;Se++,Ue=U.next())Ue=$(N,Ue.value,Z),Ue!==null&&(x=p(Ue,x,Se),Le===null?de=Ue:Le.sibling=Ue,Le=Ue);return De&&Jn(N,Se),de}for(le=l(le);!Ue.done;Se++,Ue=U.next())Ue=F(le,N,Se,Ue.value,Z),Ue!==null&&(t&&Ue.alternate!==null&&le.delete(Ue.key===null?Se:Ue.key),x=p(Ue,x,Se),Le===null?de=Ue:Le.sibling=Ue,Le=Ue);return t&&le.forEach(function(zk){return a(N,zk)}),De&&Jn(N,Se),de}function Fe(N,x,U,Z){if(typeof U=="object"&&U!==null&&U.type===C&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case T:e:{for(var de=U.key;x!==null;){if(x.key===de){if(de=U.type,de===C){if(x.tag===7){s(N,x.sibling),Z=m(x,U.props.children),Z.return=N,N=Z;break e}}else if(x.elementType===de||typeof de=="object"&&de!==null&&de.$$typeof===K&&ya(de)===x.type){s(N,x.sibling),Z=m(x,U.props),os(Z,U),Z.return=N,N=Z;break e}s(N,x);break}else a(N,x);x=x.sibling}U.type===C?(Z=ha(U.props.children,N.mode,Z,U.key),Z.return=N,N=Z):(Z=Mo(U.type,U.key,U.props,null,N.mode,Z),os(Z,U),Z.return=N,N=Z)}return y(N);case _:e:{for(de=U.key;x!==null;){if(x.key===de)if(x.tag===4&&x.stateNode.containerInfo===U.containerInfo&&x.stateNode.implementation===U.implementation){s(N,x.sibling),Z=m(x,U.children||[]),Z.return=N,N=Z;break e}else{s(N,x);break}else a(N,x);x=x.sibling}Z=su(U,N.mode,Z),Z.return=N,N=Z}return y(N);case K:return U=ya(U),Fe(N,x,U,Z)}if(tt(U))return ce(N,x,U,Z);if(ie(U)){if(de=ie(U),typeof de!="function")throw Error(r(150));return U=de.call(U),fe(N,x,U,Z)}if(typeof U.then=="function")return Fe(N,x,jo(U),Z);if(U.$$typeof===q)return Fe(N,x,No(N,U),Z);Bo(N,U)}return typeof U=="string"&&U!==""||typeof U=="number"||typeof U=="bigint"?(U=""+U,x!==null&&x.tag===6?(s(N,x.sibling),Z=m(x,U),Z.return=N,N=Z):(s(N,x),Z=ru(U,N.mode,Z),Z.return=N,N=Z),y(N)):s(N,x)}return function(N,x,U,Z){try{ss=0;var de=Fe(N,x,U,Z);return tr=null,de}catch(le){if(le===er||le===Uo)throw le;var Le=$t(29,le,null,N.mode);return Le.lanes=Z,Le.return=N,Le}}}var Sa=ip(!0),ap=ip(!1),Oi=!1;function yu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bu(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Ai(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Di(t,a,s){var l=t.updateQueue;if(l===null)return null;if(l=l.shared,(je&2)!==0){var m=l.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),l.pending=a,a=Do(t),qm(t,null,s),a}return Ao(t,l,a,s),Do(t)}function cs(t,a,s){if(a=a.updateQueue,a!==null&&(a=a.shared,(s&4194048)!==0)){var l=a.lanes;l&=t.pendingLanes,s|=l,a.lanes=s,Qh(t,s)}}function Su(t,a){var s=t.updateQueue,l=t.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var m=null,p=null;if(s=s.firstBaseUpdate,s!==null){do{var y={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};p===null?m=p=y:p=p.next=y,s=s.next}while(s!==null);p===null?m=p=a:p=p.next=a}else m=p=a;s={baseState:l.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:l.shared,callbacks:l.callbacks},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=a:t.next=a,s.lastBaseUpdate=a}var Tu=!1;function ls(){if(Tu){var t=$a;if(t!==null)throw t}}function us(t,a,s,l){Tu=!1;var m=t.updateQueue;Oi=!1;var p=m.firstBaseUpdate,y=m.lastBaseUpdate,S=m.shared.pending;if(S!==null){m.shared.pending=null;var O=S,I=O.next;O.next=null,y===null?p=I:y.next=I,y=O;var Y=t.alternate;Y!==null&&(Y=Y.updateQueue,S=Y.lastBaseUpdate,S!==y&&(S===null?Y.firstBaseUpdate=I:S.next=I,Y.lastBaseUpdate=O))}if(p!==null){var $=m.baseState;y=0,Y=I=O=null,S=p;do{var z=S.lane&-536870913,F=z!==S.lane;if(F?(Oe&z)===z:(l&z)===z){z!==0&&z===Wa&&(Tu=!0),Y!==null&&(Y=Y.next={lane:0,tag:S.tag,payload:S.payload,callback:null,next:null});e:{var ce=t,fe=S;z=a;var Fe=s;switch(fe.tag){case 1:if(ce=fe.payload,typeof ce=="function"){$=ce.call(Fe,$,z);break e}$=ce;break e;case 3:ce.flags=ce.flags&-65537|128;case 0:if(ce=fe.payload,z=typeof ce=="function"?ce.call(Fe,$,z):ce,z==null)break e;$=v({},$,z);break e;case 2:Oi=!0}}z=S.callback,z!==null&&(t.flags|=64,F&&(t.flags|=8192),F=m.callbacks,F===null?m.callbacks=[z]:F.push(z))}else F={lane:z,tag:S.tag,payload:S.payload,callback:S.callback,next:null},Y===null?(I=Y=F,O=$):Y=Y.next=F,y|=z;if(S=S.next,S===null){if(S=m.shared.pending,S===null)break;F=S,S=F.next,F.next=null,m.lastBaseUpdate=F,m.shared.pending=null}}while(!0);Y===null&&(O=$),m.baseState=O,m.firstBaseUpdate=I,m.lastBaseUpdate=Y,p===null&&(m.shared.lanes=0),Li|=y,t.lanes=y,t.memoizedState=$}}function rp(t,a){if(typeof t!="function")throw Error(r(191,t));t.call(a)}function sp(t,a){var s=t.callbacks;if(s!==null)for(t.callbacks=null,t=0;t<s.length;t++)rp(s[t],a)}var nr=P(null),zo=P(0);function op(t,a){t=ri,se(zo,t),se(nr,a),ri=t|a.baseLanes}function Cu(){se(zo,ri),se(nr,nr.current)}function ku(){ri=zo.current,X(nr),X(zo)}var en=P(null),pn=null;function Mi(t){var a=t.alternate;se(ot,ot.current&1),se(en,t),pn===null&&(a===null||nr.current!==null||a.memoizedState!==null)&&(pn=t)}function Eu(t){se(ot,ot.current),se(en,t),pn===null&&(pn=t)}function cp(t){t.tag===22?(se(ot,ot.current),se(en,t),pn===null&&(pn=t)):xi()}function xi(){se(ot,ot.current),se(en,en.current)}function tn(t){X(en),pn===t&&(pn=null),X(ot)}var ot=P(0);function qo(t){for(var a=t;a!==null;){if(a.tag===13){var s=a.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||Dd(s)||Md(s)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Zn=0,be=null,qe=null,ft=null,Vo=!1,ir=!1,Ta=!1,Fo=0,ds=0,ar=null,DC=0;function nt(){throw Error(r(321))}function _u(t,a){if(a===null)return!1;for(var s=0;s<a.length&&s<t.length;s++)if(!Wt(t[s],a[s]))return!1;return!0}function Ru(t,a,s,l,m,p){return Zn=p,be=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,V.H=t===null||t.memoizedState===null?Gp:qu,Ta=!1,p=s(l,m),Ta=!1,ir&&(p=up(a,s,l,m)),lp(t),p}function lp(t){V.H=ms;var a=qe!==null&&qe.next!==null;if(Zn=0,ft=qe=be=null,Vo=!1,ds=0,ar=null,a)throw Error(r(300));t===null||ht||(t=t.dependencies,t!==null&&Po(t)&&(ht=!0))}function up(t,a,s,l){be=t;var m=0;do{if(ir&&(ar=null),ds=0,ir=!1,25<=m)throw Error(r(301));if(m+=1,ft=qe=null,t.updateQueue!=null){var p=t.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}V.H=Yp,p=a(s,l)}while(ir);return p}function MC(){var t=V.H,a=t.useState()[0];return a=typeof a.then=="function"?fs(a):a,t=t.useState()[0],(qe!==null?qe.memoizedState:null)!==t&&(be.flags|=1024),a}function wu(){var t=Fo!==0;return Fo=0,t}function Ou(t,a,s){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~s}function Au(t){if(Vo){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}Vo=!1}Zn=0,ft=qe=be=null,ir=!1,ds=Fo=0,ar=null}function Pt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ft===null?be.memoizedState=ft=t:ft=ft.next=t,ft}function ct(){if(qe===null){var t=be.alternate;t=t!==null?t.memoizedState:null}else t=qe.next;var a=ft===null?be.memoizedState:ft.next;if(a!==null)ft=a,qe=t;else{if(t===null)throw be.alternate===null?Error(r(467)):Error(r(310));qe=t,t={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},ft===null?be.memoizedState=ft=t:ft=ft.next=t}return ft}function Ho(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function fs(t){var a=ds;return ds+=1,ar===null&&(ar=[]),t=ep(ar,t,a),a=be,(ft===null?a.memoizedState:ft.next)===null&&(a=a.alternate,V.H=a===null||a.memoizedState===null?Gp:qu),t}function Go(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return fs(t);if(t.$$typeof===q)return _t(t)}throw Error(r(438,String(t)))}function Du(t){var a=null,s=be.updateQueue;if(s!==null&&(a=s.memoCache),a==null){var l=be.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(a={data:l.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),s===null&&(s=Ho(),be.updateQueue=s),s.memoCache=a,s=a.data[a.index],s===void 0)for(s=a.data[a.index]=Array(t),l=0;l<t;l++)s[l]=Q;return a.index++,s}function Wn(t,a){return typeof a=="function"?a(t):a}function Yo(t){var a=ct();return Mu(a,qe,t)}function Mu(t,a,s){var l=t.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=s;var m=t.baseQueue,p=l.pending;if(p!==null){if(m!==null){var y=m.next;m.next=p.next,p.next=y}a.baseQueue=m=p,l.pending=null}if(p=t.baseState,m===null)t.memoizedState=p;else{a=m.next;var S=y=null,O=null,I=a,Y=!1;do{var $=I.lane&-536870913;if($!==I.lane?(Oe&$)===$:(Zn&$)===$){var z=I.revertLane;if(z===0)O!==null&&(O=O.next={lane:0,revertLane:0,gesture:null,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),$===Wa&&(Y=!0);else if((Zn&z)===z){I=I.next,z===Wa&&(Y=!0);continue}else $={lane:0,revertLane:I.revertLane,gesture:null,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},O===null?(S=O=$,y=p):O=O.next=$,be.lanes|=z,Li|=z;$=I.action,Ta&&s(p,$),p=I.hasEagerState?I.eagerState:s(p,$)}else z={lane:$,revertLane:I.revertLane,gesture:I.gesture,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null},O===null?(S=O=z,y=p):O=O.next=z,be.lanes|=$,Li|=$;I=I.next}while(I!==null&&I!==a);if(O===null?y=p:O.next=S,!Wt(p,t.memoizedState)&&(ht=!0,Y&&(s=$a,s!==null)))throw s;t.memoizedState=p,t.baseState=y,t.baseQueue=O,l.lastRenderedState=p}return m===null&&(l.lanes=0),[t.memoizedState,l.dispatch]}function xu(t){var a=ct(),s=a.queue;if(s===null)throw Error(r(311));s.lastRenderedReducer=t;var l=s.dispatch,m=s.pending,p=a.memoizedState;if(m!==null){s.pending=null;var y=m=m.next;do p=t(p,y.action),y=y.next;while(y!==m);Wt(p,a.memoizedState)||(ht=!0),a.memoizedState=p,a.baseQueue===null&&(a.baseState=p),s.lastRenderedState=p}return[p,l]}function dp(t,a,s){var l=be,m=ct(),p=De;if(p){if(s===void 0)throw Error(r(407));s=s()}else s=a();var y=!Wt((qe||m).memoizedState,s);if(y&&(m.memoizedState=s,ht=!0),m=m.queue,Lu(mp.bind(null,l,m,t),[t]),m.getSnapshot!==a||y||ft!==null&&ft.memoizedState.tag&1){if(l.flags|=2048,rr(9,{destroy:void 0},hp.bind(null,l,m,s,a),null),Ye===null)throw Error(r(349));p||(Zn&127)!==0||fp(l,a,s)}return s}function fp(t,a,s){t.flags|=16384,t={getSnapshot:a,value:s},a=be.updateQueue,a===null?(a=Ho(),be.updateQueue=a,a.stores=[t]):(s=a.stores,s===null?a.stores=[t]:s.push(t))}function hp(t,a,s,l){a.value=s,a.getSnapshot=l,pp(a)&&gp(t)}function mp(t,a,s){return s(function(){pp(a)&&gp(t)})}function pp(t){var a=t.getSnapshot;t=t.value;try{var s=a();return!Wt(t,s)}catch{return!0}}function gp(t){var a=fa(t,2);a!==null&&Ht(a,t,2)}function Pu(t){var a=Pt();if(typeof t=="function"){var s=t;if(t=s(),Ta){Ti(!0);try{s()}finally{Ti(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:t},a}function vp(t,a,s,l){return t.baseState=s,Mu(t,qe,typeof l=="function"?l:Wn)}function xC(t,a,s,l,m){if(Qo(t))throw Error(r(485));if(t=a.action,t!==null){var p={payload:m,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(y){p.listeners.push(y)}};V.T!==null?s(!0):p.isTransition=!1,l(p),s=a.pending,s===null?(p.next=a.pending=p,yp(a,p)):(p.next=s.next,a.pending=s.next=p)}}function yp(t,a){var s=a.action,l=a.payload,m=t.state;if(a.isTransition){var p=V.T,y={};V.T=y;try{var S=s(m,l),O=V.S;O!==null&&O(y,S),bp(t,a,S)}catch(I){Nu(t,a,I)}finally{p!==null&&y.types!==null&&(p.types=y.types),V.T=p}}else try{p=s(m,l),bp(t,a,p)}catch(I){Nu(t,a,I)}}function bp(t,a,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(l){Sp(t,a,l)},function(l){return Nu(t,a,l)}):Sp(t,a,s)}function Sp(t,a,s){a.status="fulfilled",a.value=s,Tp(a),t.state=s,a=t.pending,a!==null&&(s=a.next,s===a?t.pending=null:(s=s.next,a.next=s,yp(t,s)))}function Nu(t,a,s){var l=t.pending;if(t.pending=null,l!==null){l=l.next;do a.status="rejected",a.reason=s,Tp(a),a=a.next;while(a!==l)}t.action=null}function Tp(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function Cp(t,a){return a}function kp(t,a){if(De){var s=Ye.formState;if(s!==null){e:{var l=be;if(De){if(Qe){t:{for(var m=Qe,p=mn;m.nodeType!==8;){if(!p){m=null;break t}if(m=gn(m.nextSibling),m===null){m=null;break t}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){Qe=gn(m.nextSibling),l=m.data==="F!";break e}}Ri(l)}l=!1}l&&(a=s[0])}}return s=Pt(),s.memoizedState=s.baseState=a,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cp,lastRenderedState:a},s.queue=l,s=Vp.bind(null,be,l),l.dispatch=s,l=Pu(!1),p=zu.bind(null,be,!1,l.queue),l=Pt(),m={state:a,dispatch:null,action:t,pending:null},l.queue=m,s=xC.bind(null,be,m,p,s),m.dispatch=s,l.memoizedState=t,[a,s,!1]}function Ep(t){var a=ct();return _p(a,qe,t)}function _p(t,a,s){if(a=Mu(t,a,Cp)[0],t=Yo(Wn)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var l=fs(a)}catch(y){throw y===er?Uo:y}else l=a;a=ct();var m=a.queue,p=m.dispatch;return s!==a.memoizedState&&(be.flags|=2048,rr(9,{destroy:void 0},PC.bind(null,m,s),null)),[l,p,t]}function PC(t,a){t.action=a}function Rp(t){var a=ct(),s=qe;if(s!==null)return _p(a,s,t);ct(),a=a.memoizedState,s=ct();var l=s.queue.dispatch;return s.memoizedState=t,[a,l,!1]}function rr(t,a,s,l){return t={tag:t,create:s,deps:l,inst:a,next:null},a=be.updateQueue,a===null&&(a=Ho(),be.updateQueue=a),s=a.lastEffect,s===null?a.lastEffect=t.next=t:(l=s.next,s.next=t,t.next=l,a.lastEffect=t),t}function wp(){return ct().memoizedState}function Ko(t,a,s,l){var m=Pt();be.flags|=t,m.memoizedState=rr(1|a,{destroy:void 0},s,l===void 0?null:l)}function Jo(t,a,s,l){var m=ct();l=l===void 0?null:l;var p=m.memoizedState.inst;qe!==null&&l!==null&&_u(l,qe.memoizedState.deps)?m.memoizedState=rr(a,p,s,l):(be.flags|=t,m.memoizedState=rr(1|a,p,s,l))}function Op(t,a){Ko(8390656,8,t,a)}function Lu(t,a){Jo(2048,8,t,a)}function NC(t){be.flags|=4;var a=be.updateQueue;if(a===null)a=Ho(),be.updateQueue=a,a.events=[t];else{var s=a.events;s===null?a.events=[t]:s.push(t)}}function Ap(t){var a=ct().memoizedState;return NC({ref:a,nextImpl:t}),function(){if((je&2)!==0)throw Error(r(440));return a.impl.apply(void 0,arguments)}}function Dp(t,a){return Jo(4,2,t,a)}function Mp(t,a){return Jo(4,4,t,a)}function xp(t,a){if(typeof a=="function"){t=t();var s=a(t);return function(){typeof s=="function"?s():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function Pp(t,a,s){s=s!=null?s.concat([t]):null,Jo(4,4,xp.bind(null,a,t),s)}function Uu(){}function Np(t,a){var s=ct();a=a===void 0?null:a;var l=s.memoizedState;return a!==null&&_u(a,l[1])?l[0]:(s.memoizedState=[t,a],t)}function Lp(t,a){var s=ct();a=a===void 0?null:a;var l=s.memoizedState;if(a!==null&&_u(a,l[1]))return l[0];if(l=t(),Ta){Ti(!0);try{t()}finally{Ti(!1)}}return s.memoizedState=[l,a],l}function Iu(t,a,s){return s===void 0||(Zn&1073741824)!==0&&(Oe&261930)===0?t.memoizedState=a:(t.memoizedState=s,t=Ug(),be.lanes|=t,Li|=t,s)}function Up(t,a,s,l){return Wt(s,a)?s:nr.current!==null?(t=Iu(t,s,l),Wt(t,a)||(ht=!0),t):(Zn&42)===0||(Zn&1073741824)!==0&&(Oe&261930)===0?(ht=!0,t.memoizedState=s):(t=Ug(),be.lanes|=t,Li|=t,a)}function Ip(t,a,s,l,m){var p=ae.p;ae.p=p!==0&&8>p?p:8;var y=V.T,S={};V.T=S,zu(t,!1,a,s);try{var O=m(),I=V.S;if(I!==null&&I(S,O),O!==null&&typeof O=="object"&&typeof O.then=="function"){var Y=AC(O,l);hs(t,a,Y,rn(t))}else hs(t,a,l,rn(t))}catch($){hs(t,a,{then:function(){},status:"rejected",reason:$},rn())}finally{ae.p=p,y!==null&&S.types!==null&&(y.types=S.types),V.T=y}}function LC(){}function ju(t,a,s,l){if(t.tag!==5)throw Error(r(476));var m=jp(t).queue;Ip(t,m,a,ue,s===null?LC:function(){return Bp(t),s(l)})}function jp(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:ue,baseState:ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:ue},next:null};var s={};return a.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wn,lastRenderedState:s},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function Bp(t){var a=jp(t);a.next===null&&(a=t.alternate.memoizedState),hs(t,a.next.queue,{},rn())}function Bu(){return _t(Ds)}function zp(){return ct().memoizedState}function qp(){return ct().memoizedState}function UC(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var s=rn();t=Ai(s);var l=Di(a,t,s);l!==null&&(Ht(l,a,s),cs(l,a,s)),a={cache:mu()},t.payload=a;return}a=a.return}}function IC(t,a,s){var l=rn();s={lane:l,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},Qo(t)?Fp(a,s):(s=iu(t,a,s,l),s!==null&&(Ht(s,t,l),Hp(s,a,l)))}function Vp(t,a,s){var l=rn();hs(t,a,s,l)}function hs(t,a,s,l){var m={lane:l,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null};if(Qo(t))Fp(a,m);else{var p=t.alternate;if(t.lanes===0&&(p===null||p.lanes===0)&&(p=a.lastRenderedReducer,p!==null))try{var y=a.lastRenderedState,S=p(y,s);if(m.hasEagerState=!0,m.eagerState=S,Wt(S,y))return Ao(t,a,m,0),Ye===null&&Oo(),!1}catch{}if(s=iu(t,a,m,l),s!==null)return Ht(s,t,l),Hp(s,a,l),!0}return!1}function zu(t,a,s,l){if(l={lane:2,revertLane:yd(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Qo(t)){if(a)throw Error(r(479))}else a=iu(t,s,l,2),a!==null&&Ht(a,t,2)}function Qo(t){var a=t.alternate;return t===be||a!==null&&a===be}function Fp(t,a){ir=Vo=!0;var s=t.pending;s===null?a.next=a:(a.next=s.next,s.next=a),t.pending=a}function Hp(t,a,s){if((s&4194048)!==0){var l=a.lanes;l&=t.pendingLanes,s|=l,a.lanes=s,Qh(t,s)}}var ms={readContext:_t,use:Go,useCallback:nt,useContext:nt,useEffect:nt,useImperativeHandle:nt,useLayoutEffect:nt,useInsertionEffect:nt,useMemo:nt,useReducer:nt,useRef:nt,useState:nt,useDebugValue:nt,useDeferredValue:nt,useTransition:nt,useSyncExternalStore:nt,useId:nt,useHostTransitionStatus:nt,useFormState:nt,useActionState:nt,useOptimistic:nt,useMemoCache:nt,useCacheRefresh:nt};ms.useEffectEvent=nt;var Gp={readContext:_t,use:Go,useCallback:function(t,a){return Pt().memoizedState=[t,a===void 0?null:a],t},useContext:_t,useEffect:Op,useImperativeHandle:function(t,a,s){s=s!=null?s.concat([t]):null,Ko(4194308,4,xp.bind(null,a,t),s)},useLayoutEffect:function(t,a){return Ko(4194308,4,t,a)},useInsertionEffect:function(t,a){Ko(4,2,t,a)},useMemo:function(t,a){var s=Pt();a=a===void 0?null:a;var l=t();if(Ta){Ti(!0);try{t()}finally{Ti(!1)}}return s.memoizedState=[l,a],l},useReducer:function(t,a,s){var l=Pt();if(s!==void 0){var m=s(a);if(Ta){Ti(!0);try{s(a)}finally{Ti(!1)}}}else m=a;return l.memoizedState=l.baseState=m,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:m},l.queue=t,t=t.dispatch=IC.bind(null,be,t),[l.memoizedState,t]},useRef:function(t){var a=Pt();return t={current:t},a.memoizedState=t},useState:function(t){t=Pu(t);var a=t.queue,s=Vp.bind(null,be,a);return a.dispatch=s,[t.memoizedState,s]},useDebugValue:Uu,useDeferredValue:function(t,a){var s=Pt();return Iu(s,t,a)},useTransition:function(){var t=Pu(!1);return t=Ip.bind(null,be,t.queue,!0,!1),Pt().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,s){var l=be,m=Pt();if(De){if(s===void 0)throw Error(r(407));s=s()}else{if(s=a(),Ye===null)throw Error(r(349));(Oe&127)!==0||fp(l,a,s)}m.memoizedState=s;var p={value:s,getSnapshot:a};return m.queue=p,Op(mp.bind(null,l,p,t),[t]),l.flags|=2048,rr(9,{destroy:void 0},hp.bind(null,l,p,s,a),null),s},useId:function(){var t=Pt(),a=Ye.identifierPrefix;if(De){var s=Nn,l=Pn;s=(l&~(1<<32-Zt(l)-1)).toString(32)+s,a="_"+a+"R_"+s,s=Fo++,0<s&&(a+="H"+s.toString(32)),a+="_"}else s=DC++,a="_"+a+"r_"+s.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:Bu,useFormState:kp,useActionState:kp,useOptimistic:function(t){var a=Pt();a.memoizedState=a.baseState=t;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=s,a=zu.bind(null,be,!0,s),s.dispatch=a,[t,a]},useMemoCache:Du,useCacheRefresh:function(){return Pt().memoizedState=UC.bind(null,be)},useEffectEvent:function(t){var a=Pt(),s={impl:t};return a.memoizedState=s,function(){if((je&2)!==0)throw Error(r(440));return s.impl.apply(void 0,arguments)}}},qu={readContext:_t,use:Go,useCallback:Np,useContext:_t,useEffect:Lu,useImperativeHandle:Pp,useInsertionEffect:Dp,useLayoutEffect:Mp,useMemo:Lp,useReducer:Yo,useRef:wp,useState:function(){return Yo(Wn)},useDebugValue:Uu,useDeferredValue:function(t,a){var s=ct();return Up(s,qe.memoizedState,t,a)},useTransition:function(){var t=Yo(Wn)[0],a=ct().memoizedState;return[typeof t=="boolean"?t:fs(t),a]},useSyncExternalStore:dp,useId:zp,useHostTransitionStatus:Bu,useFormState:Ep,useActionState:Ep,useOptimistic:function(t,a){var s=ct();return vp(s,qe,t,a)},useMemoCache:Du,useCacheRefresh:qp};qu.useEffectEvent=Ap;var Yp={readContext:_t,use:Go,useCallback:Np,useContext:_t,useEffect:Lu,useImperativeHandle:Pp,useInsertionEffect:Dp,useLayoutEffect:Mp,useMemo:Lp,useReducer:xu,useRef:wp,useState:function(){return xu(Wn)},useDebugValue:Uu,useDeferredValue:function(t,a){var s=ct();return qe===null?Iu(s,t,a):Up(s,qe.memoizedState,t,a)},useTransition:function(){var t=xu(Wn)[0],a=ct().memoizedState;return[typeof t=="boolean"?t:fs(t),a]},useSyncExternalStore:dp,useId:zp,useHostTransitionStatus:Bu,useFormState:Rp,useActionState:Rp,useOptimistic:function(t,a){var s=ct();return qe!==null?vp(s,qe,t,a):(s.baseState=t,[t,s.queue.dispatch])},useMemoCache:Du,useCacheRefresh:qp};Yp.useEffectEvent=Ap;function Vu(t,a,s,l){a=t.memoizedState,s=s(l,a),s=s==null?a:v({},a,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var Fu={enqueueSetState:function(t,a,s){t=t._reactInternals;var l=rn(),m=Ai(l);m.payload=a,s!=null&&(m.callback=s),a=Di(t,m,l),a!==null&&(Ht(a,t,l),cs(a,t,l))},enqueueReplaceState:function(t,a,s){t=t._reactInternals;var l=rn(),m=Ai(l);m.tag=1,m.payload=a,s!=null&&(m.callback=s),a=Di(t,m,l),a!==null&&(Ht(a,t,l),cs(a,t,l))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var s=rn(),l=Ai(s);l.tag=2,a!=null&&(l.callback=a),a=Di(t,l,s),a!==null&&(Ht(a,t,s),cs(a,t,s))}};function Kp(t,a,s,l,m,p,y){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(l,p,y):a.prototype&&a.prototype.isPureReactComponent?!es(s,l)||!es(m,p):!0}function Jp(t,a,s,l){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(s,l),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(s,l),a.state!==t&&Fu.enqueueReplaceState(a,a.state,null)}function Ca(t,a){var s=a;if("ref"in a){s={};for(var l in a)l!=="ref"&&(s[l]=a[l])}if(t=t.defaultProps){s===a&&(s=v({},s));for(var m in t)s[m]===void 0&&(s[m]=t[m])}return s}function Qp(t){wo(t)}function Xp(t){console.error(t)}function Zp(t){wo(t)}function Xo(t,a){try{var s=t.onUncaughtError;s(a.value,{componentStack:a.stack})}catch(l){setTimeout(function(){throw l})}}function Wp(t,a,s){try{var l=t.onCaughtError;l(s.value,{componentStack:s.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Hu(t,a,s){return s=Ai(s),s.tag=3,s.payload={element:null},s.callback=function(){Xo(t,a)},s}function $p(t){return t=Ai(t),t.tag=3,t}function eg(t,a,s,l){var m=s.type.getDerivedStateFromError;if(typeof m=="function"){var p=l.value;t.payload=function(){return m(p)},t.callback=function(){Wp(a,s,l)}}var y=s.stateNode;y!==null&&typeof y.componentDidCatch=="function"&&(t.callback=function(){Wp(a,s,l),typeof m!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var S=l.stack;this.componentDidCatch(l.value,{componentStack:S!==null?S:""})})}function jC(t,a,s,l,m){if(s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(a=s.alternate,a!==null&&Za(a,s,m,!0),s=en.current,s!==null){switch(s.tag){case 31:case 13:return pn===null?cc():s.alternate===null&&it===0&&(it=3),s.flags&=-257,s.flags|=65536,s.lanes=m,l===Io?s.flags|=16384:(a=s.updateQueue,a===null?s.updateQueue=new Set([l]):a.add(l),pd(t,l,m)),!1;case 22:return s.flags|=65536,l===Io?s.flags|=16384:(a=s.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([l])},s.updateQueue=a):(s=a.retryQueue,s===null?a.retryQueue=new Set([l]):s.add(l)),pd(t,l,m)),!1}throw Error(r(435,s.tag))}return pd(t,l,m),cc(),!1}if(De)return a=en.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,l!==lu&&(t=Error(r(422),{cause:l}),is(dn(t,s)))):(l!==lu&&(a=Error(r(423),{cause:l}),is(dn(a,s))),t=t.current.alternate,t.flags|=65536,m&=-m,t.lanes|=m,l=dn(l,s),m=Hu(t.stateNode,l,m),Su(t,m),it!==4&&(it=2)),!1;var p=Error(r(520),{cause:l});if(p=dn(p,s),Cs===null?Cs=[p]:Cs.push(p),it!==4&&(it=2),a===null)return!0;l=dn(l,s),s=a;do{switch(s.tag){case 3:return s.flags|=65536,t=m&-m,s.lanes|=t,t=Hu(s.stateNode,l,t),Su(s,t),!1;case 1:if(a=s.type,p=s.stateNode,(s.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Ui===null||!Ui.has(p))))return s.flags|=65536,m&=-m,s.lanes|=m,m=$p(m),eg(m,t,s,l),Su(s,m),!1}s=s.return}while(s!==null);return!1}var Gu=Error(r(461)),ht=!1;function Rt(t,a,s,l){a.child=t===null?ap(a,null,s,l):Sa(a,t.child,s,l)}function tg(t,a,s,l,m){s=s.render;var p=a.ref;if("ref"in l){var y={};for(var S in l)S!=="ref"&&(y[S]=l[S])}else y=l;return ga(a),l=Ru(t,a,s,y,p,m),S=wu(),t!==null&&!ht?(Ou(t,a,m),$n(t,a,m)):(De&&S&&ou(a),a.flags|=1,Rt(t,a,l,m),a.child)}function ng(t,a,s,l,m){if(t===null){var p=s.type;return typeof p=="function"&&!au(p)&&p.defaultProps===void 0&&s.compare===null?(a.tag=15,a.type=p,ig(t,a,p,l,m)):(t=Mo(s.type,null,l,a,a.mode,m),t.ref=a.ref,t.return=a,a.child=t)}if(p=t.child,!$u(t,m)){var y=p.memoizedProps;if(s=s.compare,s=s!==null?s:es,s(y,l)&&t.ref===a.ref)return $n(t,a,m)}return a.flags|=1,t=Kn(p,l),t.ref=a.ref,t.return=a,a.child=t}function ig(t,a,s,l,m){if(t!==null){var p=t.memoizedProps;if(es(p,l)&&t.ref===a.ref)if(ht=!1,a.pendingProps=l=p,$u(t,m))(t.flags&131072)!==0&&(ht=!0);else return a.lanes=t.lanes,$n(t,a,m)}return Yu(t,a,s,l,m)}function ag(t,a,s,l){var m=l.children,p=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((a.flags&128)!==0){if(p=p!==null?p.baseLanes|s:s,t!==null){for(l=a.child=t.child,m=0;l!==null;)m=m|l.lanes|l.childLanes,l=l.sibling;l=m&~p}else l=0,a.child=null;return rg(t,a,p,s,l)}if((s&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&Lo(a,p!==null?p.cachePool:null),p!==null?op(a,p):Cu(),cp(a);else return l=a.lanes=536870912,rg(t,a,p!==null?p.baseLanes|s:s,s,l)}else p!==null?(Lo(a,p.cachePool),op(a,p),xi(),a.memoizedState=null):(t!==null&&Lo(a,null),Cu(),xi());return Rt(t,a,m,s),a.child}function ps(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function rg(t,a,s,l,m){var p=gu();return p=p===null?null:{parent:dt._currentValue,pool:p},a.memoizedState={baseLanes:s,cachePool:p},t!==null&&Lo(a,null),Cu(),cp(a),t!==null&&Za(t,a,l,!0),a.childLanes=m,null}function Zo(t,a){return a=$o({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function sg(t,a,s){return Sa(a,t.child,null,s),t=Zo(a,a.pendingProps),t.flags|=2,tn(a),a.memoizedState=null,t}function BC(t,a,s){var l=a.pendingProps,m=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(De){if(l.mode==="hidden")return t=Zo(a,l),a.lanes=536870912,ps(null,t);if(Eu(a),(t=Qe)?(t=yv(t,mn),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Ei!==null?{id:Pn,overflow:Nn}:null,retryLane:536870912,hydrationErrors:null},s=Fm(t),s.return=a,a.child=s,Et=a,Qe=null)):t=null,t===null)throw Ri(a);return a.lanes=536870912,null}return Zo(a,l)}var p=t.memoizedState;if(p!==null){var y=p.dehydrated;if(Eu(a),m)if(a.flags&256)a.flags&=-257,a=sg(t,a,s);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(r(558));else if(ht||Za(t,a,s,!1),m=(s&t.childLanes)!==0,ht||m){if(l=Ye,l!==null&&(y=Xh(l,s),y!==0&&y!==p.retryLane))throw p.retryLane=y,fa(t,y),Ht(l,t,y),Gu;cc(),a=sg(t,a,s)}else t=p.treeContext,Qe=gn(y.nextSibling),Et=a,De=!0,_i=null,mn=!1,t!==null&&Ym(a,t),a=Zo(a,l),a.flags|=4096;return a}return t=Kn(t.child,{mode:l.mode,children:l.children}),t.ref=a.ref,a.child=t,t.return=a,t}function Wo(t,a){var s=a.ref;if(s===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(r(284));(t===null||t.ref!==s)&&(a.flags|=4194816)}}function Yu(t,a,s,l,m){return ga(a),s=Ru(t,a,s,l,void 0,m),l=wu(),t!==null&&!ht?(Ou(t,a,m),$n(t,a,m)):(De&&l&&ou(a),a.flags|=1,Rt(t,a,s,m),a.child)}function og(t,a,s,l,m,p){return ga(a),a.updateQueue=null,s=up(a,l,s,m),lp(t),l=wu(),t!==null&&!ht?(Ou(t,a,p),$n(t,a,p)):(De&&l&&ou(a),a.flags|=1,Rt(t,a,s,p),a.child)}function cg(t,a,s,l,m){if(ga(a),a.stateNode===null){var p=Ka,y=s.contextType;typeof y=="object"&&y!==null&&(p=_t(y)),p=new s(l,p),a.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Fu,a.stateNode=p,p._reactInternals=a,p=a.stateNode,p.props=l,p.state=a.memoizedState,p.refs={},yu(a),y=s.contextType,p.context=typeof y=="object"&&y!==null?_t(y):Ka,p.state=a.memoizedState,y=s.getDerivedStateFromProps,typeof y=="function"&&(Vu(a,s,y,l),p.state=a.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(y=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),y!==p.state&&Fu.enqueueReplaceState(p,p.state,null),us(a,l,p,m),ls(),p.state=a.memoizedState),typeof p.componentDidMount=="function"&&(a.flags|=4194308),l=!0}else if(t===null){p=a.stateNode;var S=a.memoizedProps,O=Ca(s,S);p.props=O;var I=p.context,Y=s.contextType;y=Ka,typeof Y=="object"&&Y!==null&&(y=_t(Y));var $=s.getDerivedStateFromProps;Y=typeof $=="function"||typeof p.getSnapshotBeforeUpdate=="function",S=a.pendingProps!==S,Y||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(S||I!==y)&&Jp(a,p,l,y),Oi=!1;var z=a.memoizedState;p.state=z,us(a,l,p,m),ls(),I=a.memoizedState,S||z!==I||Oi?(typeof $=="function"&&(Vu(a,s,$,l),I=a.memoizedState),(O=Oi||Kp(a,s,O,l,z,I,y))?(Y||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(a.flags|=4194308)):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=l,a.memoizedState=I),p.props=l,p.state=I,p.context=y,l=O):(typeof p.componentDidMount=="function"&&(a.flags|=4194308),l=!1)}else{p=a.stateNode,bu(t,a),y=a.memoizedProps,Y=Ca(s,y),p.props=Y,$=a.pendingProps,z=p.context,I=s.contextType,O=Ka,typeof I=="object"&&I!==null&&(O=_t(I)),S=s.getDerivedStateFromProps,(I=typeof S=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(y!==$||z!==O)&&Jp(a,p,l,O),Oi=!1,z=a.memoizedState,p.state=z,us(a,l,p,m),ls();var F=a.memoizedState;y!==$||z!==F||Oi||t!==null&&t.dependencies!==null&&Po(t.dependencies)?(typeof S=="function"&&(Vu(a,s,S,l),F=a.memoizedState),(Y=Oi||Kp(a,s,Y,l,z,F,O)||t!==null&&t.dependencies!==null&&Po(t.dependencies))?(I||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(l,F,O),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(l,F,O)),typeof p.componentDidUpdate=="function"&&(a.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&z===t.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&z===t.memoizedState||(a.flags|=1024),a.memoizedProps=l,a.memoizedState=F),p.props=l,p.state=F,p.context=O,l=Y):(typeof p.componentDidUpdate!="function"||y===t.memoizedProps&&z===t.memoizedState||(a.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&z===t.memoizedState||(a.flags|=1024),l=!1)}return p=l,Wo(t,a),l=(a.flags&128)!==0,p||l?(p=a.stateNode,s=l&&typeof s.getDerivedStateFromError!="function"?null:p.render(),a.flags|=1,t!==null&&l?(a.child=Sa(a,t.child,null,m),a.child=Sa(a,null,s,m)):Rt(t,a,s,m),a.memoizedState=p.state,t=a.child):t=$n(t,a,m),t}function lg(t,a,s,l){return ma(),a.flags|=256,Rt(t,a,s,l),a.child}var Ku={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ju(t){return{baseLanes:t,cachePool:Wm()}}function Qu(t,a,s){return t=t!==null?t.childLanes&~s:0,a&&(t|=an),t}function ug(t,a,s){var l=a.pendingProps,m=!1,p=(a.flags&128)!==0,y;if((y=p)||(y=t!==null&&t.memoizedState===null?!1:(ot.current&2)!==0),y&&(m=!0,a.flags&=-129),y=(a.flags&32)!==0,a.flags&=-33,t===null){if(De){if(m?Mi(a):xi(),(t=Qe)?(t=yv(t,mn),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Ei!==null?{id:Pn,overflow:Nn}:null,retryLane:536870912,hydrationErrors:null},s=Fm(t),s.return=a,a.child=s,Et=a,Qe=null)):t=null,t===null)throw Ri(a);return Md(t)?a.lanes=32:a.lanes=536870912,null}var S=l.children;return l=l.fallback,m?(xi(),m=a.mode,S=$o({mode:"hidden",children:S},m),l=ha(l,m,s,null),S.return=a,l.return=a,S.sibling=l,a.child=S,l=a.child,l.memoizedState=Ju(s),l.childLanes=Qu(t,y,s),a.memoizedState=Ku,ps(null,l)):(Mi(a),Xu(a,S))}var O=t.memoizedState;if(O!==null&&(S=O.dehydrated,S!==null)){if(p)a.flags&256?(Mi(a),a.flags&=-257,a=Zu(t,a,s)):a.memoizedState!==null?(xi(),a.child=t.child,a.flags|=128,a=null):(xi(),S=l.fallback,m=a.mode,l=$o({mode:"visible",children:l.children},m),S=ha(S,m,s,null),S.flags|=2,l.return=a,S.return=a,l.sibling=S,a.child=l,Sa(a,t.child,null,s),l=a.child,l.memoizedState=Ju(s),l.childLanes=Qu(t,y,s),a.memoizedState=Ku,a=ps(null,l));else if(Mi(a),Md(S)){if(y=S.nextSibling&&S.nextSibling.dataset,y)var I=y.dgst;y=I,l=Error(r(419)),l.stack="",l.digest=y,is({value:l,source:null,stack:null}),a=Zu(t,a,s)}else if(ht||Za(t,a,s,!1),y=(s&t.childLanes)!==0,ht||y){if(y=Ye,y!==null&&(l=Xh(y,s),l!==0&&l!==O.retryLane))throw O.retryLane=l,fa(t,l),Ht(y,t,l),Gu;Dd(S)||cc(),a=Zu(t,a,s)}else Dd(S)?(a.flags|=192,a.child=t.child,a=null):(t=O.treeContext,Qe=gn(S.nextSibling),Et=a,De=!0,_i=null,mn=!1,t!==null&&Ym(a,t),a=Xu(a,l.children),a.flags|=4096);return a}return m?(xi(),S=l.fallback,m=a.mode,O=t.child,I=O.sibling,l=Kn(O,{mode:"hidden",children:l.children}),l.subtreeFlags=O.subtreeFlags&65011712,I!==null?S=Kn(I,S):(S=ha(S,m,s,null),S.flags|=2),S.return=a,l.return=a,l.sibling=S,a.child=l,ps(null,l),l=a.child,S=t.child.memoizedState,S===null?S=Ju(s):(m=S.cachePool,m!==null?(O=dt._currentValue,m=m.parent!==O?{parent:O,pool:O}:m):m=Wm(),S={baseLanes:S.baseLanes|s,cachePool:m}),l.memoizedState=S,l.childLanes=Qu(t,y,s),a.memoizedState=Ku,ps(t.child,l)):(Mi(a),s=t.child,t=s.sibling,s=Kn(s,{mode:"visible",children:l.children}),s.return=a,s.sibling=null,t!==null&&(y=a.deletions,y===null?(a.deletions=[t],a.flags|=16):y.push(t)),a.child=s,a.memoizedState=null,s)}function Xu(t,a){return a=$o({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function $o(t,a){return t=$t(22,t,null,a),t.lanes=0,t}function Zu(t,a,s){return Sa(a,t.child,null,s),t=Xu(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function dg(t,a,s){t.lanes|=a;var l=t.alternate;l!==null&&(l.lanes|=a),fu(t.return,a,s)}function Wu(t,a,s,l,m,p){var y=t.memoizedState;y===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:m,treeForkCount:p}:(y.isBackwards=a,y.rendering=null,y.renderingStartTime=0,y.last=l,y.tail=s,y.tailMode=m,y.treeForkCount=p)}function fg(t,a,s){var l=a.pendingProps,m=l.revealOrder,p=l.tail;l=l.children;var y=ot.current,S=(y&2)!==0;if(S?(y=y&1|2,a.flags|=128):y&=1,se(ot,y),Rt(t,a,l,s),l=De?ns:0,!S&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dg(t,s,a);else if(t.tag===19)dg(t,s,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(m){case"forwards":for(s=a.child,m=null;s!==null;)t=s.alternate,t!==null&&qo(t)===null&&(m=s),s=s.sibling;s=m,s===null?(m=a.child,a.child=null):(m=s.sibling,s.sibling=null),Wu(a,!1,m,s,p,l);break;case"backwards":case"unstable_legacy-backwards":for(s=null,m=a.child,a.child=null;m!==null;){if(t=m.alternate,t!==null&&qo(t)===null){a.child=m;break}t=m.sibling,m.sibling=s,s=m,m=t}Wu(a,!0,s,null,p,l);break;case"together":Wu(a,!1,null,null,void 0,l);break;default:a.memoizedState=null}return a.child}function $n(t,a,s){if(t!==null&&(a.dependencies=t.dependencies),Li|=a.lanes,(s&a.childLanes)===0)if(t!==null){if(Za(t,a,s,!1),(s&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(r(153));if(a.child!==null){for(t=a.child,s=Kn(t,t.pendingProps),a.child=s,s.return=a;t.sibling!==null;)t=t.sibling,s=s.sibling=Kn(t,t.pendingProps),s.return=a;s.sibling=null}return a.child}function $u(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&Po(t)))}function zC(t,a,s){switch(a.tag){case 3:Ze(a,a.stateNode.containerInfo),wi(a,dt,t.memoizedState.cache),ma();break;case 27:case 5:Si(a);break;case 4:Ze(a,a.stateNode.containerInfo);break;case 10:wi(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Eu(a),null;break;case 13:var l=a.memoizedState;if(l!==null)return l.dehydrated!==null?(Mi(a),a.flags|=128,null):(s&a.child.childLanes)!==0?ug(t,a,s):(Mi(a),t=$n(t,a,s),t!==null?t.sibling:null);Mi(a);break;case 19:var m=(t.flags&128)!==0;if(l=(s&a.childLanes)!==0,l||(Za(t,a,s,!1),l=(s&a.childLanes)!==0),m){if(l)return fg(t,a,s);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),se(ot,ot.current),l)break;return null;case 22:return a.lanes=0,ag(t,a,s,a.pendingProps);case 24:wi(a,dt,t.memoizedState.cache)}return $n(t,a,s)}function hg(t,a,s){if(t!==null)if(t.memoizedProps!==a.pendingProps)ht=!0;else{if(!$u(t,s)&&(a.flags&128)===0)return ht=!1,zC(t,a,s);ht=(t.flags&131072)!==0}else ht=!1,De&&(a.flags&1048576)!==0&&Gm(a,ns,a.index);switch(a.lanes=0,a.tag){case 16:e:{var l=a.pendingProps;if(t=ya(a.elementType),a.type=t,typeof t=="function")au(t)?(l=Ca(t,l),a.tag=1,a=cg(null,a,t,l,s)):(a.tag=0,a=Yu(null,a,t,l,s));else{if(t!=null){var m=t.$$typeof;if(m===E){a.tag=11,a=tg(null,a,t,l,s);break e}else if(m===L){a.tag=14,a=ng(null,a,t,l,s);break e}}throw a=Ne(t)||t,Error(r(306,a,""))}}return a;case 0:return Yu(t,a,a.type,a.pendingProps,s);case 1:return l=a.type,m=Ca(l,a.pendingProps),cg(t,a,l,m,s);case 3:e:{if(Ze(a,a.stateNode.containerInfo),t===null)throw Error(r(387));l=a.pendingProps;var p=a.memoizedState;m=p.element,bu(t,a),us(a,l,null,s);var y=a.memoizedState;if(l=y.cache,wi(a,dt,l),l!==p.cache&&hu(a,[dt],s,!0),ls(),l=y.element,p.isDehydrated)if(p={element:l,isDehydrated:!1,cache:y.cache},a.updateQueue.baseState=p,a.memoizedState=p,a.flags&256){a=lg(t,a,l,s);break e}else if(l!==m){m=dn(Error(r(424)),a),is(m),a=lg(t,a,l,s);break e}else for(t=a.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,Qe=gn(t.firstChild),Et=a,De=!0,_i=null,mn=!0,s=ap(a,null,l,s),a.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(ma(),l===m){a=$n(t,a,s);break e}Rt(t,a,l,s)}a=a.child}return a;case 26:return Wo(t,a),t===null?(s=Ev(a.type,null,a.pendingProps,null))?a.memoizedState=s:De||(s=a.type,t=a.pendingProps,l=pc(ge.current).createElement(s),l[kt]=a,l[jt]=t,wt(l,s,t),bt(l),a.stateNode=l):a.memoizedState=Ev(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return Si(a),t===null&&De&&(l=a.stateNode=Tv(a.type,a.pendingProps,ge.current),Et=a,mn=!0,m=Qe,zi(a.type)?(xd=m,Qe=gn(l.firstChild)):Qe=m),Rt(t,a,a.pendingProps.children,s),Wo(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&De&&((m=l=Qe)&&(l=gk(l,a.type,a.pendingProps,mn),l!==null?(a.stateNode=l,Et=a,Qe=gn(l.firstChild),mn=!1,m=!0):m=!1),m||Ri(a)),Si(a),m=a.type,p=a.pendingProps,y=t!==null?t.memoizedProps:null,l=p.children,wd(m,p)?l=null:y!==null&&wd(m,y)&&(a.flags|=32),a.memoizedState!==null&&(m=Ru(t,a,MC,null,null,s),Ds._currentValue=m),Wo(t,a),Rt(t,a,l,s),a.child;case 6:return t===null&&De&&((t=s=Qe)&&(s=vk(s,a.pendingProps,mn),s!==null?(a.stateNode=s,Et=a,Qe=null,t=!0):t=!1),t||Ri(a)),null;case 13:return ug(t,a,s);case 4:return Ze(a,a.stateNode.containerInfo),l=a.pendingProps,t===null?a.child=Sa(a,null,l,s):Rt(t,a,l,s),a.child;case 11:return tg(t,a,a.type,a.pendingProps,s);case 7:return Rt(t,a,a.pendingProps,s),a.child;case 8:return Rt(t,a,a.pendingProps.children,s),a.child;case 12:return Rt(t,a,a.pendingProps.children,s),a.child;case 10:return l=a.pendingProps,wi(a,a.type,l.value),Rt(t,a,l.children,s),a.child;case 9:return m=a.type._context,l=a.pendingProps.children,ga(a),m=_t(m),l=l(m),a.flags|=1,Rt(t,a,l,s),a.child;case 14:return ng(t,a,a.type,a.pendingProps,s);case 15:return ig(t,a,a.type,a.pendingProps,s);case 19:return fg(t,a,s);case 31:return BC(t,a,s);case 22:return ag(t,a,s,a.pendingProps);case 24:return ga(a),l=_t(dt),t===null?(m=gu(),m===null&&(m=Ye,p=mu(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=s),m=p),a.memoizedState={parent:l,cache:m},yu(a),wi(a,dt,m)):((t.lanes&s)!==0&&(bu(t,a),us(a,null,null,s),ls()),m=t.memoizedState,p=a.memoizedState,m.parent!==l?(m={parent:l,cache:l},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),wi(a,dt,l)):(l=p.cache,wi(a,dt,l),l!==m.cache&&hu(a,[dt],s,!0))),Rt(t,a,a.pendingProps.children,s),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function ei(t){t.flags|=4}function ed(t,a,s,l,m){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(m&335544128)===m)if(t.stateNode.complete)t.flags|=8192;else if(zg())t.flags|=8192;else throw ba=Io,vu}else t.flags&=-16777217}function mg(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Av(a))if(zg())t.flags|=8192;else throw ba=Io,vu}function ec(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?Kh():536870912,t.lanes|=a,lr|=a)}function gs(t,a){if(!De)switch(t.tailMode){case"hidden":a=t.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:l.sibling=null}}function Xe(t){var a=t.alternate!==null&&t.alternate.child===t.child,s=0,l=0;if(a)for(var m=t.child;m!==null;)s|=m.lanes|m.childLanes,l|=m.subtreeFlags&65011712,l|=m.flags&65011712,m.return=t,m=m.sibling;else for(m=t.child;m!==null;)s|=m.lanes|m.childLanes,l|=m.subtreeFlags,l|=m.flags,m.return=t,m=m.sibling;return t.subtreeFlags|=l,t.childLanes=s,a}function qC(t,a,s){var l=a.pendingProps;switch(cu(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xe(a),null;case 1:return Xe(a),null;case 3:return s=a.stateNode,l=null,t!==null&&(l=t.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),Xn(dt),Ge(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Xa(a)?ei(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,uu())),Xe(a),null;case 26:var m=a.type,p=a.memoizedState;return t===null?(ei(a),p!==null?(Xe(a),mg(a,p)):(Xe(a),ed(a,m,null,l,s))):p?p!==t.memoizedState?(ei(a),Xe(a),mg(a,p)):(Xe(a),a.flags&=-16777217):(t=t.memoizedProps,t!==l&&ei(a),Xe(a),ed(a,m,t,l,s)),null;case 27:if(uo(a),s=ge.current,m=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==l&&ei(a);else{if(!l){if(a.stateNode===null)throw Error(r(166));return Xe(a),null}t=oe.current,Xa(a)?Km(a):(t=Tv(m,l,s),a.stateNode=t,ei(a))}return Xe(a),null;case 5:if(uo(a),m=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==l&&ei(a);else{if(!l){if(a.stateNode===null)throw Error(r(166));return Xe(a),null}if(p=oe.current,Xa(a))Km(a);else{var y=pc(ge.current);switch(p){case 1:p=y.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:p=y.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":p=y.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":p=y.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":p=y.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof l.is=="string"?y.createElement("select",{is:l.is}):y.createElement("select"),l.multiple?p.multiple=!0:l.size&&(p.size=l.size);break;default:p=typeof l.is=="string"?y.createElement(m,{is:l.is}):y.createElement(m)}}p[kt]=a,p[jt]=l;e:for(y=a.child;y!==null;){if(y.tag===5||y.tag===6)p.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===a)break e;for(;y.sibling===null;){if(y.return===null||y.return===a)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}a.stateNode=p;e:switch(wt(p,m,l),m){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&ei(a)}}return Xe(a),ed(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,s),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==l&&ei(a);else{if(typeof l!="string"&&a.stateNode===null)throw Error(r(166));if(t=ge.current,Xa(a)){if(t=a.stateNode,s=a.memoizedProps,l=null,m=Et,m!==null)switch(m.tag){case 27:case 5:l=m.memoizedProps}t[kt]=a,t=!!(t.nodeValue===s||l!==null&&l.suppressHydrationWarning===!0||uv(t.nodeValue,s)),t||Ri(a,!0)}else t=pc(t).createTextNode(l),t[kt]=a,a.stateNode=t}return Xe(a),null;case 31:if(s=a.memoizedState,t===null||t.memoizedState!==null){if(l=Xa(a),s!==null){if(t===null){if(!l)throw Error(r(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(557));t[kt]=a}else ma(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Xe(a),t=!1}else s=uu(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=s),t=!0;if(!t)return a.flags&256?(tn(a),a):(tn(a),null);if((a.flags&128)!==0)throw Error(r(558))}return Xe(a),null;case 13:if(l=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(m=Xa(a),l!==null&&l.dehydrated!==null){if(t===null){if(!m)throw Error(r(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));m[kt]=a}else ma(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Xe(a),m=!1}else m=uu(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(tn(a),a):(tn(a),null)}return tn(a),(a.flags&128)!==0?(a.lanes=s,a):(s=l!==null,t=t!==null&&t.memoizedState!==null,s&&(l=a.child,m=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(m=l.alternate.memoizedState.cachePool.pool),p=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),p!==m&&(l.flags|=2048)),s!==t&&s&&(a.child.flags|=8192),ec(a,a.updateQueue),Xe(a),null);case 4:return Ge(),t===null&&Cd(a.stateNode.containerInfo),Xe(a),null;case 10:return Xn(a.type),Xe(a),null;case 19:if(X(ot),l=a.memoizedState,l===null)return Xe(a),null;if(m=(a.flags&128)!==0,p=l.rendering,p===null)if(m)gs(l,!1);else{if(it!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(p=qo(t),p!==null){for(a.flags|=128,gs(l,!1),t=p.updateQueue,a.updateQueue=t,ec(a,t),a.subtreeFlags=0,t=s,s=a.child;s!==null;)Vm(s,t),s=s.sibling;return se(ot,ot.current&1|2),De&&Jn(a,l.treeForkCount),a.child}t=t.sibling}l.tail!==null&&Qt()>rc&&(a.flags|=128,m=!0,gs(l,!1),a.lanes=4194304)}else{if(!m)if(t=qo(p),t!==null){if(a.flags|=128,m=!0,t=t.updateQueue,a.updateQueue=t,ec(a,t),gs(l,!0),l.tail===null&&l.tailMode==="hidden"&&!p.alternate&&!De)return Xe(a),null}else 2*Qt()-l.renderingStartTime>rc&&s!==536870912&&(a.flags|=128,m=!0,gs(l,!1),a.lanes=4194304);l.isBackwards?(p.sibling=a.child,a.child=p):(t=l.last,t!==null?t.sibling=p:a.child=p,l.last=p)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Qt(),t.sibling=null,s=ot.current,se(ot,m?s&1|2:s&1),De&&Jn(a,l.treeForkCount),t):(Xe(a),null);case 22:case 23:return tn(a),ku(),l=a.memoizedState!==null,t!==null?t.memoizedState!==null!==l&&(a.flags|=8192):l&&(a.flags|=8192),l?(s&536870912)!==0&&(a.flags&128)===0&&(Xe(a),a.subtreeFlags&6&&(a.flags|=8192)):Xe(a),s=a.updateQueue,s!==null&&ec(a,s.retryQueue),s=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),l=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),l!==s&&(a.flags|=2048),t!==null&&X(va),null;case 24:return s=null,t!==null&&(s=t.memoizedState.cache),a.memoizedState.cache!==s&&(a.flags|=2048),Xn(dt),Xe(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function VC(t,a){switch(cu(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return Xn(dt),Ge(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return uo(a),null;case 31:if(a.memoizedState!==null){if(tn(a),a.alternate===null)throw Error(r(340));ma()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(tn(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(r(340));ma()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return X(ot),null;case 4:return Ge(),null;case 10:return Xn(a.type),null;case 22:case 23:return tn(a),ku(),t!==null&&X(va),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return Xn(dt),null;case 25:return null;default:return null}}function pg(t,a){switch(cu(a),a.tag){case 3:Xn(dt),Ge();break;case 26:case 27:case 5:uo(a);break;case 4:Ge();break;case 31:a.memoizedState!==null&&tn(a);break;case 13:tn(a);break;case 19:X(ot);break;case 10:Xn(a.type);break;case 22:case 23:tn(a),ku(),t!==null&&X(va);break;case 24:Xn(dt)}}function vs(t,a){try{var s=a.updateQueue,l=s!==null?s.lastEffect:null;if(l!==null){var m=l.next;s=m;do{if((s.tag&t)===t){l=void 0;var p=s.create,y=s.inst;l=p(),y.destroy=l}s=s.next}while(s!==m)}}catch(S){ze(a,a.return,S)}}function Pi(t,a,s){try{var l=a.updateQueue,m=l!==null?l.lastEffect:null;if(m!==null){var p=m.next;l=p;do{if((l.tag&t)===t){var y=l.inst,S=y.destroy;if(S!==void 0){y.destroy=void 0,m=a;var O=s,I=S;try{I()}catch(Y){ze(m,O,Y)}}}l=l.next}while(l!==p)}}catch(Y){ze(a,a.return,Y)}}function gg(t){var a=t.updateQueue;if(a!==null){var s=t.stateNode;try{sp(a,s)}catch(l){ze(t,t.return,l)}}}function vg(t,a,s){s.props=Ca(t.type,t.memoizedProps),s.state=t.memoizedState;try{s.componentWillUnmount()}catch(l){ze(t,a,l)}}function ys(t,a){try{var s=t.ref;if(s!==null){switch(t.tag){case 26:case 27:case 5:var l=t.stateNode;break;case 30:l=t.stateNode;break;default:l=t.stateNode}typeof s=="function"?t.refCleanup=s(l):s.current=l}}catch(m){ze(t,a,m)}}function Ln(t,a){var s=t.ref,l=t.refCleanup;if(s!==null)if(typeof l=="function")try{l()}catch(m){ze(t,a,m)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(m){ze(t,a,m)}else s.current=null}function yg(t){var a=t.type,s=t.memoizedProps,l=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":s.autoFocus&&l.focus();break e;case"img":s.src?l.src=s.src:s.srcSet&&(l.srcset=s.srcSet)}}catch(m){ze(t,t.return,m)}}function td(t,a,s){try{var l=t.stateNode;uk(l,t.type,s,a),l[jt]=a}catch(m){ze(t,t.return,m)}}function bg(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&zi(t.type)||t.tag===4}function nd(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bg(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&zi(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function id(t,a,s){var l=t.tag;if(l===5||l===6)t=t.stateNode,a?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(t,a):(a=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.appendChild(t),s=s._reactRootContainer,s!=null||a.onclick!==null||(a.onclick=Gn));else if(l!==4&&(l===27&&zi(t.type)&&(s=t.stateNode,a=null),t=t.child,t!==null))for(id(t,a,s),t=t.sibling;t!==null;)id(t,a,s),t=t.sibling}function tc(t,a,s){var l=t.tag;if(l===5||l===6)t=t.stateNode,a?s.insertBefore(t,a):s.appendChild(t);else if(l!==4&&(l===27&&zi(t.type)&&(s=t.stateNode),t=t.child,t!==null))for(tc(t,a,s),t=t.sibling;t!==null;)tc(t,a,s),t=t.sibling}function Sg(t){var a=t.stateNode,s=t.memoizedProps;try{for(var l=t.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);wt(a,l,s),a[kt]=t,a[jt]=s}catch(p){ze(t,t.return,p)}}var ti=!1,mt=!1,ad=!1,Tg=typeof WeakSet=="function"?WeakSet:Set,St=null;function FC(t,a){if(t=t.containerInfo,_d=Cc,t=Pm(t),Zl(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var m=l.anchorOffset,p=l.focusNode;l=l.focusOffset;try{s.nodeType,p.nodeType}catch{s=null;break e}var y=0,S=-1,O=-1,I=0,Y=0,$=t,z=null;t:for(;;){for(var F;$!==s||m!==0&&$.nodeType!==3||(S=y+m),$!==p||l!==0&&$.nodeType!==3||(O=y+l),$.nodeType===3&&(y+=$.nodeValue.length),(F=$.firstChild)!==null;)z=$,$=F;for(;;){if($===t)break t;if(z===s&&++I===m&&(S=y),z===p&&++Y===l&&(O=y),(F=$.nextSibling)!==null)break;$=z,z=$.parentNode}$=F}s=S===-1||O===-1?null:{start:S,end:O}}else s=null}s=s||{start:0,end:0}}else s=null;for(Rd={focusedElem:t,selectionRange:s},Cc=!1,St=a;St!==null;)if(a=St,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,St=t;else for(;St!==null;){switch(a=St,p=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(s=0;s<t.length;s++)m=t[s],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&p!==null){t=void 0,s=a,m=p.memoizedProps,p=p.memoizedState,l=s.stateNode;try{var ce=Ca(s.type,m);t=l.getSnapshotBeforeUpdate(ce,p),l.__reactInternalSnapshotBeforeUpdate=t}catch(fe){ze(s,s.return,fe)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,s=t.nodeType,s===9)Ad(t);else if(s===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Ad(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(r(163))}if(t=a.sibling,t!==null){t.return=a.return,St=t;break}St=a.return}}function Cg(t,a,s){var l=s.flags;switch(s.tag){case 0:case 11:case 15:ii(t,s),l&4&&vs(5,s);break;case 1:if(ii(t,s),l&4)if(t=s.stateNode,a===null)try{t.componentDidMount()}catch(y){ze(s,s.return,y)}else{var m=Ca(s.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(m,a,t.__reactInternalSnapshotBeforeUpdate)}catch(y){ze(s,s.return,y)}}l&64&&gg(s),l&512&&ys(s,s.return);break;case 3:if(ii(t,s),l&64&&(t=s.updateQueue,t!==null)){if(a=null,s.child!==null)switch(s.child.tag){case 27:case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}try{sp(t,a)}catch(y){ze(s,s.return,y)}}break;case 27:a===null&&l&4&&Sg(s);case 26:case 5:ii(t,s),a===null&&l&4&&yg(s),l&512&&ys(s,s.return);break;case 12:ii(t,s);break;case 31:ii(t,s),l&4&&_g(t,s);break;case 13:ii(t,s),l&4&&Rg(t,s),l&64&&(t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(s=WC.bind(null,s),yk(t,s))));break;case 22:if(l=s.memoizedState!==null||ti,!l){a=a!==null&&a.memoizedState!==null||mt,m=ti;var p=mt;ti=l,(mt=a)&&!p?ai(t,s,(s.subtreeFlags&8772)!==0):ii(t,s),ti=m,mt=p}break;case 30:break;default:ii(t,s)}}function kg(t){var a=t.alternate;a!==null&&(t.alternate=null,kg(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&Nl(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var We=null,zt=!1;function ni(t,a,s){for(s=s.child;s!==null;)Eg(t,a,s),s=s.sibling}function Eg(t,a,s){if(Xt&&typeof Xt.onCommitFiberUnmount=="function")try{Xt.onCommitFiberUnmount(Vr,s)}catch{}switch(s.tag){case 26:mt||Ln(s,a),ni(t,a,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:mt||Ln(s,a);var l=We,m=zt;zi(s.type)&&(We=s.stateNode,zt=!1),ni(t,a,s),ws(s.stateNode),We=l,zt=m;break;case 5:mt||Ln(s,a);case 6:if(l=We,m=zt,We=null,ni(t,a,s),We=l,zt=m,We!==null)if(zt)try{(We.nodeType===9?We.body:We.nodeName==="HTML"?We.ownerDocument.body:We).removeChild(s.stateNode)}catch(p){ze(s,a,p)}else try{We.removeChild(s.stateNode)}catch(p){ze(s,a,p)}break;case 18:We!==null&&(zt?(t=We,gv(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,s.stateNode),vr(t)):gv(We,s.stateNode));break;case 4:l=We,m=zt,We=s.stateNode.containerInfo,zt=!0,ni(t,a,s),We=l,zt=m;break;case 0:case 11:case 14:case 15:Pi(2,s,a),mt||Pi(4,s,a),ni(t,a,s);break;case 1:mt||(Ln(s,a),l=s.stateNode,typeof l.componentWillUnmount=="function"&&vg(s,a,l)),ni(t,a,s);break;case 21:ni(t,a,s);break;case 22:mt=(l=mt)||s.memoizedState!==null,ni(t,a,s),mt=l;break;default:ni(t,a,s)}}function _g(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{vr(t)}catch(s){ze(a,a.return,s)}}}function Rg(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{vr(t)}catch(s){ze(a,a.return,s)}}function HC(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new Tg),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new Tg),a;default:throw Error(r(435,t.tag))}}function nc(t,a){var s=HC(t);a.forEach(function(l){if(!s.has(l)){s.add(l);var m=$C.bind(null,t,l);l.then(m,m)}})}function qt(t,a){var s=a.deletions;if(s!==null)for(var l=0;l<s.length;l++){var m=s[l],p=t,y=a,S=y;e:for(;S!==null;){switch(S.tag){case 27:if(zi(S.type)){We=S.stateNode,zt=!1;break e}break;case 5:We=S.stateNode,zt=!1;break e;case 3:case 4:We=S.stateNode.containerInfo,zt=!0;break e}S=S.return}if(We===null)throw Error(r(160));Eg(p,y,m),We=null,zt=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)wg(a,t),a=a.sibling}var kn=null;function wg(t,a){var s=t.alternate,l=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:qt(a,t),Vt(t),l&4&&(Pi(3,t,t.return),vs(3,t),Pi(5,t,t.return));break;case 1:qt(a,t),Vt(t),l&512&&(mt||s===null||Ln(s,s.return)),l&64&&ti&&(t=t.updateQueue,t!==null&&(l=t.callbacks,l!==null&&(s=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=s===null?l:s.concat(l))));break;case 26:var m=kn;if(qt(a,t),Vt(t),l&512&&(mt||s===null||Ln(s,s.return)),l&4){var p=s!==null?s.memoizedState:null;if(l=t.memoizedState,s===null)if(l===null)if(t.stateNode===null){e:{l=t.type,s=t.memoizedProps,m=m.ownerDocument||m;t:switch(l){case"title":p=m.getElementsByTagName("title")[0],(!p||p[Gr]||p[kt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(l),m.head.insertBefore(p,m.querySelector("head > title"))),wt(p,l,s),p[kt]=t,bt(p),l=p;break e;case"link":var y=wv("link","href",m).get(l+(s.href||""));if(y){for(var S=0;S<y.length;S++)if(p=y[S],p.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&p.getAttribute("rel")===(s.rel==null?null:s.rel)&&p.getAttribute("title")===(s.title==null?null:s.title)&&p.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){y.splice(S,1);break t}}p=m.createElement(l),wt(p,l,s),m.head.appendChild(p);break;case"meta":if(y=wv("meta","content",m).get(l+(s.content||""))){for(S=0;S<y.length;S++)if(p=y[S],p.getAttribute("content")===(s.content==null?null:""+s.content)&&p.getAttribute("name")===(s.name==null?null:s.name)&&p.getAttribute("property")===(s.property==null?null:s.property)&&p.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&p.getAttribute("charset")===(s.charSet==null?null:s.charSet)){y.splice(S,1);break t}}p=m.createElement(l),wt(p,l,s),m.head.appendChild(p);break;default:throw Error(r(468,l))}p[kt]=t,bt(p),l=p}t.stateNode=l}else Ov(m,t.type,t.stateNode);else t.stateNode=Rv(m,l,t.memoizedProps);else p!==l?(p===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):p.count--,l===null?Ov(m,t.type,t.stateNode):Rv(m,l,t.memoizedProps)):l===null&&t.stateNode!==null&&td(t,t.memoizedProps,s.memoizedProps)}break;case 27:qt(a,t),Vt(t),l&512&&(mt||s===null||Ln(s,s.return)),s!==null&&l&4&&td(t,t.memoizedProps,s.memoizedProps);break;case 5:if(qt(a,t),Vt(t),l&512&&(mt||s===null||Ln(s,s.return)),t.flags&32){m=t.stateNode;try{za(m,"")}catch(ce){ze(t,t.return,ce)}}l&4&&t.stateNode!=null&&(m=t.memoizedProps,td(t,m,s!==null?s.memoizedProps:m)),l&1024&&(ad=!0);break;case 6:if(qt(a,t),Vt(t),l&4){if(t.stateNode===null)throw Error(r(162));l=t.memoizedProps,s=t.stateNode;try{s.nodeValue=l}catch(ce){ze(t,t.return,ce)}}break;case 3:if(yc=null,m=kn,kn=gc(a.containerInfo),qt(a,t),kn=m,Vt(t),l&4&&s!==null&&s.memoizedState.isDehydrated)try{vr(a.containerInfo)}catch(ce){ze(t,t.return,ce)}ad&&(ad=!1,Og(t));break;case 4:l=kn,kn=gc(t.stateNode.containerInfo),qt(a,t),Vt(t),kn=l;break;case 12:qt(a,t),Vt(t);break;case 31:qt(a,t),Vt(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,nc(t,l)));break;case 13:qt(a,t),Vt(t),t.child.flags&8192&&t.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(ac=Qt()),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,nc(t,l)));break;case 22:m=t.memoizedState!==null;var O=s!==null&&s.memoizedState!==null,I=ti,Y=mt;if(ti=I||m,mt=Y||O,qt(a,t),mt=Y,ti=I,Vt(t),l&8192)e:for(a=t.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(s===null||O||ti||mt||ka(t)),s=null,a=t;;){if(a.tag===5||a.tag===26){if(s===null){O=s=a;try{if(p=O.stateNode,m)y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none";else{S=O.stateNode;var $=O.memoizedProps.style,z=$!=null&&$.hasOwnProperty("display")?$.display:null;S.style.display=z==null||typeof z=="boolean"?"":(""+z).trim()}}catch(ce){ze(O,O.return,ce)}}}else if(a.tag===6){if(s===null){O=a;try{O.stateNode.nodeValue=m?"":O.memoizedProps}catch(ce){ze(O,O.return,ce)}}}else if(a.tag===18){if(s===null){O=a;try{var F=O.stateNode;m?vv(F,!0):vv(O.stateNode,!1)}catch(ce){ze(O,O.return,ce)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;s===a&&(s=null),a=a.return}s===a&&(s=null),a.sibling.return=a.return,a=a.sibling}l&4&&(l=t.updateQueue,l!==null&&(s=l.retryQueue,s!==null&&(l.retryQueue=null,nc(t,s))));break;case 19:qt(a,t),Vt(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,nc(t,l)));break;case 30:break;case 21:break;default:qt(a,t),Vt(t)}}function Vt(t){var a=t.flags;if(a&2){try{for(var s,l=t.return;l!==null;){if(bg(l)){s=l;break}l=l.return}if(s==null)throw Error(r(160));switch(s.tag){case 27:var m=s.stateNode,p=nd(t);tc(t,p,m);break;case 5:var y=s.stateNode;s.flags&32&&(za(y,""),s.flags&=-33);var S=nd(t);tc(t,S,y);break;case 3:case 4:var O=s.stateNode.containerInfo,I=nd(t);id(t,I,O);break;default:throw Error(r(161))}}catch(Y){ze(t,t.return,Y)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function Og(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;Og(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function ii(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Cg(t,a.alternate,a),a=a.sibling}function ka(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:Pi(4,a,a.return),ka(a);break;case 1:Ln(a,a.return);var s=a.stateNode;typeof s.componentWillUnmount=="function"&&vg(a,a.return,s),ka(a);break;case 27:ws(a.stateNode);case 26:case 5:Ln(a,a.return),ka(a);break;case 22:a.memoizedState===null&&ka(a);break;case 30:ka(a);break;default:ka(a)}t=t.sibling}}function ai(t,a,s){for(s=s&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var l=a.alternate,m=t,p=a,y=p.flags;switch(p.tag){case 0:case 11:case 15:ai(m,p,s),vs(4,p);break;case 1:if(ai(m,p,s),l=p,m=l.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(I){ze(l,l.return,I)}if(l=p,m=l.updateQueue,m!==null){var S=l.stateNode;try{var O=m.shared.hiddenCallbacks;if(O!==null)for(m.shared.hiddenCallbacks=null,m=0;m<O.length;m++)rp(O[m],S)}catch(I){ze(l,l.return,I)}}s&&y&64&&gg(p),ys(p,p.return);break;case 27:Sg(p);case 26:case 5:ai(m,p,s),s&&l===null&&y&4&&yg(p),ys(p,p.return);break;case 12:ai(m,p,s);break;case 31:ai(m,p,s),s&&y&4&&_g(m,p);break;case 13:ai(m,p,s),s&&y&4&&Rg(m,p);break;case 22:p.memoizedState===null&&ai(m,p,s),ys(p,p.return);break;case 30:break;default:ai(m,p,s)}a=a.sibling}}function rd(t,a){var s=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==s&&(t!=null&&t.refCount++,s!=null&&as(s))}function sd(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&as(t))}function En(t,a,s,l){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Ag(t,a,s,l),a=a.sibling}function Ag(t,a,s,l){var m=a.flags;switch(a.tag){case 0:case 11:case 15:En(t,a,s,l),m&2048&&vs(9,a);break;case 1:En(t,a,s,l);break;case 3:En(t,a,s,l),m&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&as(t)));break;case 12:if(m&2048){En(t,a,s,l),t=a.stateNode;try{var p=a.memoizedProps,y=p.id,S=p.onPostCommit;typeof S=="function"&&S(y,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(O){ze(a,a.return,O)}}else En(t,a,s,l);break;case 31:En(t,a,s,l);break;case 13:En(t,a,s,l);break;case 23:break;case 22:p=a.stateNode,y=a.alternate,a.memoizedState!==null?p._visibility&2?En(t,a,s,l):bs(t,a):p._visibility&2?En(t,a,s,l):(p._visibility|=2,sr(t,a,s,l,(a.subtreeFlags&10256)!==0||!1)),m&2048&&rd(y,a);break;case 24:En(t,a,s,l),m&2048&&sd(a.alternate,a);break;default:En(t,a,s,l)}}function sr(t,a,s,l,m){for(m=m&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var p=t,y=a,S=s,O=l,I=y.flags;switch(y.tag){case 0:case 11:case 15:sr(p,y,S,O,m),vs(8,y);break;case 23:break;case 22:var Y=y.stateNode;y.memoizedState!==null?Y._visibility&2?sr(p,y,S,O,m):bs(p,y):(Y._visibility|=2,sr(p,y,S,O,m)),m&&I&2048&&rd(y.alternate,y);break;case 24:sr(p,y,S,O,m),m&&I&2048&&sd(y.alternate,y);break;default:sr(p,y,S,O,m)}a=a.sibling}}function bs(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var s=t,l=a,m=l.flags;switch(l.tag){case 22:bs(s,l),m&2048&&rd(l.alternate,l);break;case 24:bs(s,l),m&2048&&sd(l.alternate,l);break;default:bs(s,l)}a=a.sibling}}var Ss=8192;function or(t,a,s){if(t.subtreeFlags&Ss)for(t=t.child;t!==null;)Dg(t,a,s),t=t.sibling}function Dg(t,a,s){switch(t.tag){case 26:or(t,a,s),t.flags&Ss&&t.memoizedState!==null&&Dk(s,kn,t.memoizedState,t.memoizedProps);break;case 5:or(t,a,s);break;case 3:case 4:var l=kn;kn=gc(t.stateNode.containerInfo),or(t,a,s),kn=l;break;case 22:t.memoizedState===null&&(l=t.alternate,l!==null&&l.memoizedState!==null?(l=Ss,Ss=16777216,or(t,a,s),Ss=l):or(t,a,s));break;default:or(t,a,s)}}function Mg(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function Ts(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var s=0;s<a.length;s++){var l=a[s];St=l,Pg(l,t)}Mg(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)xg(t),t=t.sibling}function xg(t){switch(t.tag){case 0:case 11:case 15:Ts(t),t.flags&2048&&Pi(9,t,t.return);break;case 3:Ts(t);break;case 12:Ts(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,ic(t)):Ts(t);break;default:Ts(t)}}function ic(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var s=0;s<a.length;s++){var l=a[s];St=l,Pg(l,t)}Mg(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:Pi(8,a,a.return),ic(a);break;case 22:s=a.stateNode,s._visibility&2&&(s._visibility&=-3,ic(a));break;default:ic(a)}t=t.sibling}}function Pg(t,a){for(;St!==null;){var s=St;switch(s.tag){case 0:case 11:case 15:Pi(8,s,a);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var l=s.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:as(s.memoizedState.cache)}if(l=s.child,l!==null)l.return=s,St=l;else e:for(s=t;St!==null;){l=St;var m=l.sibling,p=l.return;if(kg(l),l===s){St=null;break e}if(m!==null){m.return=p,St=m;break e}St=p}}}var GC={getCacheForType:function(t){var a=_t(dt),s=a.data.get(t);return s===void 0&&(s=t(),a.data.set(t,s)),s},cacheSignal:function(){return _t(dt).controller.signal}},YC=typeof WeakMap=="function"?WeakMap:Map,je=0,Ye=null,Ee=null,Oe=0,Be=0,nn=null,Ni=!1,cr=!1,od=!1,ri=0,it=0,Li=0,Ea=0,cd=0,an=0,lr=0,Cs=null,Ft=null,ld=!1,ac=0,Ng=0,rc=1/0,sc=null,Ui=null,vt=0,Ii=null,ur=null,si=0,ud=0,dd=null,Lg=null,ks=0,fd=null;function rn(){return(je&2)!==0&&Oe!==0?Oe&-Oe:V.T!==null?yd():Zh()}function Ug(){if(an===0)if((Oe&536870912)===0||De){var t=mo;mo<<=1,(mo&3932160)===0&&(mo=262144),an=t}else an=536870912;return t=en.current,t!==null&&(t.flags|=32),an}function Ht(t,a,s){(t===Ye&&(Be===2||Be===9)||t.cancelPendingCommit!==null)&&(dr(t,0),ji(t,Oe,an,!1)),Hr(t,s),((je&2)===0||t!==Ye)&&(t===Ye&&((je&2)===0&&(Ea|=s),it===4&&ji(t,Oe,an,!1)),Un(t))}function Ig(t,a,s){if((je&6)!==0)throw Error(r(327));var l=!s&&(a&127)===0&&(a&t.expiredLanes)===0||Fr(t,a),m=l?QC(t,a):md(t,a,!0),p=l;do{if(m===0){cr&&!l&&ji(t,a,0,!1);break}else{if(s=t.current.alternate,p&&!KC(s)){m=md(t,a,!1),p=!1;continue}if(m===2){if(p=a,t.errorRecoveryDisabledLanes&p)var y=0;else y=t.pendingLanes&-536870913,y=y!==0?y:y&536870912?536870912:0;if(y!==0){a=y;e:{var S=t;m=Cs;var O=S.current.memoizedState.isDehydrated;if(O&&(dr(S,y).flags|=256),y=md(S,y,!1),y!==2){if(od&&!O){S.errorRecoveryDisabledLanes|=p,Ea|=p,m=4;break e}p=Ft,Ft=m,p!==null&&(Ft===null?Ft=p:Ft.push.apply(Ft,p))}m=y}if(p=!1,m!==2)continue}}if(m===1){dr(t,0),ji(t,a,0,!0);break}e:{switch(l=t,p=m,p){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:ji(l,a,an,!Ni);break e;case 2:Ft=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(m=ac+300-Qt(),10<m)){if(ji(l,a,an,!Ni),go(l,0,!0)!==0)break e;si=a,l.timeoutHandle=mv(jg.bind(null,l,s,Ft,sc,ld,a,an,Ea,lr,Ni,p,"Throttled",-0,0),m);break e}jg(l,s,Ft,sc,ld,a,an,Ea,lr,Ni,p,null,-0,0)}}break}while(!0);Un(t)}function jg(t,a,s,l,m,p,y,S,O,I,Y,$,z,F){if(t.timeoutHandle=-1,$=a.subtreeFlags,$&8192||($&16785408)===16785408){$={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gn},Dg(a,p,$);var ce=(p&62914560)===p?ac-Qt():(p&4194048)===p?Ng-Qt():0;if(ce=Mk($,ce),ce!==null){si=p,t.cancelPendingCommit=ce(Yg.bind(null,t,a,p,s,l,m,y,S,O,Y,$,null,z,F)),ji(t,p,y,!I);return}}Yg(t,a,p,s,l,m,y,S,O)}function KC(t){for(var a=t;;){var s=a.tag;if((s===0||s===11||s===15)&&a.flags&16384&&(s=a.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var l=0;l<s.length;l++){var m=s[l],p=m.getSnapshot;m=m.value;try{if(!Wt(p(),m))return!1}catch{return!1}}if(s=a.child,a.subtreeFlags&16384&&s!==null)s.return=a,a=s;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ji(t,a,s,l){a&=~cd,a&=~Ea,t.suspendedLanes|=a,t.pingedLanes&=~a,l&&(t.warmLanes|=a),l=t.expirationTimes;for(var m=a;0<m;){var p=31-Zt(m),y=1<<p;l[p]=-1,m&=~y}s!==0&&Jh(t,s,a)}function oc(){return(je&6)===0?(Es(0),!1):!0}function hd(){if(Ee!==null){if(Be===0)var t=Ee.return;else t=Ee,Qn=pa=null,Au(t),tr=null,ss=0,t=Ee;for(;t!==null;)pg(t.alternate,t),t=t.return;Ee=null}}function dr(t,a){var s=t.timeoutHandle;s!==-1&&(t.timeoutHandle=-1,hk(s)),s=t.cancelPendingCommit,s!==null&&(t.cancelPendingCommit=null,s()),si=0,hd(),Ye=t,Ee=s=Kn(t.current,null),Oe=a,Be=0,nn=null,Ni=!1,cr=Fr(t,a),od=!1,lr=an=cd=Ea=Li=it=0,Ft=Cs=null,ld=!1,(a&8)!==0&&(a|=a&32);var l=t.entangledLanes;if(l!==0)for(t=t.entanglements,l&=a;0<l;){var m=31-Zt(l),p=1<<m;a|=t[m],l&=~p}return ri=a,Oo(),s}function Bg(t,a){be=null,V.H=ms,a===er||a===Uo?(a=tp(),Be=3):a===vu?(a=tp(),Be=4):Be=a===Gu?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,nn=a,Ee===null&&(it=1,Xo(t,dn(a,t.current)))}function zg(){var t=en.current;return t===null?!0:(Oe&4194048)===Oe?pn===null:(Oe&62914560)===Oe||(Oe&536870912)!==0?t===pn:!1}function qg(){var t=V.H;return V.H=ms,t===null?ms:t}function Vg(){var t=V.A;return V.A=GC,t}function cc(){it=4,Ni||(Oe&4194048)!==Oe&&en.current!==null||(cr=!0),(Li&134217727)===0&&(Ea&134217727)===0||Ye===null||ji(Ye,Oe,an,!1)}function md(t,a,s){var l=je;je|=2;var m=qg(),p=Vg();(Ye!==t||Oe!==a)&&(sc=null,dr(t,a)),a=!1;var y=it;e:do try{if(Be!==0&&Ee!==null){var S=Ee,O=nn;switch(Be){case 8:hd(),y=6;break e;case 3:case 2:case 9:case 6:en.current===null&&(a=!0);var I=Be;if(Be=0,nn=null,fr(t,S,O,I),s&&cr){y=0;break e}break;default:I=Be,Be=0,nn=null,fr(t,S,O,I)}}JC(),y=it;break}catch(Y){Bg(t,Y)}while(!0);return a&&t.shellSuspendCounter++,Qn=pa=null,je=l,V.H=m,V.A=p,Ee===null&&(Ye=null,Oe=0,Oo()),y}function JC(){for(;Ee!==null;)Fg(Ee)}function QC(t,a){var s=je;je|=2;var l=qg(),m=Vg();Ye!==t||Oe!==a?(sc=null,rc=Qt()+500,dr(t,a)):cr=Fr(t,a);e:do try{if(Be!==0&&Ee!==null){a=Ee;var p=nn;t:switch(Be){case 1:Be=0,nn=null,fr(t,a,p,1);break;case 2:case 9:if($m(p)){Be=0,nn=null,Hg(a);break}a=function(){Be!==2&&Be!==9||Ye!==t||(Be=7),Un(t)},p.then(a,a);break e;case 3:Be=7;break e;case 4:Be=5;break e;case 7:$m(p)?(Be=0,nn=null,Hg(a)):(Be=0,nn=null,fr(t,a,p,7));break;case 5:var y=null;switch(Ee.tag){case 26:y=Ee.memoizedState;case 5:case 27:var S=Ee;if(y?Av(y):S.stateNode.complete){Be=0,nn=null;var O=S.sibling;if(O!==null)Ee=O;else{var I=S.return;I!==null?(Ee=I,lc(I)):Ee=null}break t}}Be=0,nn=null,fr(t,a,p,5);break;case 6:Be=0,nn=null,fr(t,a,p,6);break;case 8:hd(),it=6;break e;default:throw Error(r(462))}}XC();break}catch(Y){Bg(t,Y)}while(!0);return Qn=pa=null,V.H=l,V.A=m,je=s,Ee!==null?0:(Ye=null,Oe=0,Oo(),it)}function XC(){for(;Ee!==null&&!bT();)Fg(Ee)}function Fg(t){var a=hg(t.alternate,t,ri);t.memoizedProps=t.pendingProps,a===null?lc(t):Ee=a}function Hg(t){var a=t,s=a.alternate;switch(a.tag){case 15:case 0:a=og(s,a,a.pendingProps,a.type,void 0,Oe);break;case 11:a=og(s,a,a.pendingProps,a.type.render,a.ref,Oe);break;case 5:Au(a);default:pg(s,a),a=Ee=Vm(a,ri),a=hg(s,a,ri)}t.memoizedProps=t.pendingProps,a===null?lc(t):Ee=a}function fr(t,a,s,l){Qn=pa=null,Au(a),tr=null,ss=0;var m=a.return;try{if(jC(t,m,a,s,Oe)){it=1,Xo(t,dn(s,t.current)),Ee=null;return}}catch(p){if(m!==null)throw Ee=m,p;it=1,Xo(t,dn(s,t.current)),Ee=null;return}a.flags&32768?(De||l===1?t=!0:cr||(Oe&536870912)!==0?t=!1:(Ni=t=!0,(l===2||l===9||l===3||l===6)&&(l=en.current,l!==null&&l.tag===13&&(l.flags|=16384))),Gg(a,t)):lc(a)}function lc(t){var a=t;do{if((a.flags&32768)!==0){Gg(a,Ni);return}t=a.return;var s=qC(a.alternate,a,ri);if(s!==null){Ee=s;return}if(a=a.sibling,a!==null){Ee=a;return}Ee=a=t}while(a!==null);it===0&&(it=5)}function Gg(t,a){do{var s=VC(t.alternate,t);if(s!==null){s.flags&=32767,Ee=s;return}if(s=t.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!a&&(t=t.sibling,t!==null)){Ee=t;return}Ee=t=s}while(t!==null);it=6,Ee=null}function Yg(t,a,s,l,m,p,y,S,O){t.cancelPendingCommit=null;do uc();while(vt!==0);if((je&6)!==0)throw Error(r(327));if(a!==null){if(a===t.current)throw Error(r(177));if(p=a.lanes|a.childLanes,p|=nu,AT(t,s,p,y,S,O),t===Ye&&(Ee=Ye=null,Oe=0),ur=a,Ii=t,si=s,ud=p,dd=m,Lg=l,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,ek(fo,function(){return Zg(),null})):(t.callbackNode=null,t.callbackPriority=0),l=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||l){l=V.T,V.T=null,m=ae.p,ae.p=2,y=je,je|=4;try{FC(t,a,s)}finally{je=y,ae.p=m,V.T=l}}vt=1,Kg(),Jg(),Qg()}}function Kg(){if(vt===1){vt=0;var t=Ii,a=ur,s=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||s){s=V.T,V.T=null;var l=ae.p;ae.p=2;var m=je;je|=4;try{wg(a,t);var p=Rd,y=Pm(t.containerInfo),S=p.focusedElem,O=p.selectionRange;if(y!==S&&S&&S.ownerDocument&&xm(S.ownerDocument.documentElement,S)){if(O!==null&&Zl(S)){var I=O.start,Y=O.end;if(Y===void 0&&(Y=I),"selectionStart"in S)S.selectionStart=I,S.selectionEnd=Math.min(Y,S.value.length);else{var $=S.ownerDocument||document,z=$&&$.defaultView||window;if(z.getSelection){var F=z.getSelection(),ce=S.textContent.length,fe=Math.min(O.start,ce),Fe=O.end===void 0?fe:Math.min(O.end,ce);!F.extend&&fe>Fe&&(y=Fe,Fe=fe,fe=y);var N=Mm(S,fe),x=Mm(S,Fe);if(N&&x&&(F.rangeCount!==1||F.anchorNode!==N.node||F.anchorOffset!==N.offset||F.focusNode!==x.node||F.focusOffset!==x.offset)){var U=$.createRange();U.setStart(N.node,N.offset),F.removeAllRanges(),fe>Fe?(F.addRange(U),F.extend(x.node,x.offset)):(U.setEnd(x.node,x.offset),F.addRange(U))}}}}for($=[],F=S;F=F.parentNode;)F.nodeType===1&&$.push({element:F,left:F.scrollLeft,top:F.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<$.length;S++){var Z=$[S];Z.element.scrollLeft=Z.left,Z.element.scrollTop=Z.top}}Cc=!!_d,Rd=_d=null}finally{je=m,ae.p=l,V.T=s}}t.current=a,vt=2}}function Jg(){if(vt===2){vt=0;var t=Ii,a=ur,s=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||s){s=V.T,V.T=null;var l=ae.p;ae.p=2;var m=je;je|=4;try{Cg(t,a.alternate,a)}finally{je=m,ae.p=l,V.T=s}}vt=3}}function Qg(){if(vt===4||vt===3){vt=0,ST();var t=Ii,a=ur,s=si,l=Lg;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?vt=5:(vt=0,ur=Ii=null,Xg(t,t.pendingLanes));var m=t.pendingLanes;if(m===0&&(Ui=null),xl(s),a=a.stateNode,Xt&&typeof Xt.onCommitFiberRoot=="function")try{Xt.onCommitFiberRoot(Vr,a,void 0,(a.current.flags&128)===128)}catch{}if(l!==null){a=V.T,m=ae.p,ae.p=2,V.T=null;try{for(var p=t.onRecoverableError,y=0;y<l.length;y++){var S=l[y];p(S.value,{componentStack:S.stack})}}finally{V.T=a,ae.p=m}}(si&3)!==0&&uc(),Un(t),m=t.pendingLanes,(s&261930)!==0&&(m&42)!==0?t===fd?ks++:(ks=0,fd=t):ks=0,Es(0)}}function Xg(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,as(a)))}function uc(){return Kg(),Jg(),Qg(),Zg()}function Zg(){if(vt!==5)return!1;var t=Ii,a=ud;ud=0;var s=xl(si),l=V.T,m=ae.p;try{ae.p=32>s?32:s,V.T=null,s=dd,dd=null;var p=Ii,y=si;if(vt=0,ur=Ii=null,si=0,(je&6)!==0)throw Error(r(331));var S=je;if(je|=4,xg(p.current),Ag(p,p.current,y,s),je=S,Es(0,!1),Xt&&typeof Xt.onPostCommitFiberRoot=="function")try{Xt.onPostCommitFiberRoot(Vr,p)}catch{}return!0}finally{ae.p=m,V.T=l,Xg(t,a)}}function Wg(t,a,s){a=dn(s,a),a=Hu(t.stateNode,a,2),t=Di(t,a,2),t!==null&&(Hr(t,2),Un(t))}function ze(t,a,s){if(t.tag===3)Wg(t,t,s);else for(;a!==null;){if(a.tag===3){Wg(a,t,s);break}else if(a.tag===1){var l=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Ui===null||!Ui.has(l))){t=dn(s,t),s=$p(2),l=Di(a,s,2),l!==null&&(eg(s,l,a,t),Hr(l,2),Un(l));break}}a=a.return}}function pd(t,a,s){var l=t.pingCache;if(l===null){l=t.pingCache=new YC;var m=new Set;l.set(a,m)}else m=l.get(a),m===void 0&&(m=new Set,l.set(a,m));m.has(s)||(od=!0,m.add(s),t=ZC.bind(null,t,a,s),a.then(t,t))}function ZC(t,a,s){var l=t.pingCache;l!==null&&l.delete(a),t.pingedLanes|=t.suspendedLanes&s,t.warmLanes&=~s,Ye===t&&(Oe&s)===s&&(it===4||it===3&&(Oe&62914560)===Oe&&300>Qt()-ac?(je&2)===0&&dr(t,0):cd|=s,lr===Oe&&(lr=0)),Un(t)}function $g(t,a){a===0&&(a=Kh()),t=fa(t,a),t!==null&&(Hr(t,a),Un(t))}function WC(t){var a=t.memoizedState,s=0;a!==null&&(s=a.retryLane),$g(t,s)}function $C(t,a){var s=0;switch(t.tag){case 31:case 13:var l=t.stateNode,m=t.memoizedState;m!==null&&(s=m.retryLane);break;case 19:l=t.stateNode;break;case 22:l=t.stateNode._retryCache;break;default:throw Error(r(314))}l!==null&&l.delete(a),$g(t,s)}function ek(t,a){return Ol(t,a)}var dc=null,hr=null,gd=!1,fc=!1,vd=!1,Bi=0;function Un(t){t!==hr&&t.next===null&&(hr===null?dc=hr=t:hr=hr.next=t),fc=!0,gd||(gd=!0,nk())}function Es(t,a){if(!vd&&fc){vd=!0;do for(var s=!1,l=dc;l!==null;){if(t!==0){var m=l.pendingLanes;if(m===0)var p=0;else{var y=l.suspendedLanes,S=l.pingedLanes;p=(1<<31-Zt(42|t)+1)-1,p&=m&~(y&~S),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(s=!0,iv(l,p))}else p=Oe,p=go(l,l===Ye?p:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(p&3)===0||Fr(l,p)||(s=!0,iv(l,p));l=l.next}while(s);vd=!1}}function tk(){ev()}function ev(){fc=gd=!1;var t=0;Bi!==0&&fk()&&(t=Bi);for(var a=Qt(),s=null,l=dc;l!==null;){var m=l.next,p=tv(l,a);p===0?(l.next=null,s===null?dc=m:s.next=m,m===null&&(hr=s)):(s=l,(t!==0||(p&3)!==0)&&(fc=!0)),l=m}vt!==0&&vt!==5||Es(t),Bi!==0&&(Bi=0)}function tv(t,a){for(var s=t.suspendedLanes,l=t.pingedLanes,m=t.expirationTimes,p=t.pendingLanes&-62914561;0<p;){var y=31-Zt(p),S=1<<y,O=m[y];O===-1?((S&s)===0||(S&l)!==0)&&(m[y]=OT(S,a)):O<=a&&(t.expiredLanes|=S),p&=~S}if(a=Ye,s=Oe,s=go(t,t===a?s:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l=t.callbackNode,s===0||t===a&&(Be===2||Be===9)||t.cancelPendingCommit!==null)return l!==null&&l!==null&&Al(l),t.callbackNode=null,t.callbackPriority=0;if((s&3)===0||Fr(t,s)){if(a=s&-s,a===t.callbackPriority)return a;switch(l!==null&&Al(l),xl(s)){case 2:case 8:s=Gh;break;case 32:s=fo;break;case 268435456:s=Yh;break;default:s=fo}return l=nv.bind(null,t),s=Ol(s,l),t.callbackPriority=a,t.callbackNode=s,a}return l!==null&&l!==null&&Al(l),t.callbackPriority=2,t.callbackNode=null,2}function nv(t,a){if(vt!==0&&vt!==5)return t.callbackNode=null,t.callbackPriority=0,null;var s=t.callbackNode;if(uc()&&t.callbackNode!==s)return null;var l=Oe;return l=go(t,t===Ye?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l===0?null:(Ig(t,l,a),tv(t,Qt()),t.callbackNode!=null&&t.callbackNode===s?nv.bind(null,t):null)}function iv(t,a){if(uc())return null;Ig(t,a,!0)}function nk(){mk(function(){(je&6)!==0?Ol(Hh,tk):ev()})}function yd(){if(Bi===0){var t=Wa;t===0&&(t=ho,ho<<=1,(ho&261888)===0&&(ho=256)),Bi=t}return Bi}function av(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:So(""+t)}function rv(t,a){var s=a.ownerDocument.createElement("input");return s.name=a.name,s.value=a.value,t.id&&s.setAttribute("form",t.id),a.parentNode.insertBefore(s,a),t=new FormData(t),s.parentNode.removeChild(s),t}function ik(t,a,s,l,m){if(a==="submit"&&s&&s.stateNode===m){var p=av((m[jt]||null).action),y=l.submitter;y&&(a=(a=y[jt]||null)?av(a.formAction):y.getAttribute("formAction"),a!==null&&(p=a,y=null));var S=new Eo("action","action",null,l,m);t.push({event:S,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Bi!==0){var O=y?rv(m,y):new FormData(m);ju(s,{pending:!0,data:O,method:m.method,action:p},null,O)}}else typeof p=="function"&&(S.preventDefault(),O=y?rv(m,y):new FormData(m),ju(s,{pending:!0,data:O,method:m.method,action:p},p,O))},currentTarget:m}]})}}for(var bd=0;bd<tu.length;bd++){var Sd=tu[bd],ak=Sd.toLowerCase(),rk=Sd[0].toUpperCase()+Sd.slice(1);Cn(ak,"on"+rk)}Cn(Um,"onAnimationEnd"),Cn(Im,"onAnimationIteration"),Cn(jm,"onAnimationStart"),Cn("dblclick","onDoubleClick"),Cn("focusin","onFocus"),Cn("focusout","onBlur"),Cn(TC,"onTransitionRun"),Cn(CC,"onTransitionStart"),Cn(kC,"onTransitionCancel"),Cn(Bm,"onTransitionEnd"),ja("onMouseEnter",["mouseout","mouseover"]),ja("onMouseLeave",["mouseout","mouseover"]),ja("onPointerEnter",["pointerout","pointerover"]),ja("onPointerLeave",["pointerout","pointerover"]),ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ca("onBeforeInput",["compositionend","keypress","textInput","paste"]),ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _s="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_s));function sv(t,a){a=(a&4)!==0;for(var s=0;s<t.length;s++){var l=t[s],m=l.event;l=l.listeners;e:{var p=void 0;if(a)for(var y=l.length-1;0<=y;y--){var S=l[y],O=S.instance,I=S.currentTarget;if(S=S.listener,O!==p&&m.isPropagationStopped())break e;p=S,m.currentTarget=I;try{p(m)}catch(Y){wo(Y)}m.currentTarget=null,p=O}else for(y=0;y<l.length;y++){if(S=l[y],O=S.instance,I=S.currentTarget,S=S.listener,O!==p&&m.isPropagationStopped())break e;p=S,m.currentTarget=I;try{p(m)}catch(Y){wo(Y)}m.currentTarget=null,p=O}}}}function _e(t,a){var s=a[Pl];s===void 0&&(s=a[Pl]=new Set);var l=t+"__bubble";s.has(l)||(ov(a,t,2,!1),s.add(l))}function Td(t,a,s){var l=0;a&&(l|=4),ov(s,t,l,a)}var hc="_reactListening"+Math.random().toString(36).slice(2);function Cd(t){if(!t[hc]){t[hc]=!0,em.forEach(function(s){s!=="selectionchange"&&(sk.has(s)||Td(s,!1,t),Td(s,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[hc]||(a[hc]=!0,Td("selectionchange",!1,a))}}function ov(t,a,s,l){switch(Uv(a)){case 2:var m=Nk;break;case 8:m=Lk;break;default:m=Id}s=m.bind(null,a,s,t),m=void 0,!Vl||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),l?m!==void 0?t.addEventListener(a,s,{capture:!0,passive:m}):t.addEventListener(a,s,!0):m!==void 0?t.addEventListener(a,s,{passive:m}):t.addEventListener(a,s,!1)}function kd(t,a,s,l,m){var p=l;if((a&1)===0&&(a&2)===0&&l!==null)e:for(;;){if(l===null)return;var y=l.tag;if(y===3||y===4){var S=l.stateNode.containerInfo;if(S===m)break;if(y===4)for(y=l.return;y!==null;){var O=y.tag;if((O===3||O===4)&&y.stateNode.containerInfo===m)return;y=y.return}for(;S!==null;){if(y=La(S),y===null)return;if(O=y.tag,O===5||O===6||O===26||O===27){l=p=y;continue e}S=S.parentNode}}l=l.return}fm(function(){var I=p,Y=zl(s),$=[];e:{var z=zm.get(t);if(z!==void 0){var F=Eo,ce=t;switch(t){case"keypress":if(Co(s)===0)break e;case"keydown":case"keyup":F=$T;break;case"focusin":ce="focus",F=Yl;break;case"focusout":ce="blur",F=Yl;break;case"beforeblur":case"afterblur":F=Yl;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=pm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=qT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=nC;break;case Um:case Im:case jm:F=HT;break;case Bm:F=aC;break;case"scroll":case"scrollend":F=BT;break;case"wheel":F=sC;break;case"copy":case"cut":case"paste":F=YT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=vm;break;case"toggle":case"beforetoggle":F=cC}var fe=(a&4)!==0,Fe=!fe&&(t==="scroll"||t==="scrollend"),N=fe?z!==null?z+"Capture":null:z;fe=[];for(var x=I,U;x!==null;){var Z=x;if(U=Z.stateNode,Z=Z.tag,Z!==5&&Z!==26&&Z!==27||U===null||N===null||(Z=Kr(x,N),Z!=null&&fe.push(Rs(x,Z,U))),Fe)break;x=x.return}0<fe.length&&(z=new F(z,ce,null,s,Y),$.push({event:z,listeners:fe}))}}if((a&7)===0){e:{if(z=t==="mouseover"||t==="pointerover",F=t==="mouseout"||t==="pointerout",z&&s!==Bl&&(ce=s.relatedTarget||s.fromElement)&&(La(ce)||ce[Na]))break e;if((F||z)&&(z=Y.window===Y?Y:(z=Y.ownerDocument)?z.defaultView||z.parentWindow:window,F?(ce=s.relatedTarget||s.toElement,F=I,ce=ce?La(ce):null,ce!==null&&(Fe=c(ce),fe=ce.tag,ce!==Fe||fe!==5&&fe!==27&&fe!==6)&&(ce=null)):(F=null,ce=I),F!==ce)){if(fe=pm,Z="onMouseLeave",N="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(fe=vm,Z="onPointerLeave",N="onPointerEnter",x="pointer"),Fe=F==null?z:Yr(F),U=ce==null?z:Yr(ce),z=new fe(Z,x+"leave",F,s,Y),z.target=Fe,z.relatedTarget=U,Z=null,La(Y)===I&&(fe=new fe(N,x+"enter",ce,s,Y),fe.target=U,fe.relatedTarget=Fe,Z=fe),Fe=Z,F&&ce)t:{for(fe=ok,N=F,x=ce,U=0,Z=N;Z;Z=fe(Z))U++;Z=0;for(var de=x;de;de=fe(de))Z++;for(;0<U-Z;)N=fe(N),U--;for(;0<Z-U;)x=fe(x),Z--;for(;U--;){if(N===x||x!==null&&N===x.alternate){fe=N;break t}N=fe(N),x=fe(x)}fe=null}else fe=null;F!==null&&cv($,z,F,fe,!1),ce!==null&&Fe!==null&&cv($,Fe,ce,fe,!0)}}e:{if(z=I?Yr(I):window,F=z.nodeName&&z.nodeName.toLowerCase(),F==="select"||F==="input"&&z.type==="file")var Le=_m;else if(km(z))if(Rm)Le=yC;else{Le=gC;var le=pC}else F=z.nodeName,!F||F.toLowerCase()!=="input"||z.type!=="checkbox"&&z.type!=="radio"?I&&jl(I.elementType)&&(Le=_m):Le=vC;if(Le&&(Le=Le(t,I))){Em($,Le,s,Y);break e}le&&le(t,z,I),t==="focusout"&&I&&z.type==="number"&&I.memoizedProps.value!=null&&Il(z,"number",z.value)}switch(le=I?Yr(I):window,t){case"focusin":(km(le)||le.contentEditable==="true")&&(Ha=le,Wl=I,ts=null);break;case"focusout":ts=Wl=Ha=null;break;case"mousedown":$l=!0;break;case"contextmenu":case"mouseup":case"dragend":$l=!1,Nm($,s,Y);break;case"selectionchange":if(SC)break;case"keydown":case"keyup":Nm($,s,Y)}var Se;if(Jl)e:{switch(t){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Fa?Tm(t,s)&&(Ae="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(Ae="onCompositionStart");Ae&&(ym&&s.locale!=="ko"&&(Fa||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Fa&&(Se=hm()):(ki=Y,Fl="value"in ki?ki.value:ki.textContent,Fa=!0)),le=mc(I,Ae),0<le.length&&(Ae=new gm(Ae,t,null,s,Y),$.push({event:Ae,listeners:le}),Se?Ae.data=Se:(Se=Cm(s),Se!==null&&(Ae.data=Se)))),(Se=uC?dC(t,s):fC(t,s))&&(Ae=mc(I,"onBeforeInput"),0<Ae.length&&(le=new gm("onBeforeInput","beforeinput",null,s,Y),$.push({event:le,listeners:Ae}),le.data=Se)),ik($,t,I,s,Y)}sv($,a)})}function Rs(t,a,s){return{instance:t,listener:a,currentTarget:s}}function mc(t,a){for(var s=a+"Capture",l=[];t!==null;){var m=t,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=Kr(t,s),m!=null&&l.unshift(Rs(t,m,p)),m=Kr(t,a),m!=null&&l.push(Rs(t,m,p))),t.tag===3)return l;t=t.return}return[]}function ok(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function cv(t,a,s,l,m){for(var p=a._reactName,y=[];s!==null&&s!==l;){var S=s,O=S.alternate,I=S.stateNode;if(S=S.tag,O!==null&&O===l)break;S!==5&&S!==26&&S!==27||I===null||(O=I,m?(I=Kr(s,p),I!=null&&y.unshift(Rs(s,I,O))):m||(I=Kr(s,p),I!=null&&y.push(Rs(s,I,O)))),s=s.return}y.length!==0&&t.push({event:a,listeners:y})}var ck=/\r\n?/g,lk=/\u0000|\uFFFD/g;function lv(t){return(typeof t=="string"?t:""+t).replace(ck,`
`).replace(lk,"")}function uv(t,a){return a=lv(a),lv(t)===a}function Ve(t,a,s,l,m,p){switch(s){case"children":typeof l=="string"?a==="body"||a==="textarea"&&l===""||za(t,l):(typeof l=="number"||typeof l=="bigint")&&a!=="body"&&za(t,""+l);break;case"className":yo(t,"class",l);break;case"tabIndex":yo(t,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":yo(t,s,l);break;case"style":um(t,l,p);break;case"data":if(a!=="object"){yo(t,"data",l);break}case"src":case"href":if(l===""&&(a!=="a"||s!=="href")){t.removeAttribute(s);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(s);break}l=So(""+l),t.setAttribute(s,l);break;case"action":case"formAction":if(typeof l=="function"){t.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(s==="formAction"?(a!=="input"&&Ve(t,a,"name",m.name,m,null),Ve(t,a,"formEncType",m.formEncType,m,null),Ve(t,a,"formMethod",m.formMethod,m,null),Ve(t,a,"formTarget",m.formTarget,m,null)):(Ve(t,a,"encType",m.encType,m,null),Ve(t,a,"method",m.method,m,null),Ve(t,a,"target",m.target,m,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(s);break}l=So(""+l),t.setAttribute(s,l);break;case"onClick":l!=null&&(t.onclick=Gn);break;case"onScroll":l!=null&&_e("scroll",t);break;case"onScrollEnd":l!=null&&_e("scrollend",t);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(r(61));if(s=l.__html,s!=null){if(m.children!=null)throw Error(r(60));t.innerHTML=s}}break;case"multiple":t.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":t.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){t.removeAttribute("xlink:href");break}s=So(""+l),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(s,""+l):t.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(s,""):t.removeAttribute(s);break;case"capture":case"download":l===!0?t.setAttribute(s,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(s,l):t.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?t.setAttribute(s,l):t.removeAttribute(s);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?t.removeAttribute(s):t.setAttribute(s,l);break;case"popover":_e("beforetoggle",t),_e("toggle",t),vo(t,"popover",l);break;case"xlinkActuate":Hn(t,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":Hn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":Hn(t,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":Hn(t,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":Hn(t,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":Hn(t,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":Hn(t,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":Hn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":Hn(t,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":vo(t,"is",l);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=IT.get(s)||s,vo(t,s,l))}}function Ed(t,a,s,l,m,p){switch(s){case"style":um(t,l,p);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(r(61));if(s=l.__html,s!=null){if(m.children!=null)throw Error(r(60));t.innerHTML=s}}break;case"children":typeof l=="string"?za(t,l):(typeof l=="number"||typeof l=="bigint")&&za(t,""+l);break;case"onScroll":l!=null&&_e("scroll",t);break;case"onScrollEnd":l!=null&&_e("scrollend",t);break;case"onClick":l!=null&&(t.onclick=Gn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tm.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(m=s.endsWith("Capture"),a=s.slice(2,m?s.length-7:void 0),p=t[jt]||null,p=p!=null?p[s]:null,typeof p=="function"&&t.removeEventListener(a,p,m),typeof l=="function")){typeof p!="function"&&p!==null&&(s in t?t[s]=null:t.hasAttribute(s)&&t.removeAttribute(s)),t.addEventListener(a,l,m);break e}s in t?t[s]=l:l===!0?t.setAttribute(s,""):vo(t,s,l)}}}function wt(t,a,s){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_e("error",t),_e("load",t);var l=!1,m=!1,p;for(p in s)if(s.hasOwnProperty(p)){var y=s[p];if(y!=null)switch(p){case"src":l=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Ve(t,a,p,y,s,null)}}m&&Ve(t,a,"srcSet",s.srcSet,s,null),l&&Ve(t,a,"src",s.src,s,null);return;case"input":_e("invalid",t);var S=p=y=m=null,O=null,I=null;for(l in s)if(s.hasOwnProperty(l)){var Y=s[l];if(Y!=null)switch(l){case"name":m=Y;break;case"type":y=Y;break;case"checked":O=Y;break;case"defaultChecked":I=Y;break;case"value":p=Y;break;case"defaultValue":S=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(r(137,a));break;default:Ve(t,a,l,Y,s,null)}}sm(t,p,S,O,I,y,m,!1);return;case"select":_e("invalid",t),l=y=p=null;for(m in s)if(s.hasOwnProperty(m)&&(S=s[m],S!=null))switch(m){case"value":p=S;break;case"defaultValue":y=S;break;case"multiple":l=S;default:Ve(t,a,m,S,s,null)}a=p,s=y,t.multiple=!!l,a!=null?Ba(t,!!l,a,!1):s!=null&&Ba(t,!!l,s,!0);return;case"textarea":_e("invalid",t),p=m=l=null;for(y in s)if(s.hasOwnProperty(y)&&(S=s[y],S!=null))switch(y){case"value":l=S;break;case"defaultValue":m=S;break;case"children":p=S;break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(r(91));break;default:Ve(t,a,y,S,s,null)}cm(t,l,m,p);return;case"option":for(O in s)s.hasOwnProperty(O)&&(l=s[O],l!=null)&&(O==="selected"?t.selected=l&&typeof l!="function"&&typeof l!="symbol":Ve(t,a,O,l,s,null));return;case"dialog":_e("beforetoggle",t),_e("toggle",t),_e("cancel",t),_e("close",t);break;case"iframe":case"object":_e("load",t);break;case"video":case"audio":for(l=0;l<_s.length;l++)_e(_s[l],t);break;case"image":_e("error",t),_e("load",t);break;case"details":_e("toggle",t);break;case"embed":case"source":case"link":_e("error",t),_e("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(I in s)if(s.hasOwnProperty(I)&&(l=s[I],l!=null))switch(I){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Ve(t,a,I,l,s,null)}return;default:if(jl(a)){for(Y in s)s.hasOwnProperty(Y)&&(l=s[Y],l!==void 0&&Ed(t,a,Y,l,s,void 0));return}}for(S in s)s.hasOwnProperty(S)&&(l=s[S],l!=null&&Ve(t,a,S,l,s,null))}function uk(t,a,s,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,y=null,S=null,O=null,I=null,Y=null;for(F in s){var $=s[F];if(s.hasOwnProperty(F)&&$!=null)switch(F){case"checked":break;case"value":break;case"defaultValue":O=$;default:l.hasOwnProperty(F)||Ve(t,a,F,null,l,$)}}for(var z in l){var F=l[z];if($=s[z],l.hasOwnProperty(z)&&(F!=null||$!=null))switch(z){case"type":p=F;break;case"name":m=F;break;case"checked":I=F;break;case"defaultChecked":Y=F;break;case"value":y=F;break;case"defaultValue":S=F;break;case"children":case"dangerouslySetInnerHTML":if(F!=null)throw Error(r(137,a));break;default:F!==$&&Ve(t,a,z,F,l,$)}}Ul(t,y,S,O,I,Y,p,m);return;case"select":F=y=S=z=null;for(p in s)if(O=s[p],s.hasOwnProperty(p)&&O!=null)switch(p){case"value":break;case"multiple":F=O;default:l.hasOwnProperty(p)||Ve(t,a,p,null,l,O)}for(m in l)if(p=l[m],O=s[m],l.hasOwnProperty(m)&&(p!=null||O!=null))switch(m){case"value":z=p;break;case"defaultValue":S=p;break;case"multiple":y=p;default:p!==O&&Ve(t,a,m,p,l,O)}a=S,s=y,l=F,z!=null?Ba(t,!!s,z,!1):!!l!=!!s&&(a!=null?Ba(t,!!s,a,!0):Ba(t,!!s,s?[]:"",!1));return;case"textarea":F=z=null;for(S in s)if(m=s[S],s.hasOwnProperty(S)&&m!=null&&!l.hasOwnProperty(S))switch(S){case"value":break;case"children":break;default:Ve(t,a,S,null,l,m)}for(y in l)if(m=l[y],p=s[y],l.hasOwnProperty(y)&&(m!=null||p!=null))switch(y){case"value":z=m;break;case"defaultValue":F=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(r(91));break;default:m!==p&&Ve(t,a,y,m,l,p)}om(t,z,F);return;case"option":for(var ce in s)z=s[ce],s.hasOwnProperty(ce)&&z!=null&&!l.hasOwnProperty(ce)&&(ce==="selected"?t.selected=!1:Ve(t,a,ce,null,l,z));for(O in l)z=l[O],F=s[O],l.hasOwnProperty(O)&&z!==F&&(z!=null||F!=null)&&(O==="selected"?t.selected=z&&typeof z!="function"&&typeof z!="symbol":Ve(t,a,O,z,l,F));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var fe in s)z=s[fe],s.hasOwnProperty(fe)&&z!=null&&!l.hasOwnProperty(fe)&&Ve(t,a,fe,null,l,z);for(I in l)if(z=l[I],F=s[I],l.hasOwnProperty(I)&&z!==F&&(z!=null||F!=null))switch(I){case"children":case"dangerouslySetInnerHTML":if(z!=null)throw Error(r(137,a));break;default:Ve(t,a,I,z,l,F)}return;default:if(jl(a)){for(var Fe in s)z=s[Fe],s.hasOwnProperty(Fe)&&z!==void 0&&!l.hasOwnProperty(Fe)&&Ed(t,a,Fe,void 0,l,z);for(Y in l)z=l[Y],F=s[Y],!l.hasOwnProperty(Y)||z===F||z===void 0&&F===void 0||Ed(t,a,Y,z,l,F);return}}for(var N in s)z=s[N],s.hasOwnProperty(N)&&z!=null&&!l.hasOwnProperty(N)&&Ve(t,a,N,null,l,z);for($ in l)z=l[$],F=s[$],!l.hasOwnProperty($)||z===F||z==null&&F==null||Ve(t,a,$,z,l,F)}function dv(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dk(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,s=performance.getEntriesByType("resource"),l=0;l<s.length;l++){var m=s[l],p=m.transferSize,y=m.initiatorType,S=m.duration;if(p&&S&&dv(y)){for(y=0,S=m.responseEnd,l+=1;l<s.length;l++){var O=s[l],I=O.startTime;if(I>S)break;var Y=O.transferSize,$=O.initiatorType;Y&&dv($)&&(O=O.responseEnd,y+=Y*(O<S?1:(S-I)/(O-I)))}if(--l,a+=8*(p+y)/(m.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var _d=null,Rd=null;function pc(t){return t.nodeType===9?t:t.ownerDocument}function fv(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function hv(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function wd(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Od=null;function fk(){var t=window.event;return t&&t.type==="popstate"?t===Od?!1:(Od=t,!0):(Od=null,!1)}var mv=typeof setTimeout=="function"?setTimeout:void 0,hk=typeof clearTimeout=="function"?clearTimeout:void 0,pv=typeof Promise=="function"?Promise:void 0,mk=typeof queueMicrotask=="function"?queueMicrotask:typeof pv<"u"?function(t){return pv.resolve(null).then(t).catch(pk)}:mv;function pk(t){setTimeout(function(){throw t})}function zi(t){return t==="head"}function gv(t,a){var s=a,l=0;do{var m=s.nextSibling;if(t.removeChild(s),m&&m.nodeType===8)if(s=m.data,s==="/$"||s==="/&"){if(l===0){t.removeChild(m),vr(a);return}l--}else if(s==="$"||s==="$?"||s==="$~"||s==="$!"||s==="&")l++;else if(s==="html")ws(t.ownerDocument.documentElement);else if(s==="head"){s=t.ownerDocument.head,ws(s);for(var p=s.firstChild;p;){var y=p.nextSibling,S=p.nodeName;p[Gr]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&p.rel.toLowerCase()==="stylesheet"||s.removeChild(p),p=y}}else s==="body"&&ws(t.ownerDocument.body);s=m}while(s);vr(a)}function vv(t,a){var s=t;t=0;do{var l=s.nextSibling;if(s.nodeType===1?a?(s._stashedDisplay=s.style.display,s.style.display="none"):(s.style.display=s._stashedDisplay||"",s.getAttribute("style")===""&&s.removeAttribute("style")):s.nodeType===3&&(a?(s._stashedText=s.nodeValue,s.nodeValue=""):s.nodeValue=s._stashedText||""),l&&l.nodeType===8)if(s=l.data,s==="/$"){if(t===0)break;t--}else s!=="$"&&s!=="$?"&&s!=="$~"&&s!=="$!"||t++;s=l}while(s)}function Ad(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var s=a;switch(a=a.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":Ad(s),Nl(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}t.removeChild(s)}}function gk(t,a,s,l){for(;t.nodeType===1;){var m=s;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!l&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(l){if(!t[Gr])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(p=t.getAttribute("rel"),p==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(p!==m.rel||t.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||t.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||t.getAttribute("title")!==(m.title==null?null:m.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(p=t.getAttribute("src"),(p!==(m.src==null?null:m.src)||t.getAttribute("type")!==(m.type==null?null:m.type)||t.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&t.getAttribute("name")===p)return t}else return t;if(t=gn(t.nextSibling),t===null)break}return null}function vk(t,a,s){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!s||(t=gn(t.nextSibling),t===null))return null;return t}function yv(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=gn(t.nextSibling),t===null))return null;return t}function Dd(t){return t.data==="$?"||t.data==="$~"}function Md(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function yk(t,a){var s=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||s.readyState!=="loading")a();else{var l=function(){a(),s.removeEventListener("DOMContentLoaded",l)};s.addEventListener("DOMContentLoaded",l),t._reactRetry=l}}function gn(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var xd=null;function bv(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"||s==="/&"){if(a===0)return gn(t.nextSibling);a--}else s!=="$"&&s!=="$!"&&s!=="$?"&&s!=="$~"&&s!=="&"||a++}t=t.nextSibling}return null}function Sv(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"){if(a===0)return t;a--}else s!=="/$"&&s!=="/&"||a++}t=t.previousSibling}return null}function Tv(t,a,s){switch(a=pc(s),t){case"html":if(t=a.documentElement,!t)throw Error(r(452));return t;case"head":if(t=a.head,!t)throw Error(r(453));return t;case"body":if(t=a.body,!t)throw Error(r(454));return t;default:throw Error(r(451))}}function ws(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);Nl(t)}var vn=new Map,Cv=new Set;function gc(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var oi=ae.d;ae.d={f:bk,r:Sk,D:Tk,C:Ck,L:kk,m:Ek,X:Rk,S:_k,M:wk};function bk(){var t=oi.f(),a=oc();return t||a}function Sk(t){var a=Ua(t);a!==null&&a.tag===5&&a.type==="form"?Bp(a):oi.r(t)}var mr=typeof document>"u"?null:document;function kv(t,a,s){var l=mr;if(l&&typeof a=="string"&&a){var m=ln(a);m='link[rel="'+t+'"][href="'+m+'"]',typeof s=="string"&&(m+='[crossorigin="'+s+'"]'),Cv.has(m)||(Cv.add(m),t={rel:t,crossOrigin:s,href:a},l.querySelector(m)===null&&(a=l.createElement("link"),wt(a,"link",t),bt(a),l.head.appendChild(a)))}}function Tk(t){oi.D(t),kv("dns-prefetch",t,null)}function Ck(t,a){oi.C(t,a),kv("preconnect",t,a)}function kk(t,a,s){oi.L(t,a,s);var l=mr;if(l&&t&&a){var m='link[rel="preload"][as="'+ln(a)+'"]';a==="image"&&s&&s.imageSrcSet?(m+='[imagesrcset="'+ln(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(m+='[imagesizes="'+ln(s.imageSizes)+'"]')):m+='[href="'+ln(t)+'"]';var p=m;switch(a){case"style":p=pr(t);break;case"script":p=gr(t)}vn.has(p)||(t=v({rel:"preload",href:a==="image"&&s&&s.imageSrcSet?void 0:t,as:a},s),vn.set(p,t),l.querySelector(m)!==null||a==="style"&&l.querySelector(Os(p))||a==="script"&&l.querySelector(As(p))||(a=l.createElement("link"),wt(a,"link",t),bt(a),l.head.appendChild(a)))}}function Ek(t,a){oi.m(t,a);var s=mr;if(s&&t){var l=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+ln(l)+'"][href="'+ln(t)+'"]',p=m;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=gr(t)}if(!vn.has(p)&&(t=v({rel:"modulepreload",href:t},a),vn.set(p,t),s.querySelector(m)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(As(p)))return}l=s.createElement("link"),wt(l,"link",t),bt(l),s.head.appendChild(l)}}}function _k(t,a,s){oi.S(t,a,s);var l=mr;if(l&&t){var m=Ia(l).hoistableStyles,p=pr(t);a=a||"default";var y=m.get(p);if(!y){var S={loading:0,preload:null};if(y=l.querySelector(Os(p)))S.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":a},s),(s=vn.get(p))&&Pd(t,s);var O=y=l.createElement("link");bt(O),wt(O,"link",t),O._p=new Promise(function(I,Y){O.onload=I,O.onerror=Y}),O.addEventListener("load",function(){S.loading|=1}),O.addEventListener("error",function(){S.loading|=2}),S.loading|=4,vc(y,a,l)}y={type:"stylesheet",instance:y,count:1,state:S},m.set(p,y)}}}function Rk(t,a){oi.X(t,a);var s=mr;if(s&&t){var l=Ia(s).hoistableScripts,m=gr(t),p=l.get(m);p||(p=s.querySelector(As(m)),p||(t=v({src:t,async:!0},a),(a=vn.get(m))&&Nd(t,a),p=s.createElement("script"),bt(p),wt(p,"link",t),s.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},l.set(m,p))}}function wk(t,a){oi.M(t,a);var s=mr;if(s&&t){var l=Ia(s).hoistableScripts,m=gr(t),p=l.get(m);p||(p=s.querySelector(As(m)),p||(t=v({src:t,async:!0,type:"module"},a),(a=vn.get(m))&&Nd(t,a),p=s.createElement("script"),bt(p),wt(p,"link",t),s.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},l.set(m,p))}}function Ev(t,a,s,l){var m=(m=ge.current)?gc(m):null;if(!m)throw Error(r(446));switch(t){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(a=pr(s.href),s=Ia(m).hoistableStyles,l=s.get(a),l||(l={type:"style",instance:null,count:0,state:null},s.set(a,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){t=pr(s.href);var p=Ia(m).hoistableStyles,y=p.get(t);if(y||(m=m.ownerDocument||m,y={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(t,y),(p=m.querySelector(Os(t)))&&!p._p&&(y.instance=p,y.state.loading=5),vn.has(t)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},vn.set(t,s),p||Ok(m,t,s,y.state))),a&&l===null)throw Error(r(528,""));return y}if(a&&l!==null)throw Error(r(529,""));return null;case"script":return a=s.async,s=s.src,typeof s=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=gr(s),s=Ia(m).hoistableScripts,l=s.get(a),l||(l={type:"script",instance:null,count:0,state:null},s.set(a,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,t))}}function pr(t){return'href="'+ln(t)+'"'}function Os(t){return'link[rel="stylesheet"]['+t+"]"}function _v(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function Ok(t,a,s,l){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=t.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),wt(a,"link",s),bt(a),t.head.appendChild(a))}function gr(t){return'[src="'+ln(t)+'"]'}function As(t){return"script[async]"+t}function Rv(t,a,s){if(a.count++,a.instance===null)switch(a.type){case"style":var l=t.querySelector('style[data-href~="'+ln(s.href)+'"]');if(l)return a.instance=l,bt(l),l;var m=v({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return l=(t.ownerDocument||t).createElement("style"),bt(l),wt(l,"style",m),vc(l,s.precedence,t),a.instance=l;case"stylesheet":m=pr(s.href);var p=t.querySelector(Os(m));if(p)return a.state.loading|=4,a.instance=p,bt(p),p;l=_v(s),(m=vn.get(m))&&Pd(l,m),p=(t.ownerDocument||t).createElement("link"),bt(p);var y=p;return y._p=new Promise(function(S,O){y.onload=S,y.onerror=O}),wt(p,"link",l),a.state.loading|=4,vc(p,s.precedence,t),a.instance=p;case"script":return p=gr(s.src),(m=t.querySelector(As(p)))?(a.instance=m,bt(m),m):(l=s,(m=vn.get(p))&&(l=v({},s),Nd(l,m)),t=t.ownerDocument||t,m=t.createElement("script"),bt(m),wt(m,"link",l),t.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(l=a.instance,a.state.loading|=4,vc(l,s.precedence,t));return a.instance}function vc(t,a,s){for(var l=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=l.length?l[l.length-1]:null,p=m,y=0;y<l.length;y++){var S=l[y];if(S.dataset.precedence===a)p=S;else if(p!==m)break}p?p.parentNode.insertBefore(t,p.nextSibling):(a=s.nodeType===9?s.head:s,a.insertBefore(t,a.firstChild))}function Pd(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function Nd(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var yc=null;function wv(t,a,s){if(yc===null){var l=new Map,m=yc=new Map;m.set(s,l)}else m=yc,l=m.get(s),l||(l=new Map,m.set(s,l));if(l.has(t))return l;for(l.set(t,null),s=s.getElementsByTagName(t),m=0;m<s.length;m++){var p=s[m];if(!(p[Gr]||p[kt]||t==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var y=p.getAttribute(a)||"";y=t+y;var S=l.get(y);S?S.push(p):l.set(y,[p])}}return l}function Ov(t,a,s){t=t.ownerDocument||t,t.head.insertBefore(s,a==="title"?t.querySelector("head > title"):null)}function Ak(t,a,s){if(s===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(t=a.disabled,typeof a.precedence=="string"&&t==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Av(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function Dk(t,a,s,l){if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var m=pr(l.href),p=a.querySelector(Os(m));if(p){a=p._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=bc.bind(t),a.then(t,t)),s.state.loading|=4,s.instance=p,bt(p);return}p=a.ownerDocument||a,l=_v(l),(m=vn.get(m))&&Pd(l,m),p=p.createElement("link"),bt(p);var y=p;y._p=new Promise(function(S,O){y.onload=S,y.onerror=O}),wt(p,"link",l),s.instance=p}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(t.count++,s=bc.bind(t),a.addEventListener("load",s),a.addEventListener("error",s))}}var Ld=0;function Mk(t,a){return t.stylesheets&&t.count===0&&Tc(t,t.stylesheets),0<t.count||0<t.imgCount?function(s){var l=setTimeout(function(){if(t.stylesheets&&Tc(t,t.stylesheets),t.unsuspend){var p=t.unsuspend;t.unsuspend=null,p()}},6e4+a);0<t.imgBytes&&Ld===0&&(Ld=62500*dk());var m=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Tc(t,t.stylesheets),t.unsuspend)){var p=t.unsuspend;t.unsuspend=null,p()}},(t.imgBytes>Ld?50:800)+a);return t.unsuspend=s,function(){t.unsuspend=null,clearTimeout(l),clearTimeout(m)}}:null}function bc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Tc(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Sc=null;function Tc(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Sc=new Map,a.forEach(xk,t),Sc=null,bc.call(t))}function xk(t,a){if(!(a.state.loading&4)){var s=Sc.get(t);if(s)var l=s.get(null);else{s=new Map,Sc.set(t,s);for(var m=t.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var y=m[p];(y.nodeName==="LINK"||y.getAttribute("media")!=="not all")&&(s.set(y.dataset.precedence,y),l=y)}l&&s.set(null,l)}m=a.instance,y=m.getAttribute("data-precedence"),p=s.get(y)||l,p===l&&s.set(null,m),s.set(y,m),this.count++,l=bc.bind(this),m.addEventListener("load",l),m.addEventListener("error",l),p?p.parentNode.insertBefore(m,p.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(m,t.firstChild)),a.state.loading|=4}}var Ds={$$typeof:q,Provider:null,Consumer:null,_currentValue:ue,_currentValue2:ue,_threadCount:0};function Pk(t,a,s,l,m,p,y,S,O){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Dl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dl(0),this.hiddenUpdates=Dl(null),this.identifierPrefix=l,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function Dv(t,a,s,l,m,p,y,S,O,I,Y,$){return t=new Pk(t,a,s,y,O,I,Y,$,S),a=1,p===!0&&(a|=24),p=$t(3,null,null,a),t.current=p,p.stateNode=t,a=mu(),a.refCount++,t.pooledCache=a,a.refCount++,p.memoizedState={element:l,isDehydrated:s,cache:a},yu(p),t}function Mv(t){return t?(t=Ka,t):Ka}function xv(t,a,s,l,m,p){m=Mv(m),l.context===null?l.context=m:l.pendingContext=m,l=Ai(a),l.payload={element:s},p=p===void 0?null:p,p!==null&&(l.callback=p),s=Di(t,l,a),s!==null&&(Ht(s,t,a),cs(s,t,a))}function Pv(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<a?s:a}}function Ud(t,a){Pv(t,a),(t=t.alternate)&&Pv(t,a)}function Nv(t){if(t.tag===13||t.tag===31){var a=fa(t,67108864);a!==null&&Ht(a,t,67108864),Ud(t,67108864)}}function Lv(t){if(t.tag===13||t.tag===31){var a=rn();a=Ml(a);var s=fa(t,a);s!==null&&Ht(s,t,a),Ud(t,a)}}var Cc=!0;function Nk(t,a,s,l){var m=V.T;V.T=null;var p=ae.p;try{ae.p=2,Id(t,a,s,l)}finally{ae.p=p,V.T=m}}function Lk(t,a,s,l){var m=V.T;V.T=null;var p=ae.p;try{ae.p=8,Id(t,a,s,l)}finally{ae.p=p,V.T=m}}function Id(t,a,s,l){if(Cc){var m=jd(l);if(m===null)kd(t,a,l,kc,s),Iv(t,l);else if(Ik(m,t,a,s,l))l.stopPropagation();else if(Iv(t,l),a&4&&-1<Uk.indexOf(t)){for(;m!==null;){var p=Ua(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var y=oa(p.pendingLanes);if(y!==0){var S=p;for(S.pendingLanes|=2,S.entangledLanes|=2;y;){var O=1<<31-Zt(y);S.entanglements[1]|=O,y&=~O}Un(p),(je&6)===0&&(rc=Qt()+500,Es(0))}}break;case 31:case 13:S=fa(p,2),S!==null&&Ht(S,p,2),oc(),Ud(p,2)}if(p=jd(l),p===null&&kd(t,a,l,kc,s),p===m)break;m=p}m!==null&&l.stopPropagation()}else kd(t,a,l,null,s)}}function jd(t){return t=zl(t),Bd(t)}var kc=null;function Bd(t){if(kc=null,t=La(t),t!==null){var a=c(t);if(a===null)t=null;else{var s=a.tag;if(s===13){if(t=d(a),t!==null)return t;t=null}else if(s===31){if(t=u(a),t!==null)return t;t=null}else if(s===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return kc=t,null}function Uv(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(TT()){case Hh:return 2;case Gh:return 8;case fo:case CT:return 32;case Yh:return 268435456;default:return 32}default:return 32}}var zd=!1,qi=null,Vi=null,Fi=null,Ms=new Map,xs=new Map,Hi=[],Uk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Iv(t,a){switch(t){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Vi=null;break;case"mouseover":case"mouseout":Fi=null;break;case"pointerover":case"pointerout":Ms.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":xs.delete(a.pointerId)}}function Ps(t,a,s,l,m,p){return t===null||t.nativeEvent!==p?(t={blockedOn:a,domEventName:s,eventSystemFlags:l,nativeEvent:p,targetContainers:[m]},a!==null&&(a=Ua(a),a!==null&&Nv(a)),t):(t.eventSystemFlags|=l,a=t.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),t)}function Ik(t,a,s,l,m){switch(a){case"focusin":return qi=Ps(qi,t,a,s,l,m),!0;case"dragenter":return Vi=Ps(Vi,t,a,s,l,m),!0;case"mouseover":return Fi=Ps(Fi,t,a,s,l,m),!0;case"pointerover":var p=m.pointerId;return Ms.set(p,Ps(Ms.get(p)||null,t,a,s,l,m)),!0;case"gotpointercapture":return p=m.pointerId,xs.set(p,Ps(xs.get(p)||null,t,a,s,l,m)),!0}return!1}function jv(t){var a=La(t.target);if(a!==null){var s=c(a);if(s!==null){if(a=s.tag,a===13){if(a=d(s),a!==null){t.blockedOn=a,Wh(t.priority,function(){Lv(s)});return}}else if(a===31){if(a=u(s),a!==null){t.blockedOn=a,Wh(t.priority,function(){Lv(s)});return}}else if(a===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ec(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var s=jd(t.nativeEvent);if(s===null){s=t.nativeEvent;var l=new s.constructor(s.type,s);Bl=l,s.target.dispatchEvent(l),Bl=null}else return a=Ua(s),a!==null&&Nv(a),t.blockedOn=s,!1;a.shift()}return!0}function Bv(t,a,s){Ec(t)&&s.delete(a)}function jk(){zd=!1,qi!==null&&Ec(qi)&&(qi=null),Vi!==null&&Ec(Vi)&&(Vi=null),Fi!==null&&Ec(Fi)&&(Fi=null),Ms.forEach(Bv),xs.forEach(Bv)}function _c(t,a){t.blockedOn===a&&(t.blockedOn=null,zd||(zd=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,jk)))}var Rc=null;function zv(t){Rc!==t&&(Rc=t,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Rc===t&&(Rc=null);for(var a=0;a<t.length;a+=3){var s=t[a],l=t[a+1],m=t[a+2];if(typeof l!="function"){if(Bd(l||s)===null)continue;break}var p=Ua(s);p!==null&&(t.splice(a,3),a-=3,ju(p,{pending:!0,data:m,method:s.method,action:l},l,m))}}))}function vr(t){function a(O){return _c(O,t)}qi!==null&&_c(qi,t),Vi!==null&&_c(Vi,t),Fi!==null&&_c(Fi,t),Ms.forEach(a),xs.forEach(a);for(var s=0;s<Hi.length;s++){var l=Hi[s];l.blockedOn===t&&(l.blockedOn=null)}for(;0<Hi.length&&(s=Hi[0],s.blockedOn===null);)jv(s),s.blockedOn===null&&Hi.shift();if(s=(t.ownerDocument||t).$$reactFormReplay,s!=null)for(l=0;l<s.length;l+=3){var m=s[l],p=s[l+1],y=m[jt]||null;if(typeof p=="function")y||zv(s);else if(y){var S=null;if(p&&p.hasAttribute("formAction")){if(m=p,y=p[jt]||null)S=y.formAction;else if(Bd(m)!==null)continue}else S=y.action;typeof S=="function"?s[l+1]=S:(s.splice(l,3),l-=3),zv(s)}}}function qv(){function t(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(y){return m=y})},focusReset:"manual",scroll:"manual"})}function a(){m!==null&&(m(),m=null),l||setTimeout(s,20)}function s(){if(!l&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,m=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(s,100),function(){l=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),m!==null&&(m(),m=null)}}}function qd(t){this._internalRoot=t}wc.prototype.render=qd.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(r(409));var s=a.current,l=rn();xv(s,l,t,a,null,null)},wc.prototype.unmount=qd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;xv(t.current,2,null,t,null,null),oc(),a[Na]=null}};function wc(t){this._internalRoot=t}wc.prototype.unstable_scheduleHydration=function(t){if(t){var a=Zh();t={blockedOn:null,target:t,priority:a};for(var s=0;s<Hi.length&&a!==0&&a<Hi[s].priority;s++);Hi.splice(s,0,t),s===0&&jv(t)}};var Vv=e.version;if(Vv!=="19.2.3")throw Error(r(527,Vv,"19.2.3"));ae.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=h(a),t=t!==null?g(t):null,t=t===null?null:t.stateNode,t};var Bk={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oc.isDisabled&&Oc.supportsFiber)try{Vr=Oc.inject(Bk),Xt=Oc}catch{}}return Ls.createRoot=function(t,a){if(!o(t))throw Error(r(299));var s=!1,l="",m=Qp,p=Xp,y=Zp;return a!=null&&(a.unstable_strictMode===!0&&(s=!0),a.identifierPrefix!==void 0&&(l=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(p=a.onCaughtError),a.onRecoverableError!==void 0&&(y=a.onRecoverableError)),a=Dv(t,1,!1,null,null,s,l,null,m,p,y,qv),t[Na]=a.current,Cd(t),new qd(a)},Ls.hydrateRoot=function(t,a,s){if(!o(t))throw Error(r(299));var l=!1,m="",p=Qp,y=Xp,S=Zp,O=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(S=s.onRecoverableError),s.formState!==void 0&&(O=s.formState)),a=Dv(t,1,!0,a,s??null,l,m,O,p,y,S,qv),a.context=Mv(null),s=a.current,l=rn(),l=Ml(l),m=Ai(l),m.callback=null,Di(s,m,l),s=l,a.current.lanes=s,Hr(a,s),Un(a),t[Na]=a.current,Cd(t),new wc(a)},Ls.version="19.2.3",Ls}var Wv;function Xk(){if(Wv)return Hd.exports;Wv=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),Hd.exports=Qk(),Hd.exports}var Zk=Xk(),Jd={exports:{}},Qd={};var $v;function Wk(){if($v)return Qd;$v=1;var i=dl().__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;return Qd.c=function(e){return i.H.useMemoCache(e)},Qd}var ey;function $k(){return ey||(ey=1,Jd.exports=Wk()),Jd.exports}var Ur=$k();const eE=i=>A.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i},A.createElement("path",{d:"M12 17.5C13.25 17.5 14.3127 17.0627 15.188 16.188C16.0633 15.3133 16.5007 14.2507 16.5 13C16.4993 11.7493 16.062 10.687 15.188 9.813C14.314 8.939 13.2513 8.50133 12 8.5C10.7487 8.49867 9.68633 8.93633 8.813 9.813C7.93967 10.6897 7.502 11.752 7.5 13C7.498 14.248 7.93567 15.3107 8.813 16.188C9.69033 17.0653 10.7527 17.5027 12 17.5ZM12 15.5C11.3 15.5 10.7083 15.2583 10.225 14.775C9.74167 14.2917 9.5 13.7 9.5 13C9.5 12.3 9.74167 11.7083 10.225 11.225C10.7083 10.7417 11.3 10.5 12 10.5C12.7 10.5 13.2917 10.7417 13.775 11.225C14.2583 11.7083 14.5 12.3 14.5 13C14.5 13.7 14.2583 14.2917 13.775 14.775C13.2917 15.2583 12.7 15.5 12 15.5ZM4 21C3.45 21 2.97933 20.8043 2.588 20.413C2.19667 20.0217 2.00067 19.5507 2 19V7C2 6.45 2.196 5.97933 2.588 5.588C2.98 5.19667 3.45067 5.00067 4 5H7.15L9 3H15L16.85 5H20C20.55 5 21.021 5.196 21.413 5.588C21.805 5.98 22.0007 6.45067 22 7V19C22 19.55 21.8043 20.021 21.413 20.413C21.0217 20.805 20.5507 21.0007 20 21H4Z",fill:"currentColor"})),tE=i=>A.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i},A.createElement("path",{d:"M12 14C11.1667 14 10.4583 13.7083 9.875 13.125C9.29167 12.5417 9 11.8333 9 11V5C9 4.16667 9.29167 3.45833 9.875 2.875C10.4583 2.29167 11.1667 2 12 2C12.8333 2 13.5417 2.29167 14.125 2.875C14.7083 3.45833 15 4.16667 15 5V11C15 11.8333 14.7083 12.5417 14.125 13.125C13.5417 13.7083 12.8333 14 12 14ZM11 21V17.925C9.26667 17.6917 7.83333 16.9167 6.7 15.6C5.56667 14.2833 5 12.75 5 11H7C7 12.3833 7.4875 13.5625 8.4625 14.5375C9.4375 15.5125 10.6167 16 12 16C13.3833 16 14.5625 15.5125 15.5375 14.5375C16.5125 13.5625 17 12.3833 17 11H19C19 12.75 18.4333 14.2833 17.3 15.6C16.1667 16.9167 14.7333 17.6917 13 17.925V21H11Z",fill:"currentColor"})),nE=i=>A.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...i},A.createElement("path",{d:"M19 11.975C19 10.5917 18.6333 9.32933 17.9 8.188C17.1667 7.04667 16.1833 6.19233 14.95 5.625C14.7 5.50833 14.5167 5.32933 14.4 5.088C14.2833 4.84667 14.2667 4.60067 14.35 4.35C14.45 4.08333 14.6293 3.89167 14.888 3.775C15.1467 3.65833 15.409 3.65833 15.675 3.775C17.2917 4.49167 18.5833 5.58767 19.55 7.063C20.5167 8.53833 21 10.1753 21 11.974C21 13.7727 20.5167 15.4103 19.55 16.887C18.5833 18.3637 17.2917 19.4593 15.675 20.174C15.4083 20.2907 15.1457 20.2907 14.887 20.174C14.6283 20.0573 14.4493 19.8657 14.35 19.599C14.2667 19.349 14.2833 19.1033 14.4 18.862C14.5167 18.6207 14.7 18.4413 14.95 18.324C16.1833 17.7573 17.1667 16.9033 17.9 15.762C18.6333 14.6207 19 13.358 19 11.974M7 15H4C3.71667 15 3.47933 14.904 3.288 14.712C3.09667 14.52 3.00067 14.2827 3 14V10C3 9.71667 3.096 9.47933 3.288 9.288C3.48 9.09667 3.71733 9.00067 4 9H7L10.3 5.7C10.6167 5.38333 10.9793 5.31233 11.388 5.487C11.7967 5.66167 12.0007 5.97433 12 6.425V17.575C12 18.025 11.796 18.3377 11.388 18.513C10.98 18.6883 10.6173 18.6173 10.3 18.3L7 15ZM16.5 12C16.5 12.7 16.3417 13.3627 16.025 13.988C15.7083 14.6133 15.2917 15.1257 14.775 15.525C14.6083 15.625 14.4373 15.6293 14.262 15.538C14.0867 15.4467 13.9993 15.3007 14 15.1V8.85C14 8.65 14.0877 8.50433 14.263 8.413C14.4383 8.32167 14.609 8.32567 14.775 8.425C15.2917 8.84167 15.7083 9.36667 16.025 10C16.3417 10.6333 16.5 11.3 16.5 12Z",fill:"#1D1B20"})),D0=A.createContext(null),iE=i=>{const e=Ur.c(14),{children:n}=i,[r,o]=A.useState(rE),[c,d]=A.useState(sE);let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u={mic:{icon:Ce.jsx(tE,{}),label:"Default Microphone"},speaker:{icon:Ce.jsx(nE,{}),label:"Default Speakers"},camera:{icon:Ce.jsx(eE,{}),label:"Default Camera"}},e[0]=u):u=e[0];const[f,h]=A.useState(u);let g,v;e[1]!==r?(g=()=>{r?sessionStorage.setItem("sessionData",JSON.stringify(r)):sessionStorage.removeItem("sessionData")},v=[r],e[1]=r,e[2]=g,e[3]=v):(g=e[2],v=e[3]),A.useEffect(g,v);let b,T;e[4]!==c?(b=()=>{c?sessionStorage.setItem("selectedCompanion",JSON.stringify(c)):sessionStorage.removeItem("selectedCompanion")},T=[c],e[4]=c,e[5]=b,e[6]=T):(b=e[5],T=e[6]),A.useEffect(b,T);let _;e[7]!==c||e[8]!==f||e[9]!==r?(_={sessionData:r,setSessionData:o,selectedCompanion:c,setSelectedCompanion:d,selectedDevices:f,setSelectedDevices:h},e[7]=c,e[8]=f,e[9]=r,e[10]=_):_=e[10];const C=_;let M;return e[11]!==n||e[12]!==C?(M=Ce.jsx(D0.Provider,{value:C,children:n}),e[11]=n,e[12]=C,e[13]=M):M=e[13],M},aE=()=>{const i=A.useContext(D0);if(!i)throw new Error("useSessionContext must be used within a SessionProvider");return i};function rE(){const i=sessionStorage.getItem("sessionData");return i?JSON.parse(i):null}function sE(){const i=sessionStorage.getItem("selectedCompanion");return i?JSON.parse(i):null}const oE="modulepreload",cE=function(i){return"/hireright-interview/"+i},ty={},na=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){let f=function(h){return Promise.all(h.map(g=>Promise.resolve(g).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=d?.nonce||d?.getAttribute("nonce");o=f(n.map(h=>{if(h=cE(h),h in ty)return;ty[h]=!0;const g=h.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${v}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":oE,g||(b.as="script"),b.crossOrigin="",b.href=h,u&&b.setAttribute("nonce",u),document.head.appendChild(b),g)return new Promise((T,_)=>{b.addEventListener("load",T),b.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function c(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return o.then(d=>{for(const u of d||[])u.status==="rejected"&&c(u.reason);return e().catch(c)})};var ny="popstate";function lE(i={}){function e(r,o){let{pathname:c,search:d,hash:u}=r.location;return Ef("",{pathname:c,search:d,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:Qs(o)}return dE(e,n,null,i)}function et(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function Tn(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uE(){return Math.random().toString(36).substring(2,10)}function iy(i,e){return{usr:i.state,key:i.key,idx:e}}function Ef(i,e,n=null,r){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof e=="string"?Ir(e):e,state:n,key:e&&e.key||r||uE()}}function Qs({pathname:i="/",search:e="",hash:n=""}){return e&&e!=="?"&&(i+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(i+=n.charAt(0)==="#"?n:"#"+n),i}function Ir(i){let e={};if(i){let n=i.indexOf("#");n>=0&&(e.hash=i.substring(n),i=i.substring(0,n));let r=i.indexOf("?");r>=0&&(e.search=i.substring(r),i=i.substring(0,r)),i&&(e.pathname=i)}return e}function dE(i,e,n,r={}){let{window:o=document.defaultView,v5Compat:c=!1}=r,d=o.history,u="POP",f=null,h=g();h==null&&(h=0,d.replaceState({...d.state,idx:h},""));function g(){return(d.state||{idx:null}).idx}function v(){u="POP";let M=g(),R=M==null?null:M-h;h=M,f&&f({action:u,location:C.location,delta:R})}function b(M,R){u="PUSH";let B=Ef(C.location,M,R);h=g()+1;let q=iy(B,h),E=C.createHref(B);try{d.pushState(q,"",E)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;o.location.assign(E)}c&&f&&f({action:u,location:C.location,delta:1})}function T(M,R){u="REPLACE";let B=Ef(C.location,M,R);h=g();let q=iy(B,h),E=C.createHref(B);d.replaceState(q,"",E),c&&f&&f({action:u,location:C.location,delta:0})}function _(M){return fE(M)}let C={get action(){return u},get location(){return i(o,d)},listen(M){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(ny,v),f=M,()=>{o.removeEventListener(ny,v),f=null}},createHref(M){return e(o,M)},createURL:_,encodeLocation(M){let R=_(M);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:b,replace:T,go(M){return d.go(M)}};return C}function fE(i,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),et(n,"No window.location.(origin|href) available to create URL");let r=typeof i=="string"?i:Qs(i);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function M0(i,e,n="/"){return hE(i,e,n,!1)}function hE(i,e,n,r){let o=typeof e=="string"?Ir(e):e,c=gi(o.pathname||"/",n);if(c==null)return null;let d=x0(i);mE(d);let u=null;for(let f=0;u==null&&f<d.length;++f){let h=_E(c);u=kE(d[f],h,r)}return u}function x0(i,e=[],n=[],r="",o=!1){let c=(d,u,f=o,h)=>{let g={relativePath:h===void 0?d.path||"":h,caseSensitive:d.caseSensitive===!0,childrenIndex:u,route:d};if(g.relativePath.startsWith("/")){if(!g.relativePath.startsWith(r)&&f)return;et(g.relativePath.startsWith(r),`Absolute route path "${g.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(r.length)}let v=pi([r,g.relativePath]),b=n.concat(g);d.children&&d.children.length>0&&(et(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),x0(d.children,e,b,v,f)),!(d.path==null&&!d.index)&&e.push({path:v,score:TE(v,d.index),routesMeta:b})};return i.forEach((d,u)=>{if(d.path===""||!d.path?.includes("?"))c(d,u);else for(let f of P0(d.path))c(d,u,!0,f)}),e}function P0(i){let e=i.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),c=n.replace(/\?$/,"");if(r.length===0)return o?[c,""]:[c];let d=P0(r.join("/")),u=[];return u.push(...d.map(f=>f===""?c:[c,f].join("/"))),o&&u.push(...d),u.map(f=>i.startsWith("/")&&f===""?"/":f)}function mE(i){i.sort((e,n)=>e.score!==n.score?n.score-e.score:CE(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var pE=/^:[\w-]+$/,gE=3,vE=2,yE=1,bE=10,SE=-2,ay=i=>i==="*";function TE(i,e){let n=i.split("/"),r=n.length;return n.some(ay)&&(r+=SE),e&&(r+=vE),n.filter(o=>!ay(o)).reduce((o,c)=>o+(pE.test(c)?gE:c===""?yE:bE),r)}function CE(i,e){return i.length===e.length&&i.slice(0,-1).every((r,o)=>r===e[o])?i[i.length-1]-e[e.length-1]:0}function kE(i,e,n=!1){let{routesMeta:r}=i,o={},c="/",d=[];for(let u=0;u<r.length;++u){let f=r[u],h=u===r.length-1,g=c==="/"?e:e.slice(c.length)||"/",v=Zc({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},g),b=f.route;if(!v&&h&&n&&!r[r.length-1].route.index&&(v=Zc({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},g)),!v)return null;Object.assign(o,v.params),d.push({params:o,pathname:pi([c,v.pathname]),pathnameBase:AE(pi([c,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(c=pi([c,v.pathnameBase]))}return d}function Zc(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[n,r]=EE(i.path,i.caseSensitive,i.end),o=e.match(n);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),u=o.slice(1);return{params:r.reduce((h,{paramName:g,isOptional:v},b)=>{if(g==="*"){let _=u[b]||"";d=c.slice(0,c.length-_.length).replace(/(.)\/+$/,"$1")}const T=u[b];return v&&!T?h[g]=void 0:h[g]=(T||"").replace(/%2F/g,"/"),h},{}),pathname:c,pathnameBase:d,pattern:i}}function EE(i,e=!1,n=!0){Tn(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let r=[],o="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,u,f)=>(r.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(r.push({paramName:"*"}),o+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":i!==""&&i!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function _E(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Tn(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),i}}function gi(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=i.charAt(n);return r&&r!=="/"?null:i.slice(n)||"/"}var N0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,RE=i=>N0.test(i);function wE(i,e="/"){let{pathname:n,search:r="",hash:o=""}=typeof i=="string"?Ir(i):i,c;if(n)if(RE(n))c=n;else{if(n.includes("//")){let d=n;n=n.replace(/\/\/+/g,"/"),Tn(!1,`Pathnames cannot have embedded double slashes - normalizing ${d} -> ${n}`)}n.startsWith("/")?c=ry(n.substring(1),"/"):c=ry(n,e)}else c=e;return{pathname:c,search:DE(r),hash:ME(o)}}function ry(i,e){let n=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function Xd(i,e,n,r){return`Cannot include a '${i}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function OE(i){return i.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function eh(i){let e=OE(i);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function th(i,e,n,r=!1){let o;typeof i=="string"?o=Ir(i):(o={...i},et(!o.pathname||!o.pathname.includes("?"),Xd("?","pathname","search",o)),et(!o.pathname||!o.pathname.includes("#"),Xd("#","pathname","hash",o)),et(!o.search||!o.search.includes("#"),Xd("#","search","hash",o)));let c=i===""||o.pathname==="",d=c?"/":o.pathname,u;if(d==null)u=n;else{let v=e.length-1;if(!r&&d.startsWith("..")){let b=d.split("/");for(;b[0]==="..";)b.shift(),v-=1;o.pathname=b.join("/")}u=v>=0?e[v]:"/"}let f=wE(o,u),h=d&&d!=="/"&&d.endsWith("/"),g=(c||d===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(h||g)&&(f.pathname+="/"),f}var pi=i=>i.join("/").replace(/\/\/+/g,"/"),AE=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),DE=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,ME=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i,xE=class{constructor(i,e,n,r=!1){this.status=i,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function PE(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}function NE(i){return i.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var L0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function U0(i,e){let n=i;if(typeof n!="string"||!N0.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let r=n,o=!1;if(L0)try{let c=new URL(window.location.href),d=n.startsWith("//")?new URL(c.protocol+n):new URL(n),u=gi(d.pathname,e);d.origin===c.origin&&u!=null?n=u+d.search+d.hash:o=!0}catch{Tn(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:o,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var I0=["POST","PUT","PATCH","DELETE"];new Set(I0);var LE=["GET",...I0];new Set(LE);var jr=A.createContext(null);jr.displayName="DataRouter";var fl=A.createContext(null);fl.displayName="DataRouterState";var UE=A.createContext(!1),j0=A.createContext({isTransitioning:!1});j0.displayName="ViewTransition";var IE=A.createContext(new Map);IE.displayName="Fetchers";var jE=A.createContext(null);jE.displayName="Await";var on=A.createContext(null);on.displayName="Navigation";var so=A.createContext(null);so.displayName="Location";var xn=A.createContext({outlet:null,matches:[],isDataRoute:!1});xn.displayName="Route";var nh=A.createContext(null);nh.displayName="RouteError";var B0="REACT_ROUTER_ERROR",BE="REDIRECT",zE="ROUTE_ERROR_RESPONSE";function qE(i){if(i.startsWith(`${B0}:${BE}:{`))try{let e=JSON.parse(i.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function VE(i){if(i.startsWith(`${B0}:${zE}:{`))try{let e=JSON.parse(i.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new xE(e.status,e.statusText,e.data)}catch{}}function FE(i,{relative:e}={}){et(Br(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=A.useContext(on),{hash:o,pathname:c,search:d}=oo(i,{relative:e}),u=c;return n!=="/"&&(u=c==="/"?n:pi([n,c])),r.createHref({pathname:u,search:d,hash:o})}function Br(){return A.useContext(so)!=null}function ia(){return et(Br(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(so).location}var z0="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function q0(i){A.useContext(on).static||A.useLayoutEffect(i)}function ih(){let{isDataRoute:i}=A.useContext(xn);return i?n1():HE()}function HE(){et(Br(),"useNavigate() may be used only in the context of a <Router> component.");let i=A.useContext(jr),{basename:e,navigator:n}=A.useContext(on),{matches:r}=A.useContext(xn),{pathname:o}=ia(),c=JSON.stringify(eh(r)),d=A.useRef(!1);return q0(()=>{d.current=!0}),A.useCallback((f,h={})=>{if(Tn(d.current,z0),!d.current)return;if(typeof f=="number"){n.go(f);return}let g=th(f,JSON.parse(c),o,h.relative==="path");i==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:pi([e,g.pathname])),(h.replace?n.replace:n.push)(g,h.state,h)},[e,n,c,o,i])}A.createContext(null);function hM(){let{matches:i}=A.useContext(xn),e=i[i.length-1];return e?e.params:{}}function oo(i,{relative:e}={}){let{matches:n}=A.useContext(xn),{pathname:r}=ia(),o=JSON.stringify(eh(n));return A.useMemo(()=>th(i,JSON.parse(o),r,e==="path"),[i,o,r,e])}function GE(i,e){return V0(i,e)}function V0(i,e,n,r,o){et(Br(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=A.useContext(on),{matches:d}=A.useContext(xn),u=d[d.length-1],f=u?u.params:{},h=u?u.pathname:"/",g=u?u.pathnameBase:"/",v=u&&u.route;{let B=v&&v.path||"";H0(h,!v||B.endsWith("*")||B.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${B}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${B}"> to <Route path="${B==="/"?"*":`${B}/*`}">.`)}let b=ia(),T;if(e){let B=typeof e=="string"?Ir(e):e;et(g==="/"||B.pathname?.startsWith(g),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${B.pathname}" was given in the \`location\` prop.`),T=B}else T=b;let _=T.pathname||"/",C=_;if(g!=="/"){let B=g.replace(/^\//,"").split("/");C="/"+_.replace(/^\//,"").split("/").slice(B.length).join("/")}let M=M0(i,{pathname:C});Tn(v||M!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),Tn(M==null||M[M.length-1].route.element!==void 0||M[M.length-1].route.Component!==void 0||M[M.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=XE(M&&M.map(B=>Object.assign({},B,{params:Object.assign({},f,B.params),pathname:pi([g,c.encodeLocation?c.encodeLocation(B.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?g:pi([g,c.encodeLocation?c.encodeLocation(B.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:B.pathnameBase])})),d,n,r,o);return e&&R?A.createElement(so.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},R):R}function YE(){let i=t1(),e=PE(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),n=i instanceof Error?i.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},c={padding:"2px 4px",backgroundColor:r},d=null;return console.error("Error handled by React Router default ErrorBoundary:",i),d=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:c},"ErrorBoundary")," or"," ",A.createElement("code",{style:c},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:o},n):null,d)}var KE=A.createElement(YE,null),F0=class extends A.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,e){return e.location!==i.location||e.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:e.error,location:e.location,revalidation:i.revalidation||e.revalidation}}componentDidCatch(i,e){this.props.onError?this.props.onError(i,e):console.error("React Router caught the following error during render",i)}render(){let i=this.state.error;if(this.context&&typeof i=="object"&&i&&"digest"in i&&typeof i.digest=="string"){const n=VE(i.digest);n&&(i=n)}let e=i!==void 0?A.createElement(xn.Provider,{value:this.props.routeContext},A.createElement(nh.Provider,{value:i,children:this.props.component})):this.props.children;return this.context?A.createElement(JE,{error:i},e):e}};F0.contextType=UE;var Zd=new WeakMap;function JE({children:i,error:e}){let{basename:n}=A.useContext(on);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=qE(e.digest);if(r){let o=Zd.get(e);if(o)throw o;let c=U0(r.location,n);if(L0&&!Zd.get(e))if(c.isExternal||r.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:r.replace}));throw Zd.set(e,d),d}return A.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return i}function QE({routeContext:i,match:e,children:n}){let r=A.useContext(jr);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(xn.Provider,{value:i},n)}function XE(i,e=[],n=null,r=null,o=null){if(i==null){if(!n)return null;if(n.errors)i=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)i=n.matches;else return null}let c=i,d=n?.errors;if(d!=null){let g=c.findIndex(v=>v.route.id&&d?.[v.route.id]!==void 0);et(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,g+1))}let u=!1,f=-1;if(n)for(let g=0;g<c.length;g++){let v=c[g];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=g),v.route.id){let{loaderData:b,errors:T}=n,_=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!T||T[v.route.id]===void 0);if(v.route.lazy||_){u=!0,f>=0?c=c.slice(0,f+1):c=[c[0]];break}}}let h=n&&r?(g,v)=>{r(g,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:NE(n.matches),errorInfo:v})}:void 0;return c.reduceRight((g,v,b)=>{let T,_=!1,C=null,M=null;n&&(T=d&&v.route.id?d[v.route.id]:void 0,C=v.route.errorElement||KE,u&&(f<0&&b===0?(H0("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,M=null):f===b&&(_=!0,M=v.route.hydrateFallbackElement||null)));let R=e.concat(c.slice(0,b+1)),B=()=>{let q;return T?q=C:_?q=M:v.route.Component?q=A.createElement(v.route.Component,null):v.route.element?q=v.route.element:q=g,A.createElement(QE,{match:v,routeContext:{outlet:g,matches:R,isDataRoute:n!=null},children:q})};return n&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?A.createElement(F0,{location:n.location,revalidation:n.revalidation,component:C,error:T,children:B(),routeContext:{outlet:null,matches:R,isDataRoute:!0},onError:h}):B()},null)}function ah(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ZE(i){let e=A.useContext(jr);return et(e,ah(i)),e}function WE(i){let e=A.useContext(fl);return et(e,ah(i)),e}function $E(i){let e=A.useContext(xn);return et(e,ah(i)),e}function rh(i){let e=$E(i),n=e.matches[e.matches.length-1];return et(n.route.id,`${i} can only be used on routes that contain a unique "id"`),n.route.id}function e1(){return rh("useRouteId")}function t1(){let i=A.useContext(nh),e=WE("useRouteError"),n=rh("useRouteError");return i!==void 0?i:e.errors?.[n]}function n1(){let{router:i}=ZE("useNavigate"),e=rh("useNavigate"),n=A.useRef(!1);return q0(()=>{n.current=!0}),A.useCallback(async(o,c={})=>{Tn(n.current,z0),n.current&&(typeof o=="number"?await i.navigate(o):await i.navigate(o,{fromRouteId:e,...c}))},[i,e])}var sy={};function H0(i,e,n){!e&&!sy[i]&&(sy[i]=!0,Tn(!1,n))}A.memo(i1);function i1({routes:i,future:e,state:n,onError:r}){return V0(i,void 0,n,r,e)}function oy({to:i,replace:e,state:n,relative:r}){et(Br(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=A.useContext(on);Tn(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=A.useContext(xn),{pathname:d}=ia(),u=ih(),f=th(i,eh(c),d,r==="path"),h=JSON.stringify(f);return A.useEffect(()=>{u(JSON.parse(h),{replace:e,state:n,relative:r})},[u,h,r,e,n]),null}function ci(i){et(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function a1({basename:i="/",children:e=null,location:n,navigationType:r="POP",navigator:o,static:c=!1,unstable_useTransitions:d}){et(!Br(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=i.replace(/^\/*/,"/"),f=A.useMemo(()=>({basename:u,navigator:o,static:c,unstable_useTransitions:d,future:{}}),[u,o,c,d]);typeof n=="string"&&(n=Ir(n));let{pathname:h="/",search:g="",hash:v="",state:b=null,key:T="default"}=n,_=A.useMemo(()=>{let C=gi(h,u);return C==null?null:{location:{pathname:C,search:g,hash:v,state:b,key:T},navigationType:r}},[u,h,g,v,b,T,r]);return Tn(_!=null,`<Router basename="${u}"> is not able to match the URL "${h}${g}${v}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:A.createElement(on.Provider,{value:f},A.createElement(so.Provider,{children:e,value:_}))}function r1({children:i,location:e}){return GE(_f(i),e)}function _f(i,e=[]){let n=[];return A.Children.forEach(i,(r,o)=>{if(!A.isValidElement(r))return;let c=[...e,o];if(r.type===A.Fragment){n.push.apply(n,_f(r.props.children,c));return}et(r.type===ci,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),et(!r.props.index||!r.props.children,"An index route cannot have child routes.");let d={id:r.props.id||c.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(d.children=_f(r.props.children,c)),n.push(d)}),n}var Lc="get",Uc="application/x-www-form-urlencoded";function hl(i){return typeof HTMLElement<"u"&&i instanceof HTMLElement}function s1(i){return hl(i)&&i.tagName.toLowerCase()==="button"}function o1(i){return hl(i)&&i.tagName.toLowerCase()==="form"}function c1(i){return hl(i)&&i.tagName.toLowerCase()==="input"}function l1(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function u1(i,e){return i.button===0&&(!e||e==="_self")&&!l1(i)}var Ac=null;function d1(){if(Ac===null)try{new FormData(document.createElement("form"),0),Ac=!1}catch{Ac=!0}return Ac}var f1=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Wd(i){return i!=null&&!f1.has(i)?(Tn(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Uc}"`),null):i}function h1(i,e){let n,r,o,c,d;if(o1(i)){let u=i.getAttribute("action");r=u?gi(u,e):null,n=i.getAttribute("method")||Lc,o=Wd(i.getAttribute("enctype"))||Uc,c=new FormData(i)}else if(s1(i)||c1(i)&&(i.type==="submit"||i.type==="image")){let u=i.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=i.getAttribute("formaction")||u.getAttribute("action");if(r=f?gi(f,e):null,n=i.getAttribute("formmethod")||u.getAttribute("method")||Lc,o=Wd(i.getAttribute("formenctype"))||Wd(u.getAttribute("enctype"))||Uc,c=new FormData(u,i),!d1()){let{name:h,type:g,value:v}=i;if(g==="image"){let b=h?`${h}.`:"";c.append(`${b}x`,"0"),c.append(`${b}y`,"0")}else h&&c.append(h,v)}}else{if(hl(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Lc,r=null,o=Uc,d=i}return c&&o==="text/plain"&&(d=c,c=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sh(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function m1(i,e,n){let r=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&gi(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function p1(i,e){if(i.id in e)return e[i.id];try{let n=await import(i.module);return e[i.id]=n,n}catch(n){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function g1(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function v1(i,e,n){let r=await Promise.all(i.map(async o=>{let c=e.routes[o.route.id];if(c){let d=await p1(c,n);return d.links?d.links():[]}return[]}));return T1(r.flat(1).filter(g1).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function cy(i,e,n,r,o,c){let d=(f,h)=>n[h]?f.route.id!==n[h].route.id:!0,u=(f,h)=>n[h].pathname!==f.pathname||n[h].route.path?.endsWith("*")&&n[h].params["*"]!==f.params["*"];return c==="assets"?e.filter((f,h)=>d(f,h)||u(f,h)):c==="data"?e.filter((f,h)=>{let g=r.routes[f.route.id];if(!g||!g.hasLoader)return!1;if(d(f,h)||u(f,h))return!0;if(f.route.shouldRevalidate){let v=f.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function y1(i,e,{includeHydrateFallback:n}={}){return b1(i.map(r=>{let o=e.routes[r.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function b1(i){return[...new Set(i)]}function S1(i){let e={},n=Object.keys(i).sort();for(let r of n)e[r]=i[r];return e}function T1(i,e){let n=new Set;return new Set(e),i.reduce((r,o)=>{let c=JSON.stringify(S1(o));return n.has(c)||(n.add(c),r.push({key:c,link:o})),r},[])}function G0(){let i=A.useContext(jr);return sh(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function C1(){let i=A.useContext(fl);return sh(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var oh=A.createContext(void 0);oh.displayName="FrameworkContext";function Y0(){let i=A.useContext(oh);return sh(i,"You must render this element inside a <HydratedRouter> element"),i}function k1(i,e){let n=A.useContext(oh),[r,o]=A.useState(!1),[c,d]=A.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:h,onMouseLeave:g,onTouchStart:v}=e,b=A.useRef(null);A.useEffect(()=>{if(i==="render"&&d(!0),i==="viewport"){let C=R=>{R.forEach(B=>{d(B.isIntersecting)})},M=new IntersectionObserver(C,{threshold:.5});return b.current&&M.observe(b.current),()=>{M.disconnect()}}},[i]),A.useEffect(()=>{if(r){let C=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(C)}}},[r]);let T=()=>{o(!0)},_=()=>{o(!1),d(!1)};return n?i!=="intent"?[c,b,{}]:[c,b,{onFocus:Us(u,T),onBlur:Us(f,_),onMouseEnter:Us(h,T),onMouseLeave:Us(g,_),onTouchStart:Us(v,T)}]:[!1,b,{}]}function Us(i,e){return n=>{i&&i(n),n.defaultPrevented||e(n)}}function E1({page:i,...e}){let{router:n}=G0(),r=A.useMemo(()=>M0(n.routes,i,n.basename),[n.routes,i,n.basename]);return r?A.createElement(R1,{page:i,matches:r,...e}):null}function _1(i){let{manifest:e,routeModules:n}=Y0(),[r,o]=A.useState([]);return A.useEffect(()=>{let c=!1;return v1(i,e,n).then(d=>{c||o(d)}),()=>{c=!0}},[i,e,n]),r}function R1({page:i,matches:e,...n}){let r=ia(),{manifest:o,routeModules:c}=Y0(),{basename:d}=G0(),{loaderData:u,matches:f}=C1(),h=A.useMemo(()=>cy(i,e,f,o,r,"data"),[i,e,f,o,r]),g=A.useMemo(()=>cy(i,e,f,o,r,"assets"),[i,e,f,o,r]),v=A.useMemo(()=>{if(i===r.pathname+r.search+r.hash)return[];let _=new Set,C=!1;if(e.forEach(R=>{let B=o.routes[R.route.id];!B||!B.hasLoader||(!h.some(q=>q.route.id===R.route.id)&&R.route.id in u&&c[R.route.id]?.shouldRevalidate||B.hasClientLoader?C=!0:_.add(R.route.id))}),_.size===0)return[];let M=m1(i,d,"data");return C&&_.size>0&&M.searchParams.set("_routes",e.filter(R=>_.has(R.route.id)).map(R=>R.route.id).join(",")),[M.pathname+M.search]},[d,u,r,o,h,e,i,c]),b=A.useMemo(()=>y1(g,o),[g,o]),T=_1(g);return A.createElement(A.Fragment,null,v.map(_=>A.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...n})),b.map(_=>A.createElement("link",{key:_,rel:"modulepreload",href:_,...n})),T.map(({key:_,link:C})=>A.createElement("link",{key:_,nonce:n.nonce,...C})))}function w1(...i){return e=>{i.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var O1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{O1&&(window.__reactRouterVersion="7.11.0")}catch{}function A1({basename:i,children:e,unstable_useTransitions:n,window:r}){let o=A.useRef();o.current==null&&(o.current=lE({window:r,v5Compat:!0}));let c=o.current,[d,u]=A.useState({action:c.action,location:c.location}),f=A.useCallback(h=>{n===!1?u(h):A.startTransition(()=>u(h))},[n]);return A.useLayoutEffect(()=>c.listen(f),[c,f]),A.createElement(a1,{basename:i,children:e,location:d.location,navigationType:d.action,navigator:c,unstable_useTransitions:n})}var K0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,J0=A.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:o,reloadDocument:c,replace:d,state:u,target:f,to:h,preventScrollReset:g,viewTransition:v,unstable_defaultShouldRevalidate:b,...T},_){let{basename:C,unstable_useTransitions:M}=A.useContext(on),R=typeof h=="string"&&K0.test(h),B=U0(h,C);h=B.to;let q=FE(h,{relative:o}),[E,k,D]=k1(r,T),L=P1(h,{replace:d,state:u,target:f,preventScrollReset:g,relative:o,viewTransition:v,unstable_defaultShouldRevalidate:b,unstable_useTransitions:M});function K(Q){e&&e(Q),Q.defaultPrevented||L(Q)}let G=A.createElement("a",{...T,...D,href:B.absoluteURL||q,onClick:B.isExternal||c?e:K,ref:w1(_,k),target:f,"data-discover":!R&&n==="render"?"true":void 0});return E&&!R?A.createElement(A.Fragment,null,G,A.createElement(E1,{page:q})):G});J0.displayName="Link";var D1=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:o=!1,style:c,to:d,viewTransition:u,children:f,...h},g){let v=oo(d,{relative:h.relative}),b=ia(),T=A.useContext(fl),{navigator:_,basename:C}=A.useContext(on),M=T!=null&&j1(v)&&u===!0,R=_.encodeLocation?_.encodeLocation(v).pathname:v.pathname,B=b.pathname,q=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(B=B.toLowerCase(),q=q?q.toLowerCase():null,R=R.toLowerCase()),q&&C&&(q=gi(q,C)||q);const E=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let k=B===R||!o&&B.startsWith(R)&&B.charAt(E)==="/",D=q!=null&&(q===R||!o&&q.startsWith(R)&&q.charAt(R.length)==="/"),L={isActive:k,isPending:D,isTransitioning:M},K=k?e:void 0,G;typeof r=="function"?G=r(L):G=[r,k?"active":null,D?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let Q=typeof c=="function"?c(L):c;return A.createElement(J0,{...h,"aria-current":K,className:G,ref:g,style:Q,to:d,viewTransition:u},typeof f=="function"?f(L):f)});D1.displayName="NavLink";var M1=A.forwardRef(({discover:i="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:o,state:c,method:d=Lc,action:u,onSubmit:f,relative:h,preventScrollReset:g,viewTransition:v,unstable_defaultShouldRevalidate:b,...T},_)=>{let{unstable_useTransitions:C}=A.useContext(on),M=U1(),R=I1(u,{relative:h}),B=d.toLowerCase()==="get"?"get":"post",q=typeof u=="string"&&K0.test(u),E=k=>{if(f&&f(k),k.defaultPrevented)return;k.preventDefault();let D=k.nativeEvent.submitter,L=D?.getAttribute("formmethod")||d,K=()=>M(D||k.currentTarget,{fetcherKey:e,method:L,navigate:n,replace:o,state:c,relative:h,preventScrollReset:g,viewTransition:v,unstable_defaultShouldRevalidate:b});C&&n!==!1?A.startTransition(()=>K()):K()};return A.createElement("form",{ref:_,method:B,action:R,onSubmit:r?f:E,...T,"data-discover":!q&&i==="render"?"true":void 0})});M1.displayName="Form";function x1(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Q0(i){let e=A.useContext(jr);return et(e,x1(i)),e}function P1(i,{target:e,replace:n,state:r,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:u,unstable_useTransitions:f}={}){let h=ih(),g=ia(),v=oo(i,{relative:c});return A.useCallback(b=>{if(u1(b,e)){b.preventDefault();let T=n!==void 0?n:Qs(g)===Qs(v),_=()=>h(i,{replace:T,state:r,preventScrollReset:o,relative:c,viewTransition:d,unstable_defaultShouldRevalidate:u});f?A.startTransition(()=>_()):_()}},[g,h,v,n,r,e,i,o,c,d,u,f])}var N1=0,L1=()=>`__${String(++N1)}__`;function U1(){let{router:i}=Q0("useSubmit"),{basename:e}=A.useContext(on),n=e1(),r=i.fetch,o=i.navigate;return A.useCallback(async(c,d={})=>{let{action:u,method:f,encType:h,formData:g,body:v}=h1(c,e);if(d.navigate===!1){let b=d.fetcherKey||L1();await r(b,n,d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:g,body:v,formMethod:d.method||f,formEncType:d.encType||h,flushSync:d.flushSync})}else await o(d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:g,body:v,formMethod:d.method||f,formEncType:d.encType||h,replace:d.replace,state:d.state,fromRouteId:n,flushSync:d.flushSync,viewTransition:d.viewTransition})},[r,o,e,n])}function I1(i,{relative:e}={}){let{basename:n}=A.useContext(on),r=A.useContext(xn);et(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),c={...oo(i||".",{relative:e})},d=ia();if(i==null){c.search=d.search;let u=new URLSearchParams(c.search),f=u.getAll("index");if(f.some(g=>g==="")){u.delete("index"),f.filter(v=>v).forEach(v=>u.append("index",v));let g=u.toString();c.search=g?`?${g}`:""}}return(!i||i===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(c.pathname=c.pathname==="/"?n:pi([n,c.pathname])),Qs(c)}function j1(i,{relative:e}={}){let n=A.useContext(j0);et(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Q0("useViewTransitionState"),o=oo(i,{relative:e});if(!n.isTransitioning)return!1;let c=gi(n.currentLocation.pathname,r)||n.currentLocation.pathname,d=gi(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Zc(o.pathname,d)!=null||Zc(o.pathname,c)!=null}var ly={};function B1(i,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in i)){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(i,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(i)}var z1=Object.defineProperty,q1=(i,e,n)=>e in i?z1(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n,uy=(i,e,n)=>q1(i,typeof e!="symbol"?e+"":e,n);class Ut{constructor(){uy(this,"_locking"),uy(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(o=>e=()=>{this._locks-=1,o()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function rt(i,e){if(!i)throw new Error(e)}const V1=34028234663852886e22,F1=-34028234663852886e22,H1=4294967295,G1=2147483647,Y1=-2147483648;function Ic(i){if(typeof i!="number")throw new Error("invalid int 32: "+typeof i);if(!Number.isInteger(i)||i>G1||i<Y1)throw new Error("invalid int 32: "+i)}function Rf(i){if(typeof i!="number")throw new Error("invalid uint 32: "+typeof i);if(!Number.isInteger(i)||i>H1||i<0)throw new Error("invalid uint 32: "+i)}function X0(i){if(typeof i!="number")throw new Error("invalid float 32: "+typeof i);if(Number.isFinite(i)&&(i>V1||i<F1))throw new Error("invalid float 32: "+i)}const Z0=Symbol("@bufbuild/protobuf/enum-type");function K1(i){const e=i[Z0];return rt(e,"missing enum type on enum object"),e}function W0(i,e,n,r){i[Z0]=$0(e,n.map(o=>({no:o.no,name:o.name,localName:i[o.no]})))}function $0(i,e,n){const r=Object.create(null),o=Object.create(null),c=[];for(const d of e){const u=eb(d);c.push(u),r[d.name]=u,o[d.no]=u}return{typeName:i,values:c,findName(d){return r[d]},findNumber(d){return o[d]}}}function J1(i,e,n){const r={};for(const o of e){const c=eb(o);r[c.localName]=c.no,r[c.no]=c.localName}return W0(r,i,e),r}function eb(i){return"localName"in i?i:Object.assign(Object.assign({},i),{localName:i.name})}class ch{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),o=r.runtime.bin,c=o.makeReadOptions(n);return o.readMessage(this,c.readerFactory(e),e.byteLength,c),this}fromJson(e,n){const r=this.getType(),o=r.runtime.json,c=o.makeReadOptions(n);return o.readMessage(r,e,c,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(o){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(o instanceof Error?o.message:String(o)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,o=r.makeWriteOptions(e),c=o.writerFactory();return r.writeMessage(this,c,o),c.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,o=r.makeWriteOptions(e);return r.writeMessage(this,o)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e?.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Q1(i,e,n,r){var o;const c=(o=r?.localName)!==null&&o!==void 0?o:e.substring(e.lastIndexOf(".")+1),d={[c]:function(u){i.util.initFields(this),i.util.initPartial(u,this)}}[c];return Object.setPrototypeOf(d.prototype,new ch),Object.assign(d,{runtime:i,typeName:e,fields:i.util.newFieldList(n),fromBinary(u,f){return new d().fromBinary(u,f)},fromJson(u,f){return new d().fromJson(u,f)},fromJsonString(u,f){return new d().fromJsonString(u,f)},equals(u,f){return i.util.equals(d,u,f)}}),d}function X1(){let i=0,e=0;for(let r=0;r<28;r+=7){let o=this.buf[this.pos++];if(i|=(o&127)<<r,(o&128)==0)return this.assertBounds(),[i,e]}let n=this.buf[this.pos++];if(i|=(n&15)<<28,e=(n&112)>>4,(n&128)==0)return this.assertBounds(),[i,e];for(let r=3;r<=31;r+=7){let o=this.buf[this.pos++];if(e|=(o&127)<<r,(o&128)==0)return this.assertBounds(),[i,e]}throw new Error("invalid varint")}function $d(i,e,n){for(let c=0;c<28;c=c+7){const d=i>>>c,u=!(!(d>>>7)&&e==0),f=(u?d|128:d)&255;if(n.push(f),!u)return}const r=i>>>28&15|(e&7)<<4,o=e>>3!=0;if(n.push((o?r|128:r)&255),!!o){for(let c=3;c<31;c=c+7){const d=e>>>c,u=!!(d>>>7),f=(u?d|128:d)&255;if(n.push(f),!u)return}n.push(e>>>31&1)}}const jc=4294967296;function dy(i){const e=i[0]==="-";e&&(i=i.slice(1));const n=1e6;let r=0,o=0;function c(d,u){const f=Number(i.slice(d,u));o*=n,r=r*n+f,r>=jc&&(o=o+(r/jc|0),r=r%jc)}return c(-24,-18),c(-18,-12),c(-12,-6),c(-6),e?nb(r,o):lh(r,o)}function Z1(i,e){let n=lh(i,e);const r=n.hi&2147483648;r&&(n=nb(n.lo,n.hi));const o=tb(n.lo,n.hi);return r?"-"+o:o}function tb(i,e){if({lo:i,hi:e}=W1(i,e),e<=2097151)return String(jc*e+i);const n=i&16777215,r=(i>>>24|e<<8)&16777215,o=e>>16&65535;let c=n+r*6777216+o*6710656,d=r+o*8147497,u=o*2;const f=1e7;return c>=f&&(d+=Math.floor(c/f),c%=f),d>=f&&(u+=Math.floor(d/f),d%=f),u.toString()+fy(d)+fy(c)}function W1(i,e){return{lo:i>>>0,hi:e>>>0}}function lh(i,e){return{lo:i|0,hi:e|0}}function nb(i,e){return e=~e,i?i=~i+1:e+=1,lh(i,e)}const fy=i=>{const e=String(i);return"0000000".slice(e.length)+e};function hy(i,e){if(i>=0){for(;i>127;)e.push(i&127|128),i=i>>>7;e.push(i)}else{for(let n=0;n<9;n++)e.push(i&127|128),i=i>>7;e.push(1)}}function $1(){let i=this.buf[this.pos++],e=i&127;if((i&128)==0)return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<7,(i&128)==0)return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<14,(i&128)==0)return this.assertBounds(),e;if(i=this.buf[this.pos++],e|=(i&127)<<21,(i&128)==0)return this.assertBounds(),e;i=this.buf[this.pos++],e|=(i&15)<<28;for(let n=5;(i&128)!==0&&n<10;n++)i=this.buf[this.pos++];if((i&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function e_(){const i=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof i.getBigInt64=="function"&&typeof i.getBigUint64=="function"&&typeof i.setBigInt64=="function"&&typeof i.setBigUint64=="function"&&(typeof process!="object"||typeof ly!="object"||ly.BUF_BIGINT_DISABLE!=="1")){const o=BigInt("-9223372036854775808"),c=BigInt("9223372036854775807"),d=BigInt("0"),u=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(f){const h=typeof f=="bigint"?f:BigInt(f);if(h>c||h<o)throw new Error("int64 invalid: ".concat(f));return h},uParse(f){const h=typeof f=="bigint"?f:BigInt(f);if(h>u||h<d)throw new Error("uint64 invalid: ".concat(f));return h},enc(f){return i.setBigInt64(0,this.parse(f),!0),{lo:i.getInt32(0,!0),hi:i.getInt32(4,!0)}},uEnc(f){return i.setBigInt64(0,this.uParse(f),!0),{lo:i.getInt32(0,!0),hi:i.getInt32(4,!0)}},dec(f,h){return i.setInt32(0,f,!0),i.setInt32(4,h,!0),i.getBigInt64(0,!0)},uDec(f,h){return i.setInt32(0,f,!0),i.setInt32(4,h,!0),i.getBigUint64(0,!0)}}}const n=o=>rt(/^-?[0-9]+$/.test(o),"int64 invalid: ".concat(o)),r=o=>rt(/^[0-9]+$/.test(o),"uint64 invalid: ".concat(o));return{zero:"0",supported:!1,parse(o){return typeof o!="string"&&(o=o.toString()),n(o),o},uParse(o){return typeof o!="string"&&(o=o.toString()),r(o),o},enc(o){return typeof o!="string"&&(o=o.toString()),n(o),dy(o)},uEnc(o){return typeof o!="string"&&(o=o.toString()),r(o),dy(o)},dec(o,c){return Z1(o,c)},uDec(o,c){return tb(o,c)}}}const $e=e_();var te;(function(i){i[i.DOUBLE=1]="DOUBLE",i[i.FLOAT=2]="FLOAT",i[i.INT64=3]="INT64",i[i.UINT64=4]="UINT64",i[i.INT32=5]="INT32",i[i.FIXED64=6]="FIXED64",i[i.FIXED32=7]="FIXED32",i[i.BOOL=8]="BOOL",i[i.STRING=9]="STRING",i[i.BYTES=12]="BYTES",i[i.UINT32=13]="UINT32",i[i.SFIXED32=15]="SFIXED32",i[i.SFIXED64=16]="SFIXED64",i[i.SINT32=17]="SINT32",i[i.SINT64=18]="SINT64"})(te||(te={}));var ea;(function(i){i[i.BIGINT=0]="BIGINT",i[i.STRING=1]="STRING"})(ea||(ea={}));function Yi(i,e,n){if(e===n)return!0;if(i==te.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(i){case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return e==n}return!1}function xr(i,e){switch(i){case te.BOOL:return!1;case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return e==0?$e.zero:"0";case te.DOUBLE:case te.FLOAT:return 0;case te.BYTES:return new Uint8Array(0);case te.STRING:return"";default:return 0}}function ib(i,e){switch(i){case te.BOOL:return e===!1;case te.STRING:return e==="";case te.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var ut;(function(i){i[i.Varint=0]="Varint",i[i.Bit64=1]="Bit64",i[i.LengthDelimited=2]="LengthDelimited",i[i.StartGroup=3]="StartGroup",i[i.EndGroup=4]="EndGroup",i[i.Bit32=5]="Bit32"})(ut||(ut={}));class t_{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let o=0;o<this.chunks.length;o++)e+=this.chunks[o].length;let n=new Uint8Array(e),r=0;for(let o=0;o<this.chunks.length;o++)n.set(this.chunks[o],r),r+=this.chunks[o].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Rf(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ic(e),hy(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){X0(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Rf(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Ic(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Ic(e),e=(e<<1^e>>31)>>>0,hy(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),o=$e.enc(e);return r.setInt32(0,o.lo,!0),r.setInt32(4,o.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),o=$e.uEnc(e);return r.setInt32(0,o.lo,!0),r.setInt32(4,o.hi,!0),this.raw(n)}int64(e){let n=$e.enc(e);return $d(n.lo,n.hi,this.buf),this}sint64(e){let n=$e.enc(e),r=n.hi>>31,o=n.lo<<1^r,c=(n.hi<<1|n.lo>>>31)^r;return $d(o,c,this.buf),this}uint64(e){let n=$e.uEnc(e);return $d(n.lo,n.hi,this.buf),this}}class n_{constructor(e,n){this.varint64=X1,this.uint32=$1,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e,n){let r=this.pos;switch(e){case ut.Varint:for(;this.buf[this.pos++]&128;);break;case ut.Bit64:this.pos+=4;case ut.Bit32:this.pos+=4;break;case ut.LengthDelimited:let o=this.uint32();this.pos+=o;break;case ut.StartGroup:for(;;){const[c,d]=this.tag();if(d===ut.EndGroup){if(n!==void 0&&c!==n)throw new Error("invalid end group tag");break}this.skip(d,c)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return $e.dec(...this.varint64())}uint64(){return $e.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,$e.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return $e.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return $e.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function i_(i,e,n,r){let o;return{typeName:e,extendee:n,get field(){if(!o){const c=typeof r=="function"?r():r;c.name=e.split(".").pop(),c.jsonName="[".concat(e,"]"),o=i.util.newFieldList([c]).list()[0]}return o},runtime:i}}function ab(i){const e=i.field.localName,n=Object.create(null);return n[e]=a_(i),[n,()=>n[e]]}function a_(i){const e=i.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return xr(e.T,e.L);case"message":const n=e.T,r=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function r_(i,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=i.length-1;n>=0;--n)if(i[n].no==e.no)return[i[n]];return[]}return i.filter(n=>n.no===e.no)}let di="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),ml=[];for(let i=0;i<di.length;i++)ml[di[i].charCodeAt(0)]=i;ml[45]=di.indexOf("+");ml[95]=di.indexOf("/");const rb={dec(i){let e=i.length*3/4;i[i.length-2]=="="?e-=2:i[i.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,o=0,c,d=0;for(let u=0;u<i.length;u++){if(c=ml[i.charCodeAt(u)],c===void 0)switch(i[u]){case"=":o=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:d=c,o=1;break;case 1:n[r++]=d<<2|(c&48)>>4,d=c,o=2;break;case 2:n[r++]=(d&15)<<4|(c&60)>>2,d=c,o=3;break;case 3:n[r++]=(d&3)<<6|c,o=0;break}}if(o==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(i){let e="",n=0,r,o=0;for(let c=0;c<i.length;c++)switch(r=i[c],n){case 0:e+=di[r>>2],o=(r&3)<<4,n=1;break;case 1:e+=di[o|r>>4],o=(r&15)<<2,n=2;break;case 2:e+=di[o|r>>6],e+=di[r&63],n=0;break}return n&&(e+=di[o],e+="=",n==1&&(e+="=")),e}};function s_(i,e,n){ob(e,i);const r=e.runtime.bin.makeReadOptions(n),o=r_(i.getType().runtime.bin.listUnknownFields(i),e.field),[c,d]=ab(e);for(const u of o)e.runtime.bin.readField(c,r.readerFactory(u.data),e.field,u.wireType,r);return d()}function o_(i,e,n,r){ob(e,i);const o=e.runtime.bin.makeReadOptions(r),c=e.runtime.bin.makeWriteOptions(r);if(sb(i,e)){const h=i.getType().runtime.bin.listUnknownFields(i).filter(g=>g.no!=e.field.no);i.getType().runtime.bin.discardUnknownFields(i);for(const g of h)i.getType().runtime.bin.onUnknownField(i,g.no,g.wireType,g.data)}const d=c.writerFactory();let u=e.field;!u.opt&&!u.repeated&&(u.kind=="enum"||u.kind=="scalar")&&(u=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(u,n,d,c);const f=o.readerFactory(d.finish());for(;f.pos<f.len;){const[h,g]=f.tag(),v=f.skip(g,h);i.getType().runtime.bin.onUnknownField(i,h,g,v)}}function sb(i,e){const n=i.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(i).find(r=>r.no==e.field.no)}function ob(i,e){rt(i.extendee.typeName==e.getType().typeName,"extension ".concat(i.typeName," can only be applied to message ").concat(i.extendee.typeName))}function cb(i,e){const n=i.localName;if(i.repeated)return e[n].length>0;if(i.oneof)return e[i.oneof.localName].case===n;switch(i.kind){case"enum":case"scalar":return i.opt||i.req?e[n]!==void 0:i.kind=="enum"?e[n]!==i.T.values[0].no:!ib(i.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function my(i,e){const n=i.localName,r=!i.opt&&!i.req;if(i.repeated)e[n]=[];else if(i.oneof)e[i.oneof.localName]={case:void 0};else switch(i.kind){case"map":e[n]={};break;case"enum":e[n]=r?i.T.values[0].no:void 0;break;case"scalar":e[n]=r?xr(i.T,i.L):void 0;break;case"message":e[n]=void 0;break}}function fi(i,e){if(i===null||typeof i!="object"||!Object.getOwnPropertyNames(ch.prototype).every(r=>r in i&&typeof i[r]=="function"))return!1;const n=i.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function lb(i,e){return fi(e)||!i.fieldWrapper?e:i.fieldWrapper.wrapField(e)}te.DOUBLE,te.FLOAT,te.INT64,te.UINT64,te.INT32,te.UINT32,te.BOOL,te.STRING,te.BYTES;const py={ignoreUnknownFields:!1},gy={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function c_(i){return i?Object.assign(Object.assign({},py),i):py}function l_(i){return i?Object.assign(Object.assign({},gy),i):gy}const Wc=Symbol(),Bc=Symbol();function u_(){return{makeReadOptions:c_,makeWriteOptions:l_,readMessage(i,e,n,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(i.typeName," from JSON: ").concat(jn(e)));r=r??new i;const o=new Map,c=n.typeRegistry;for(const[d,u]of Object.entries(e)){const f=i.fields.findJsonName(d);if(f){if(f.oneof){if(u===null&&f.kind=="scalar")continue;const h=o.get(f.oneof);if(h!==void 0)throw new Error("cannot decode message ".concat(i.typeName,' from JSON: multiple keys for oneof "').concat(f.oneof.name,'" present: "').concat(h,'", "').concat(d,'"'));o.set(f.oneof,d)}vy(r,u,f,n,i)}else{let h=!1;if(c?.findExtension&&d.startsWith("[")&&d.endsWith("]")){const g=c.findExtension(d.substring(1,d.length-1));if(g&&g.extendee.typeName==i.typeName){h=!0;const[v,b]=ab(g);vy(v,u,g.field,n,g),o_(r,g,b(),n)}}if(!h&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(i.typeName,' from JSON: key "').concat(d,'" is unknown'))}}return r},writeMessage(i,e){const n=i.getType(),r={};let o;try{for(o of n.fields.byNumber()){if(!cb(o,i)){if(o.req)throw"required field not set";if(!e.emitDefaultValues||!f_(o))continue}const d=o.oneof?i[o.oneof.localName].value:i[o.localName],u=yy(o,d,e);u!==void 0&&(r[e.useProtoFieldName?o.name:o.jsonName]=u)}const c=e.typeRegistry;if(c?.findExtensionFor)for(const d of n.runtime.bin.listUnknownFields(i)){const u=c.findExtensionFor(n.typeName,d.no);if(u&&sb(i,u)){const f=s_(i,u,e),h=yy(u.field,f,e);h!==void 0&&(r[u.field.jsonName]=h)}}}catch(c){const d=o?"cannot encode field ".concat(n.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),u=c instanceof Error?c.message:String(c);throw new Error(d+(u.length>0?": ".concat(u):""))}return r},readScalar(i,e,n){return Gs(i,e,n??ea.BIGINT,!0)},writeScalar(i,e,n){if(e!==void 0&&(n||ib(i,e)))return zc(i,e)},debug:jn}}function jn(i){if(i===null)return"null";switch(typeof i){case"object":return Array.isArray(i)?"array":"object";case"string":return i.length>100?"string":'"'.concat(i.split('"').join('\\"'),'"');default:return String(i)}}function vy(i,e,n,r,o){let c=n.localName;if(n.repeated){if(rt(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(jn(e)));const d=i[c];for(const u of e){if(u===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(jn(u)));switch(n.kind){case"message":d.push(n.T.fromJson(u,r));break;case"enum":const f=ef(n.T,u,r.ignoreUnknownFields,!0);f!==Bc&&d.push(f);break;case"scalar":try{d.push(Gs(n.T,u,n.L,!0))}catch(h){let g="cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(jn(u));throw h instanceof Error&&h.message.length>0&&(g+=": ".concat(h.message)),new Error(g)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(jn(e)));const d=i[c];for(const[u,f]of Object.entries(e)){if(f===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: map value null"));let h;try{h=d_(n.K,u)}catch(g){let v="cannot decode map key for field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(jn(e));throw g instanceof Error&&g.message.length>0&&(v+=": ".concat(g.message)),new Error(v)}switch(n.V.kind){case"message":d[h]=n.V.T.fromJson(f,r);break;case"enum":const g=ef(n.V.T,f,r.ignoreUnknownFields,!0);g!==Bc&&(d[h]=g);break;case"scalar":try{d[h]=Gs(n.V.T,f,ea.BIGINT,!0)}catch(v){let b="cannot decode map value for field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(jn(e));throw v instanceof Error&&v.message.length>0&&(b+=": ".concat(v.message)),new Error(b)}break}}}else switch(n.oneof&&(i=i[n.oneof.localName]={case:c},c="value"),n.kind){case"message":const d=n.T;if(e===null&&d.typeName!="google.protobuf.Value")return;let u=i[c];fi(u)?u.fromJson(e,r):(i[c]=u=d.fromJson(e,r),d.fieldWrapper&&!n.oneof&&(i[c]=d.fieldWrapper.unwrapField(u)));break;case"enum":const f=ef(n.T,e,r.ignoreUnknownFields,!1);switch(f){case Wc:my(n,i);break;case Bc:break;default:i[c]=f;break}break;case"scalar":try{const h=Gs(n.T,e,n.L,!1);h===Wc?my(n,i):i[c]=h}catch(h){let g="cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(jn(e));throw h instanceof Error&&h.message.length>0&&(g+=": ".concat(h.message)),new Error(g)}break}}function d_(i,e){if(i===te.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Gs(i,e,ea.BIGINT,!0).toString()}function Gs(i,e,n,r){if(e===null)return r?xr(i,n):Wc;switch(i){case te.DOUBLE:case te.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return i==te.FLOAT&&X0(o),o;case te.INT32:case te.FIXED32:case te.SFIXED32:case te.SINT32:case te.UINT32:let c;if(typeof e=="number"?c=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(c=Number(e)),c===void 0)break;return i==te.UINT32||i==te.FIXED32?Rf(c):Ic(c),c;case te.INT64:case te.SFIXED64:case te.SINT64:if(typeof e!="number"&&typeof e!="string")break;const d=$e.parse(e);return n?d.toString():d;case te.FIXED64:case te.UINT64:if(typeof e!="number"&&typeof e!="string")break;const u=$e.uParse(e);return n?u.toString():u;case te.BOOL:if(typeof e!="boolean")break;return e;case te.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case te.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return rb.dec(e)}throw new Error}function ef(i,e,n,r){if(e===null)return i.typeName=="google.protobuf.NullValue"?0:r?i.values[0].no:Wc;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const o=i.findName(e);if(o!==void 0)return o.no;if(n)return Bc;break}throw new Error("cannot decode enum ".concat(i.typeName," from JSON: ").concat(jn(e)))}function f_(i){return i.repeated||i.kind=="map"?!0:!(i.oneof||i.kind=="message"||i.opt||i.req)}function yy(i,e,n){if(i.kind=="map"){rt(typeof e=="object"&&e!=null);const r={},o=Object.entries(e);switch(i.V.kind){case"scalar":for(const[d,u]of o)r[d.toString()]=zc(i.V.T,u);break;case"message":for(const[d,u]of o)r[d.toString()]=u.toJson(n);break;case"enum":const c=i.V.T;for(const[d,u]of o)r[d.toString()]=tf(c,u,n.enumAsInteger);break}return n.emitDefaultValues||o.length>0?r:void 0}if(i.repeated){rt(Array.isArray(e));const r=[];switch(i.kind){case"scalar":for(let o=0;o<e.length;o++)r.push(zc(i.T,e[o]));break;case"enum":for(let o=0;o<e.length;o++)r.push(tf(i.T,e[o],n.enumAsInteger));break;case"message":for(let o=0;o<e.length;o++)r.push(e[o].toJson(n));break}return n.emitDefaultValues||r.length>0?r:void 0}switch(i.kind){case"scalar":return zc(i.T,e);case"enum":return tf(i.T,e,n.enumAsInteger);case"message":return lb(i.T,e).toJson(n)}}function tf(i,e,n){var r;if(rt(typeof e=="number"),i.typeName=="google.protobuf.NullValue")return null;if(n)return e;const o=i.findNumber(e);return(r=o?.name)!==null&&r!==void 0?r:e}function zc(i,e){switch(i){case te.INT32:case te.SFIXED32:case te.SINT32:case te.FIXED32:case te.UINT32:return rt(typeof e=="number"),e;case te.FLOAT:case te.DOUBLE:return rt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case te.STRING:return rt(typeof e=="string"),e;case te.BOOL:return rt(typeof e=="boolean"),e;case te.UINT64:case te.FIXED64:case te.INT64:case te.SFIXED64:case te.SINT64:return rt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case te.BYTES:return rt(e instanceof Uint8Array),rb.enc(e)}}const yr=Symbol("@bufbuild/protobuf/unknown-fields"),by={readUnknownFields:!0,readerFactory:i=>new n_(i)},Sy={writeUnknownFields:!0,writerFactory:()=>new t_};function h_(i){return i?Object.assign(Object.assign({},by),i):by}function m_(i){return i?Object.assign(Object.assign({},Sy),i):Sy}function p_(){return{makeReadOptions:h_,makeWriteOptions:m_,listUnknownFields(i){var e;return(e=i[yr])!==null&&e!==void 0?e:[]},discardUnknownFields(i){delete i[yr]},writeUnknownFields(i,e){const r=i[yr];if(r)for(const o of r)e.tag(o.no,o.wireType).raw(o.data)},onUnknownField(i,e,n,r){const o=i;Array.isArray(o[yr])||(o[yr]=[]),o[yr].push({no:e,wireType:n,data:r})},readMessage(i,e,n,r,o){const c=i.getType(),d=o?e.len:e.pos+n;let u,f;for(;e.pos<d&&([u,f]=e.tag(),!(o===!0&&f==ut.EndGroup));){const h=c.fields.find(u);if(!h){const g=e.skip(f,u);r.readUnknownFields&&this.onUnknownField(i,u,f,g);continue}Ty(i,e,h,f,r)}if(o&&(f!=ut.EndGroup||u!==n))throw new Error("invalid end group tag")},readField:Ty,writeMessage(i,e,n){const r=i.getType();for(const o of r.fields.byNumber()){if(!cb(o,i)){if(o.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(o.name," to binary: required field not set"));continue}const c=o.oneof?i[o.oneof.localName].value:i[o.localName];Cy(o,c,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(i,e),e},writeField(i,e,n,r){e!==void 0&&Cy(i,e,n,r)}}}function Ty(i,e,n,r,o){let{repeated:c,localName:d}=n;switch(n.oneof&&(i=i[n.oneof.localName],i.case!=d&&delete i.value,i.case=d,d="value"),n.kind){case"scalar":case"enum":const u=n.kind=="enum"?te.INT32:n.T;let f=$c;if(n.kind=="scalar"&&n.L>0&&(f=v_),c){let b=i[d];if(r==ut.LengthDelimited&&u!=te.STRING&&u!=te.BYTES){let _=e.uint32()+e.pos;for(;e.pos<_;)b.push(f(e,u))}else b.push(f(e,u))}else i[d]=f(e,u);break;case"message":const h=n.T;c?i[d].push(qc(e,new h,o,n)):fi(i[d])?qc(e,i[d],o,n):(i[d]=qc(e,new h,o,n),h.fieldWrapper&&!n.oneof&&!n.repeated&&(i[d]=h.fieldWrapper.unwrapField(i[d])));break;case"map":let[g,v]=g_(n,e,o);i[d][g]=v;break}}function qc(i,e,n,r){const o=e.getType().runtime.bin,c=r?.delimited;return o.readMessage(e,i,c?r.no:i.uint32(),n,c),e}function g_(i,e,n){const r=e.uint32(),o=e.pos+r;let c,d;for(;e.pos<o;){const[u]=e.tag();switch(u){case 1:c=$c(e,i.K);break;case 2:switch(i.V.kind){case"scalar":d=$c(e,i.V.T);break;case"enum":d=e.int32();break;case"message":d=qc(e,new i.V.T,n,void 0);break}break}}if(c===void 0&&(c=xr(i.K,ea.BIGINT)),typeof c!="string"&&typeof c!="number"&&(c=c.toString()),d===void 0)switch(i.V.kind){case"scalar":d=xr(i.V.T,ea.BIGINT);break;case"enum":d=i.V.T.values[0].no;break;case"message":d=new i.V.T;break}return[c,d]}function v_(i,e){const n=$c(i,e);return typeof n=="bigint"?n.toString():n}function $c(i,e){switch(e){case te.STRING:return i.string();case te.BOOL:return i.bool();case te.DOUBLE:return i.double();case te.FLOAT:return i.float();case te.INT32:return i.int32();case te.INT64:return i.int64();case te.UINT64:return i.uint64();case te.FIXED64:return i.fixed64();case te.BYTES:return i.bytes();case te.FIXED32:return i.fixed32();case te.SFIXED32:return i.sfixed32();case te.SFIXED64:return i.sfixed64();case te.SINT64:return i.sint64();case te.UINT32:return i.uint32();case te.SINT32:return i.sint32()}}function Cy(i,e,n,r){rt(e!==void 0);const o=i.repeated;switch(i.kind){case"scalar":case"enum":let c=i.kind=="enum"?te.INT32:i.T;if(o)if(rt(Array.isArray(e)),i.packed)b_(n,c,i.no,e);else for(const d of e)Ys(n,c,i.no,d);else Ys(n,c,i.no,e);break;case"message":if(o){rt(Array.isArray(e));for(const d of e)ky(n,r,i,d)}else ky(n,r,i,e);break;case"map":rt(typeof e=="object"&&e!=null);for(const[d,u]of Object.entries(e))y_(n,r,i,d,u);break}}function y_(i,e,n,r,o){i.tag(n.no,ut.LengthDelimited),i.fork();let c=r;switch(n.K){case te.INT32:case te.FIXED32:case te.UINT32:case te.SFIXED32:case te.SINT32:c=Number.parseInt(r);break;case te.BOOL:rt(r=="true"||r=="false"),c=r=="true";break}switch(Ys(i,n.K,1,c),n.V.kind){case"scalar":Ys(i,n.V.T,2,o);break;case"enum":Ys(i,te.INT32,2,o);break;case"message":rt(o!==void 0),i.tag(2,ut.LengthDelimited).bytes(o.toBinary(e));break}i.join()}function ky(i,e,n,r){const o=lb(n.T,r);n.delimited?i.tag(n.no,ut.StartGroup).raw(o.toBinary(e)).tag(n.no,ut.EndGroup):i.tag(n.no,ut.LengthDelimited).bytes(o.toBinary(e))}function Ys(i,e,n,r){rt(r!==void 0);let[o,c]=ub(e);i.tag(n,o)[c](r)}function b_(i,e,n,r){if(!r.length)return;i.tag(n,ut.LengthDelimited).fork();let[,o]=ub(e);for(let c=0;c<r.length;c++)i[o](r[c]);i.join()}function ub(i){let e=ut.Varint;switch(i){case te.BYTES:case te.STRING:e=ut.LengthDelimited;break;case te.DOUBLE:case te.FIXED64:case te.SFIXED64:e=ut.Bit64;break;case te.FIXED32:case te.SFIXED32:case te.FLOAT:e=ut.Bit32;break}const n=te[i].toLowerCase();return[e,n]}function S_(){return{setEnumType:W0,initPartial(i,e){if(i===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const o=r.localName,c=e,d=i;if(d[o]!=null)switch(r.kind){case"oneof":const u=d[o].case;if(u===void 0)continue;const f=r.findField(u);let h=d[o].value;f&&f.kind=="message"&&!fi(h,f.T)?h=new f.T(h):f&&f.kind==="scalar"&&f.T===te.BYTES&&(h=Is(h)),c[o]={case:u,value:h};break;case"scalar":case"enum":let g=d[o];r.T===te.BYTES&&(g=r.repeated?g.map(Is):Is(g)),c[o]=g;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===te.BYTES)for(const[T,_]of Object.entries(d[o]))c[o][T]=Is(_);else Object.assign(c[o],d[o]);break;case"message":const b=r.V.T;for(const T of Object.keys(d[o])){let _=d[o][T];b.fieldWrapper||(_=new b(_)),c[o][T]=_}break}break;case"message":const v=r.T;if(r.repeated)c[o]=d[o].map(b=>fi(b,v)?b:new v(b));else{const b=d[o];v.fieldWrapper?v.typeName==="google.protobuf.BytesValue"?c[o]=Is(b):c[o]=b:c[o]=fi(b,v)?b:new v(b)}break}}},equals(i,e,n){return e===n?!0:!e||!n?!1:i.fields.byMember().every(r=>{const o=e[r.localName],c=n[r.localName];if(r.repeated){if(o.length!==c.length)return!1;switch(r.kind){case"message":return o.every((d,u)=>r.T.equals(d,c[u]));case"scalar":return o.every((d,u)=>Yi(r.T,d,c[u]));case"enum":return o.every((d,u)=>Yi(te.INT32,d,c[u]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":let d=o,u=c;return r.T.fieldWrapper&&(d!==void 0&&!fi(d)&&(d=r.T.fieldWrapper.wrapField(d)),u!==void 0&&!fi(u)&&(u=r.T.fieldWrapper.wrapField(u))),r.T.equals(d,u);case"enum":return Yi(te.INT32,o,c);case"scalar":return Yi(r.T,o,c);case"oneof":if(o.case!==c.case)return!1;const f=r.findField(o.case);if(f===void 0)return!0;switch(f.kind){case"message":return f.T.equals(o.value,c.value);case"enum":return Yi(te.INT32,o.value,c.value);case"scalar":return Yi(f.T,o.value,c.value)}throw new Error("oneof cannot contain ".concat(f.kind));case"map":const h=Object.keys(o).concat(Object.keys(c));switch(r.V.kind){case"message":const g=r.V.T;return h.every(b=>g.equals(o[b],c[b]));case"enum":return h.every(b=>Yi(te.INT32,o[b],c[b]));case"scalar":const v=r.V.T;return h.every(b=>Yi(v,o[b],c[b]))}break}})},clone(i){const e=i.getType(),n=new e,r=n;for(const o of e.fields.byMember()){const c=i[o.localName];let d;if(o.repeated)d=c.map(Dc);else if(o.kind=="map"){d=r[o.localName];for(const[u,f]of Object.entries(c))d[u]=Dc(f)}else o.kind=="oneof"?d=o.findField(c.case)?{case:c.case,value:Dc(c.value)}:{case:void 0}:d=Dc(c);r[o.localName]=d}for(const o of e.runtime.bin.listUnknownFields(i))e.runtime.bin.onUnknownField(r,o.no,o.wireType,o.data);return n}}}function Dc(i){if(i===void 0)return i;if(fi(i))return i.clone();if(i instanceof Uint8Array){const e=new Uint8Array(i.byteLength);return e.set(i),e}return i}function Is(i){return i instanceof Uint8Array?i:new Uint8Array(i)}function T_(i,e,n){return{syntax:i,json:u_(),bin:p_(),util:Object.assign(Object.assign({},S_()),{newFieldList:e,initFields:n}),makeMessageType(r,o,c){return Q1(this,r,o,c)},makeEnum:J1,makeEnumType:$0,getEnumType:K1,makeExtension(r,o,c){return i_(this,r,o,c)}}}class C_{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function db(i,e){const n=fb(i);return e?n:O_(w_(n))}function k_(i){return db(i,!1)}const E_=fb;function fb(i){let e=!1;const n=[];for(let r=0;r<i.length;r++){let o=i.charAt(r);switch(o){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(o),e=!1;break;default:e&&(e=!1,o=o.toUpperCase()),n.push(o);break}}return n.join("")}const __=new Set(["constructor","toString","toJSON","valueOf"]),R_=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),hb=i=>"".concat(i,"$"),w_=i=>R_.has(i)?hb(i):i,O_=i=>__.has(i)?hb(i):i;class A_{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=k_(e)}addField(e){rt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function D_(i,e){var n,r,o,c,d,u;const f=[];let h;for(const g of typeof i=="function"?i():i){const v=g;if(v.localName=db(g.name,g.oneof!==void 0),v.jsonName=(n=g.jsonName)!==null&&n!==void 0?n:E_(g.name),v.repeated=(r=g.repeated)!==null&&r!==void 0?r:!1,g.kind=="scalar"&&(v.L=(o=g.L)!==null&&o!==void 0?o:ea.BIGINT),v.delimited=(c=g.delimited)!==null&&c!==void 0?c:!1,v.req=(d=g.req)!==null&&d!==void 0?d:!1,v.opt=(u=g.opt)!==null&&u!==void 0?u:!1,g.packed===void 0&&(v.packed=g.kind=="enum"||g.kind=="scalar"&&g.T!=te.BYTES&&g.T!=te.STRING),g.oneof!==void 0){const b=typeof g.oneof=="string"?g.oneof:g.oneof.name;(!h||h.name!=b)&&(h=new A_(b)),v.oneof=h,h.addField(v)}f.push(v)}return f}const j=T_("proto3",i=>new C_(i,e=>D_(e)),i=>{for(const e of i.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=i;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=xr(e.T,e.L);break}}});class Gt extends ch{constructor(e){super(),this.seconds=$e.zero,this.nanos=0,j.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(j.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const o=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(o))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=$e.parse(o/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const o=(this.nanos+1e9).toString().substring(1);o.substring(3)==="000000"?r="."+o.substring(0,3)+"Z":o.substring(6)==="000"?r="."+o.substring(0,6)+"Z":r="."+o+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Gt.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new Gt({seconds:$e.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new Gt().fromBinary(e,n)}static fromJson(e,n){return new Gt().fromJson(e,n)}static fromJsonString(e,n){return new Gt().fromJsonString(e,n)}static equals(e,n){return j.util.equals(Gt,e,n)}}Gt.runtime=j;Gt.typeName="google.protobuf.Timestamp";Gt.fields=j.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const M_=j.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Gt},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:x_,repeated:!0},{no:5,name:"events",kind:"message",T:N_,repeated:!0}]),x_=j.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:P_,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),P_=j.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Gt},{no:3,name:"value",kind:"scalar",T:2}]),N_=j.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Gt},{no:7,name:"normalized_end_timestamp",kind:"message",T:Gt,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),mb=j.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),wn=j.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),pt=j.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),uh=j.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Fs=j.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),Xs=j.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),Dn=j.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),_a=j.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),L_=j.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),Tt=j.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),pl=j.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:el,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:wb}]),el=j.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),U_=j.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:j.getEnumType(pt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),Oa=j.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:j.getEnumType(kr)},{no:4,name:"tracks",kind:"message",T:Sr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:U_},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:j.getEnumType(Zs)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:j.getEnumType(Dn)},{no:18,name:"kind_details",kind:"enum",T:j.getEnumType(I_),repeated:!0}]),kr=j.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),Zs=j.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),I_=j.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),yt=j.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),j_=j.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Zi,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:j.getEnumType(pb)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Sr=j.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:j.getEnumType(wn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:j.getEnumType(pt)},{no:10,name:"layers",kind:"message",T:Zi,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:j_,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:j.getEnumType(yt)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:wb},{no:19,name:"audio_features",kind:"enum",T:j.getEnumType(Tt),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:j.getEnumType(mb)}]),Zi=j.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:j.getEnumType(uh)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),pb=j.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Lt=j.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:j.getEnumType(ke)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:dh,oneof:"value"},{no:3,name:"speaker",kind:"message",T:B_,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:bb,oneof:"value"},{no:7,name:"transcription",kind:"message",T:z_,oneof:"value"},{no:8,name:"metrics",kind:"message",T:M_,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:tl,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:fh,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:hh,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:mh,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:nl,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:il,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:al,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:gb,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),ke=j.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),gb=j.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:j.getEnumType(yt)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),vb=j.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:dh,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:tl,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:fh,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:hh,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:mh,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:nl,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:il,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:al,oneof:"value"}]),B_=j.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:yb,repeated:!0}]),yb=j.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),dh=j.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),bb=j.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),z_=j.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:q_,repeated:!0}]),q_=j.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),tl=j.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),fh=j.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),hh=j.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),mh=j.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Sb,oneof:"value"}]),Sb=j.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),Tb=j.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),Cb=j.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:j.getEnumType(kb)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),kb=j.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Eb=j.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:j.getEnumType(_b)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),_b=j.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),Rb=j.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Ey},{no:2,name:"screen",kind:"message",T:Ey},{no:3,name:"resume_connection",kind:"enum",T:j.getEnumType(Xs)},{no:4,name:"disabled_codecs",kind:"message",T:V_},{no:5,name:"force_relay",kind:"enum",T:j.getEnumType(Xs)}]),Ey=j.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:j.getEnumType(Xs)}]),V_=j.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:el,repeated:!0},{no:2,name:"publish",kind:"message",T:el,repeated:!0}]),wb=j.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),wf=j.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),Ob=j.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:j.getEnumType(wf)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),Ab=j.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),nl=j.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:j.getEnumType(yt)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:Ob,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:Ab,oneof:"content_header"}],{localName:"DataStream_Header"}),il=j.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),al=j.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),F_=j.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),On=j.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),Of=j.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),H_=j.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),G_=j.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:ta,oneof:"message"},{no:2,name:"answer",kind:"message",T:ta,oneof:"message"},{no:3,name:"trickle",kind:"message",T:gl,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Ws,oneof:"message"},{no:5,name:"mute",kind:"message",T:vl,oneof:"message"},{no:6,name:"subscription",kind:"message",T:yl,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:Db,oneof:"message"},{no:8,name:"leave",kind:"message",T:bl,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:xb,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:Lb,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:bh,oneof:"message"},{no:13,name:"simulate",kind:"message",T:In,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:vh,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:jb,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:gh,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:Mb,oneof:"message"}]),_y=j.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:Y_,oneof:"message"},{no:2,name:"answer",kind:"message",T:ta,oneof:"message"},{no:3,name:"offer",kind:"message",T:ta,oneof:"message"},{no:4,name:"trickle",kind:"message",T:gl,oneof:"message"},{no:5,name:"update",kind:"message",T:Q_,oneof:"message"},{no:6,name:"track_published",kind:"message",T:ph,oneof:"message"},{no:8,name:"leave",kind:"message",T:bl,oneof:"message"},{no:9,name:"mute",kind:"message",T:vl,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:X_,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Z_,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:$_,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:tR,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:iR,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:rR,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:J_,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:K_,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:oR,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:uR,oneof:"message"},{no:22,name:"request_response",kind:"message",T:dR,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:fR,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:sR,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:gR,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:aR,oneof:"message"}]),Af=j.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Zi,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:j.getEnumType(pb)}]),Ws=j.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:j.getEnumType(wn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:j.getEnumType(pt)},{no:9,name:"layers",kind:"message",T:Zi,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Af,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:j.getEnumType(yt)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:j.getEnumType(mb)},{no:17,name:"audio_features",kind:"enum",T:j.getEnumType(Tt),repeated:!0}]),gl=j.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:j.getEnumType(On)},{no:3,name:"final",kind:"scalar",T:8}]),vl=j.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),Y_=j.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:pl},{no:2,name:"participant",kind:"message",T:Oa},{no:3,name:"other_participants",kind:"message",T:Oa,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Pb,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Rb},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Cb},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:el,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),K_=j.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:Pb,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Rb},{no:3,name:"server_info",kind:"message",T:Cb},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),ph=j.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Sr}]),J_=j.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),ta=j.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),Q_=j.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:Oa,repeated:!0}]),yl=j.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Tb,repeated:!0}]),Db=j.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:j.getEnumType(uh)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),gh=j.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:j.getEnumType(Tt),repeated:!0}]),Mb=j.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),bl=j.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:j.getEnumType(Dn)},{no:3,name:"action",kind:"enum",T:j.getEnumType(Er)},{no:4,name:"regions",kind:"message",T:cR}]),Er=j.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),xb=j.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Zi,repeated:!0}]),vh=j.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),Pb=j.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),X_=j.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:yb,repeated:!0}]),Z_=j.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:pl}]),W_=j.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:j.getEnumType(Fs)},{no:3,name:"score",kind:"scalar",T:2}]),$_=j.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:W_,repeated:!0}]),eR=j.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:j.getEnumType(Of)}]),tR=j.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:eR,repeated:!0}]),yh=j.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:j.getEnumType(uh)},{no:2,name:"enabled",kind:"scalar",T:8}]),nR=j.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:yh,repeated:!0}]),iR=j.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:yh,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:nR,repeated:!0}]),aR=j.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:F_,repeated:!0}]),Nb=j.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),Lb=j.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Nb,repeated:!0}]),rR=j.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),sR=j.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:pl},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:Oa},{no:4,name:"other_participants",kind:"message",T:Oa,repeated:!0}]),bh=j.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:ta},{no:2,name:"subscription",kind:"message",T:yl},{no:3,name:"publish_tracks",kind:"message",T:ph,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Ib,repeated:!0},{no:5,name:"offer",kind:"message",T:ta},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:Ub,repeated:!0}]),Ub=j.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),Ib=j.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:j.getEnumType(On)}]),In=j.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:j.getEnumType(H_),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),jb=j.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),oR=j.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),cR=j.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:lR,repeated:!0}]),lR=j.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),uR=j.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:j.getEnumType(L_)}]),dR=j.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:j.getEnumType(Sh)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:gl,oneof:"request"},{no:5,name:"add_track",kind:"message",T:Ws,oneof:"request"},{no:6,name:"mute",kind:"message",T:vl,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:vh,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:gh,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:Mb,oneof:"request"}]),Sh=j.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),fR=j.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),Bb=j.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),hR=j.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:Eb},{no:2,name:"connection_settings",kind:"message",T:Bb},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:Ws,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:ta},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:j.getEnumType(_a)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:bh}]),mR=j.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:j.getEnumType(pR)},{no:2,name:"join_request",kind:"scalar",T:12}]),pR=j.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),gR=j.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function vR(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Vc={exports:{}},yR=Vc.exports,Ry;function bR(){return Ry||(Ry=1,(function(i){(function(e,n){i.exports?i.exports=n():e.log=n()})(yR,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],c={},d=null;function u(C,M){var R=C[M];if(typeof R.bind=="function")return R.bind(C);try{return Function.prototype.bind.call(R,C)}catch{return function(){return Function.prototype.apply.apply(R,[C,arguments])}}}function f(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function h(C){return C==="debug"&&(C="log"),typeof console===n?!1:C==="trace"&&r?f:console[C]!==void 0?u(console,C):console.log!==void 0?u(console,"log"):e}function g(){for(var C=this.getLevel(),M=0;M<o.length;M++){var R=o[M];this[R]=M<C?e:this.methodFactory(R,C,this.name)}if(this.log=this.debug,typeof console===n&&C<this.levels.SILENT)return"No console available for logging"}function v(C){return function(){typeof console!==n&&(g.call(this),this[C].apply(this,arguments))}}function b(C,M,R){return h(C)||v.apply(this,arguments)}function T(C,M){var R=this,B,q,E,k="loglevel";typeof C=="string"?k+=":"+C:typeof C=="symbol"&&(k=void 0);function D(W){var ie=(o[W]||"silent").toUpperCase();if(!(typeof window===n||!k)){try{window.localStorage[k]=ie;return}catch{}try{window.document.cookie=encodeURIComponent(k)+"="+ie+";"}catch{}}}function L(){var W;if(!(typeof window===n||!k)){try{W=window.localStorage[k]}catch{}if(typeof W===n)try{var ie=window.document.cookie,ve=encodeURIComponent(k),Ne=ie.indexOf(ve+"=");Ne!==-1&&(W=/^([^;]+)/.exec(ie.slice(Ne+ve.length+1))[1])}catch{}return R.levels[W]===void 0&&(W=void 0),W}}function K(){if(!(typeof window===n||!k)){try{window.localStorage.removeItem(k)}catch{}try{window.document.cookie=encodeURIComponent(k)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function G(W){var ie=W;if(typeof ie=="string"&&R.levels[ie.toUpperCase()]!==void 0&&(ie=R.levels[ie.toUpperCase()]),typeof ie=="number"&&ie>=0&&ie<=R.levels.SILENT)return ie;throw new TypeError("log.setLevel() called with invalid level: "+W)}R.name=C,R.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},R.methodFactory=M||b,R.getLevel=function(){return E??q??B},R.setLevel=function(W,ie){return E=G(W),ie!==!1&&D(E),g.call(R)},R.setDefaultLevel=function(W){q=G(W),L()||R.setLevel(W,!1)},R.resetLevel=function(){E=null,K(),g.call(R)},R.enableAll=function(W){R.setLevel(R.levels.TRACE,W)},R.disableAll=function(W){R.setLevel(R.levels.SILENT,W)},R.rebuild=function(){if(d!==R&&(B=G(d.getLevel())),g.call(R),d===R)for(var W in c)c[W].rebuild()},B=G(d?d.getLevel():"WARN");var Q=L();Q!=null&&(E=G(Q)),g.call(R)}d=new T,d.getLogger=function(M){if(typeof M!="symbol"&&typeof M!="string"||M==="")throw new TypeError("You must supply a name when creating a logger.");var R=c[M];return R||(R=c[M]=new T(M,d.methodFactory)),R};var _=typeof window!==n?window.log:void 0;return d.noConflict=function(){return typeof window!==n&&window.log===d&&(window.log=_),d},d.getLoggers=function(){return c},d.default=d,d})})(Vc)),Vc.exports}var Sl=bR(),Df;(function(i){i[i.trace=0]="trace",i[i.debug=1]="debug",i[i.info=2]="info",i[i.warn=3]="warn",i[i.error=4]="error",i[i.silent=5]="silent"})(Df||(Df={}));var Mn;(function(i){i.Default="livekit",i.Room="livekit-room",i.TokenSource="livekit-token-source",i.Participant="livekit-participant",i.Track="livekit-track",i.Publication="livekit-track-publication",i.Engine="livekit-engine",i.Signal="livekit-signal",i.PCManager="livekit-pc-manager",i.PCTransport="livekit-pc-transport",i.E2EE="lk-e2ee"})(Mn||(Mn={}));let Te=Sl.getLogger("livekit");Object.values(Mn).map(i=>Sl.getLogger(i));Te.setDefaultLevel(Df.info);function vi(i){const e=Sl.getLogger(i);return e.setDefaultLevel(Te.getLevel()),e}const SR=Sl.getLogger("lk-e2ee"),js=7e3,TR=[0,300,4*300,9*300,16*300,js,js,js,js,js];class CR{constructor(e){this._retryDelays=e!==void 0?[...e]:TR}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function kR(i,e){var n={};for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&e.indexOf(r)<0&&(n[r]=i[r]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(i);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(i,r[o])&&(n[r[o]]=i[r[o]]);return n}function w(i,e,n,r){function o(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function u(g){try{h(r.next(g))}catch(v){d(v)}}function f(g){try{h(r.throw(g))}catch(v){d(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,f)}h((r=r.apply(i,e||[])).next())})}function wy(i){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&i[e],r=0;if(n)return n.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function hi(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],n;return e?e.call(i):(i=typeof wy=="function"?wy(i):i[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(c){n[c]=i[c]&&function(d){return new Promise(function(u,f){d=i[c](d),o(u,f,d.done,d.value)})}}function o(c,d,u,f){Promise.resolve(f).then(function(h){c({value:h,done:u})},d)}}var Mc={exports:{}},Oy;function ER(){if(Oy)return Mc.exports;Oy=1;var i=typeof Reflect=="object"?Reflect:null,e=i&&typeof i.apply=="function"?i.apply:function(k,D,L){return Function.prototype.apply.call(k,D,L)},n;i&&typeof i.ownKeys=="function"?n=i.ownKeys:Object.getOwnPropertySymbols?n=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:n=function(k){return Object.getOwnPropertyNames(k)};function r(E){console&&console.warn&&console.warn(E)}var o=Number.isNaN||function(k){return k!==k};function c(){c.init.call(this)}Mc.exports=c,Mc.exports.once=R,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var d=10;function u(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(E){if(typeof E!="number"||E<0||o(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");d=E}}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||o(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function f(E){return E._maxListeners===void 0?c.defaultMaxListeners:E._maxListeners}c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(k){for(var D=[],L=1;L<arguments.length;L++)D.push(arguments[L]);var K=k==="error",G=this._events;if(G!==void 0)K=K&&G.error===void 0;else if(!K)return!1;if(K){var Q;if(D.length>0&&(Q=D[0]),Q instanceof Error)throw Q;var W=new Error("Unhandled error."+(Q?" ("+Q.message+")":""));throw W.context=Q,W}var ie=G[k];if(ie===void 0)return!1;if(typeof ie=="function")e(ie,this,D);else for(var ve=ie.length,Ne=_(ie,ve),L=0;L<ve;++L)e(Ne[L],this,D);return!0};function h(E,k,D,L){var K,G,Q;if(u(D),G=E._events,G===void 0?(G=E._events=Object.create(null),E._eventsCount=0):(G.newListener!==void 0&&(E.emit("newListener",k,D.listener?D.listener:D),G=E._events),Q=G[k]),Q===void 0)Q=G[k]=D,++E._eventsCount;else if(typeof Q=="function"?Q=G[k]=L?[D,Q]:[Q,D]:L?Q.unshift(D):Q.push(D),K=f(E),K>0&&Q.length>K&&!Q.warned){Q.warned=!0;var W=new Error("Possible EventEmitter memory leak detected. "+Q.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");W.name="MaxListenersExceededWarning",W.emitter=E,W.type=k,W.count=Q.length,r(W)}return E}c.prototype.addListener=function(k,D){return h(this,k,D,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(k,D){return h(this,k,D,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(E,k,D){var L={fired:!1,wrapFn:void 0,target:E,type:k,listener:D},K=g.bind(L);return K.listener=D,L.wrapFn=K,K}c.prototype.once=function(k,D){return u(D),this.on(k,v(this,k,D)),this},c.prototype.prependOnceListener=function(k,D){return u(D),this.prependListener(k,v(this,k,D)),this},c.prototype.removeListener=function(k,D){var L,K,G,Q,W;if(u(D),K=this._events,K===void 0)return this;if(L=K[k],L===void 0)return this;if(L===D||L.listener===D)--this._eventsCount===0?this._events=Object.create(null):(delete K[k],K.removeListener&&this.emit("removeListener",k,L.listener||D));else if(typeof L!="function"){for(G=-1,Q=L.length-1;Q>=0;Q--)if(L[Q]===D||L[Q].listener===D){W=L[Q].listener,G=Q;break}if(G<0)return this;G===0?L.shift():C(L,G),L.length===1&&(K[k]=L[0]),K.removeListener!==void 0&&this.emit("removeListener",k,W||D)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(k){var D,L,K;if(L=this._events,L===void 0)return this;if(L.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):L[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete L[k]),this;if(arguments.length===0){var G=Object.keys(L),Q;for(K=0;K<G.length;++K)Q=G[K],Q!=="removeListener"&&this.removeAllListeners(Q);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(D=L[k],typeof D=="function")this.removeListener(k,D);else if(D!==void 0)for(K=D.length-1;K>=0;K--)this.removeListener(k,D[K]);return this};function b(E,k,D){var L=E._events;if(L===void 0)return[];var K=L[k];return K===void 0?[]:typeof K=="function"?D?[K.listener||K]:[K]:D?M(K):_(K,K.length)}c.prototype.listeners=function(k){return b(this,k,!0)},c.prototype.rawListeners=function(k){return b(this,k,!1)},c.listenerCount=function(E,k){return typeof E.listenerCount=="function"?E.listenerCount(k):T.call(E,k)},c.prototype.listenerCount=T;function T(E){var k=this._events;if(k!==void 0){var D=k[E];if(typeof D=="function")return 1;if(D!==void 0)return D.length}return 0}c.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function _(E,k){for(var D=new Array(k),L=0;L<k;++L)D[L]=E[L];return D}function C(E,k){for(;k+1<E.length;k++)E[k]=E[k+1];E.pop()}function M(E){for(var k=new Array(E.length),D=0;D<k.length;++D)k[D]=E[D].listener||E[D];return k}function R(E,k){return new Promise(function(D,L){function K(Q){E.removeListener(k,G),L(Q)}function G(){typeof E.removeListener=="function"&&E.removeListener("error",K),D([].slice.call(arguments))}q(E,k,G,{once:!0}),k!=="error"&&B(E,K,{once:!0})})}function B(E,k,D){typeof E.on=="function"&&q(E,"error",k,D)}function q(E,k,D,L){if(typeof E.on=="function")L.once?E.once(k,D):E.on(k,D);else if(typeof E.addEventListener=="function")E.addEventListener(k,function K(G){L.once&&E.removeEventListener(k,K),D(G)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return Mc.exports}var Vn=ER();let zb=!0,qb=!0;function Hs(i,e,n){const r=i.match(e);return r&&r.length>=n&&parseFloat(r[n],10)}function xa(i,e,n){if(!i.RTCPeerConnection)return;const r=i.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(d,u){if(d!==e)return o.apply(this,arguments);const f=h=>{const g=n(h);g&&(u.handleEvent?u.handleEvent(g):u(g))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,f),o.apply(this,[d,f])};const c=r.removeEventListener;r.removeEventListener=function(d,u){if(d!==e||!this._eventMap||!this._eventMap[e])return c.apply(this,arguments);if(!this._eventMap[e].has(u))return c.apply(this,arguments);const f=this._eventMap[e].get(u);return this._eventMap[e].delete(u),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,c.apply(this,[d,f])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(d){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),d&&this.addEventListener(e,this["_on"+e]=d)},enumerable:!0,configurable:!0})}function _R(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(zb=i,i?"adapter.js logging disabled":"adapter.js logging enabled")}function RR(i){return typeof i!="boolean"?new Error("Argument type: "+typeof i+". Please use a boolean."):(qb=!i,"adapter.js deprecation warnings "+(i?"disabled":"enabled"))}function Vb(){if(typeof window=="object"){if(zb)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Th(i,e){qb&&console.warn(i+" is deprecated, please use "+e+" instead.")}function wR(i){const e={browser:null,version:null};if(typeof i>"u"||!i.navigator||!i.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=i;if(n.userAgentData&&n.userAgentData.brands){const r=n.userAgentData.brands.find(o=>o.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Hs(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||i.isSecureContext===!1&&i.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Hs(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(i.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Hs(n.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=i.RTCRtpTransceiver&&"currentDirection"in i.RTCRtpTransceiver.prototype,e._safariVersion=Hs(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function Ay(i){return Object.prototype.toString.call(i)==="[object Object]"}function Fb(i){return Ay(i)?Object.keys(i).reduce(function(e,n){const r=Ay(i[n]),o=r?Fb(i[n]):i[n],c=r&&!Object.keys(o).length;return o===void 0||c?e:Object.assign(e,{[n]:o})},{}):i}function Mf(i,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Mf(i,i.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(o=>{Mf(i,i.get(o),n)})}))}function Dy(i,e,n){const r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const c=[];return i.forEach(d=>{d.type==="track"&&d.trackIdentifier===e.id&&c.push(d)}),c.forEach(d=>{i.forEach(u=>{u.type===r&&u.trackId===d.id&&Mf(i,u,o)})}),o}const My=Vb;function Hb(i,e){const n=i&&i.navigator;if(!n.mediaDevices)return;const r=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const f={};return Object.keys(u).forEach(h=>{if(h==="require"||h==="advanced"||h==="mediaSource")return;const g=typeof u[h]=="object"?u[h]:{ideal:u[h]};g.exact!==void 0&&typeof g.exact=="number"&&(g.min=g.max=g.exact);const v=function(b,T){return b?b+T.charAt(0).toUpperCase()+T.slice(1):T==="deviceId"?"sourceId":T};if(g.ideal!==void 0){f.optional=f.optional||[];let b={};typeof g.ideal=="number"?(b[v("min",h)]=g.ideal,f.optional.push(b),b={},b[v("max",h)]=g.ideal,f.optional.push(b)):(b[v("",h)]=g.ideal,f.optional.push(b))}g.exact!==void 0&&typeof g.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[v("",h)]=g.exact):["min","max"].forEach(b=>{g[b]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[v(b,h)]=g[b])})}),u.advanced&&(f.optional=(f.optional||[]).concat(u.advanced)),f},o=function(u,f){if(e.version>=61)return f(u);if(u=JSON.parse(JSON.stringify(u)),u&&typeof u.audio=="object"){const h=function(g,v,b){v in g&&!(b in g)&&(g[b]=g[v],delete g[v])};u=JSON.parse(JSON.stringify(u)),h(u.audio,"autoGainControl","googAutoGainControl"),h(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=r(u.audio)}if(u&&typeof u.video=="object"){let h=u.video.facingMode;h=h&&(typeof h=="object"?h:{ideal:h});const g=e.version<66;if(h&&(h.exact==="user"||h.exact==="environment"||h.ideal==="user"||h.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!g)){delete u.video.facingMode;let v;if(h.exact==="environment"||h.ideal==="environment"?v=["back","rear"]:(h.exact==="user"||h.ideal==="user")&&(v=["front"]),v)return n.mediaDevices.enumerateDevices().then(b=>{b=b.filter(_=>_.kind==="videoinput");let T=b.find(_=>v.some(C=>_.label.toLowerCase().includes(C)));return!T&&b.length&&v.includes("back")&&(T=b[b.length-1]),T&&(u.video.deviceId=h.exact?{exact:T.deviceId}:{ideal:T.deviceId}),u.video=r(u.video),My("chrome: "+JSON.stringify(u)),f(u)})}u.video=r(u.video)}return My("chrome: "+JSON.stringify(u)),f(u)},c=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},d=function(u,f,h){o(u,g=>{n.webkitGetUserMedia(g,f,v=>{h&&h(c(v))})})};if(n.getUserMedia=d.bind(n),n.mediaDevices.getUserMedia){const u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(f){return o(f,h=>u(h).then(g=>{if(h.audio&&!g.getAudioTracks().length||h.video&&!g.getVideoTracks().length)throw g.getTracks().forEach(v=>{v.stop()}),new DOMException("","NotFoundError");return g},g=>Promise.reject(c(g))))}}}function Gb(i){i.MediaStream=i.MediaStream||i.webkitMediaStream}function Yb(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("ontrack"in i.RTCPeerConnection.prototype)){Object.defineProperty(i.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",o=>{let c;i.RTCPeerConnection.prototype.getReceivers?c=this.getReceivers().find(u=>u.track&&u.track.id===o.track.id):c={track:o.track};const d=new Event("track");d.track=o.track,d.receiver=c,d.transceiver={receiver:c},d.streams=[r.stream],this.dispatchEvent(d)}),r.stream.getTracks().forEach(o=>{let c;i.RTCPeerConnection.prototype.getReceivers?c=this.getReceivers().find(u=>u.track&&u.track.id===o.id):c={track:o};const d=new Event("track");d.track=o,d.receiver=c,d.transceiver={receiver:c},d.streams=[r.stream],this.dispatchEvent(d)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else xa(i,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Kb(i){if(typeof i=="object"&&i.RTCPeerConnection&&!("getSenders"in i.RTCPeerConnection.prototype)&&"createDTMFSender"in i.RTCPeerConnection.prototype){const e=function(o,c){return{track:c,get dtmf(){return this._dtmf===void 0&&(c.kind==="audio"?this._dtmf=o.createDTMFSender(c):this._dtmf=null),this._dtmf},_pc:o}};if(!i.RTCPeerConnection.prototype.getSenders){i.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(u,f){let h=o.apply(this,arguments);return h||(h=e(this,u),this._senders.push(h)),h};const c=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(u){c.apply(this,arguments);const f=this._senders.indexOf(u);f!==-1&&this._senders.splice(f,1)}}const n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(c){this._senders=this._senders||[],n.apply(this,[c]),c.getTracks().forEach(d=>{this._senders.push(e(this,d))})};const r=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(c){this._senders=this._senders||[],r.apply(this,[c]),c.getTracks().forEach(d=>{const u=this._senders.find(f=>f.track===d);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if(typeof i=="object"&&i.RTCPeerConnection&&"getSenders"in i.RTCPeerConnection.prototype&&"createDTMFSender"in i.RTCPeerConnection.prototype&&i.RTCRtpSender&&!("dtmf"in i.RTCRtpSender.prototype)){const e=i.RTCPeerConnection.prototype.getSenders;i.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(o=>o._pc=this),r},Object.defineProperty(i.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Jb(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender&&i.RTCRtpReceiver))return;if(!("getStats"in i.RTCRtpSender.prototype)){const n=i.RTCPeerConnection.prototype.getSenders;n&&(i.RTCPeerConnection.prototype.getSenders=function(){const c=n.apply(this,[]);return c.forEach(d=>d._pc=this),c});const r=i.RTCPeerConnection.prototype.addTrack;r&&(i.RTCPeerConnection.prototype.addTrack=function(){const c=r.apply(this,arguments);return c._pc=this,c}),i.RTCRtpSender.prototype.getStats=function(){const c=this;return this._pc.getStats().then(d=>Dy(d,c.track,!0))}}if(!("getStats"in i.RTCRtpReceiver.prototype)){const n=i.RTCPeerConnection.prototype.getReceivers;n&&(i.RTCPeerConnection.prototype.getReceivers=function(){const o=n.apply(this,[]);return o.forEach(c=>c._pc=this),o}),xa(i,"track",r=>(r.receiver._pc=r.srcElement,r)),i.RTCRtpReceiver.prototype.getStats=function(){const o=this;return this._pc.getStats().then(c=>Dy(c,o.track,!1))}}if(!("getStats"in i.RTCRtpSender.prototype&&"getStats"in i.RTCRtpReceiver.prototype))return;const e=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof i.MediaStreamTrack){const r=arguments[0];let o,c,d;return this.getSenders().forEach(u=>{u.track===r&&(o?d=!0:o=u)}),this.getReceivers().forEach(u=>(u.track===r&&(c?d=!0:c=u),u.track===r)),d||o&&c?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):o?o.getStats():c?c.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Qb(i){i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(d=>this._shimmedLocalStreams[d][0])};const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addTrack=function(d,u){if(!u)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=e.apply(this,arguments);return this._shimmedLocalStreams[u.id]?this._shimmedLocalStreams[u.id].indexOf(f)===-1&&this._shimmedLocalStreams[u.id].push(f):this._shimmedLocalStreams[u.id]=[u,f],f};const n=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(d){this._shimmedLocalStreams=this._shimmedLocalStreams||{},d.getTracks().forEach(h=>{if(this.getSenders().find(v=>v.track===h))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();n.apply(this,arguments);const f=this.getSenders().filter(h=>u.indexOf(h)===-1);this._shimmedLocalStreams[d.id]=[d].concat(f)};const r=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[d.id],r.apply(this,arguments)};const o=i.RTCPeerConnection.prototype.removeTrack;i.RTCPeerConnection.prototype.removeTrack=function(d){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},d&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const f=this._shimmedLocalStreams[u].indexOf(d);f!==-1&&this._shimmedLocalStreams[u].splice(f,1),this._shimmedLocalStreams[u].length===1&&delete this._shimmedLocalStreams[u]}),o.apply(this,arguments)}}function Xb(i,e){if(!i.RTCPeerConnection)return;if(i.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Qb(i);const n=i.RTCPeerConnection.prototype.getLocalStreams;i.RTCPeerConnection.prototype.getLocalStreams=function(){const g=n.apply(this);return this._reverseStreams=this._reverseStreams||{},g.map(v=>this._reverseStreams[v.id])};const r=i.RTCPeerConnection.prototype.addStream;i.RTCPeerConnection.prototype.addStream=function(g){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},g.getTracks().forEach(v=>{if(this.getSenders().find(T=>T.track===v))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[g.id]){const v=new i.MediaStream(g.getTracks());this._streams[g.id]=v,this._reverseStreams[v.id]=g,g=v}r.apply(this,[g])};const o=i.RTCPeerConnection.prototype.removeStream;i.RTCPeerConnection.prototype.removeStream=function(g){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[g.id]||g]),delete this._reverseStreams[this._streams[g.id]?this._streams[g.id].id:g.id],delete this._streams[g.id]},i.RTCPeerConnection.prototype.addTrack=function(g,v){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const b=[].slice.call(arguments,1);if(b.length!==1||!b[0].getTracks().find(C=>C===g))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(C=>C.track===g))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const _=this._streams[v.id];if(_)_.addTrack(g),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const C=new i.MediaStream([g]);this._streams[v.id]=C,this._reverseStreams[C.id]=v,this.addStream(C)}return this.getSenders().find(C=>C.track===g)};function c(h,g){let v=g.sdp;return Object.keys(h._reverseStreams||[]).forEach(b=>{const T=h._reverseStreams[b],_=h._streams[T.id];v=v.replace(new RegExp(_.id,"g"),T.id)}),new RTCSessionDescription({type:g.type,sdp:v})}function d(h,g){let v=g.sdp;return Object.keys(h._reverseStreams||[]).forEach(b=>{const T=h._reverseStreams[b],_=h._streams[T.id];v=v.replace(new RegExp(T.id,"g"),_.id)}),new RTCSessionDescription({type:g.type,sdp:v})}["createOffer","createAnswer"].forEach(function(h){const g=i.RTCPeerConnection.prototype[h],v={[h](){const b=arguments;return arguments.length&&typeof arguments[0]=="function"?g.apply(this,[_=>{const C=c(this,_);b[0].apply(null,[C])},_=>{b[1]&&b[1].apply(null,_)},arguments[2]]):g.apply(this,arguments).then(_=>c(this,_))}};i.RTCPeerConnection.prototype[h]=v[h]});const u=i.RTCPeerConnection.prototype.setLocalDescription;i.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?u.apply(this,arguments):(arguments[0]=d(this,arguments[0]),u.apply(this,arguments))};const f=Object.getOwnPropertyDescriptor(i.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(i.RTCPeerConnection.prototype,"localDescription",{get(){const h=f.get.apply(this);return h.type===""?h:c(this,h)}}),i.RTCPeerConnection.prototype.removeTrack=function(g){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!g._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(g._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let b;Object.keys(this._streams).forEach(T=>{this._streams[T].getTracks().find(C=>g.track===C)&&(b=this._streams[T])}),b&&(b.getTracks().length===1?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(g.track),this.dispatchEvent(new Event("negotiationneeded")))}}function xf(i,e){!i.RTCPeerConnection&&i.webkitRTCPeerConnection&&(i.RTCPeerConnection=i.webkitRTCPeerConnection),i.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=i.RTCPeerConnection.prototype[n],o={[n](){return arguments[0]=new(n==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};i.RTCPeerConnection.prototype[n]=o[n]})}function Zb(i,e){xa(i,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var xy=Object.freeze({__proto__:null,fixNegotiationNeeded:Zb,shimAddTrackRemoveTrack:Xb,shimAddTrackRemoveTrackWithNative:Qb,shimGetSendersWithDtmf:Kb,shimGetUserMedia:Hb,shimMediaStream:Gb,shimOnTrack:Yb,shimPeerConnection:xf,shimSenderReceiverGetStats:Jb});function Wb(i,e){const n=i&&i.navigator,r=i&&i.MediaStreamTrack;if(n.getUserMedia=function(o,c,d){Th("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(o).then(c,d)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const o=function(d,u,f){u in d&&!(f in d)&&(d[f]=d[u],delete d[u])},c=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(d){return typeof d=="object"&&typeof d.audio=="object"&&(d=JSON.parse(JSON.stringify(d)),o(d.audio,"autoGainControl","mozAutoGainControl"),o(d.audio,"noiseSuppression","mozNoiseSuppression")),c(d)},r&&r.prototype.getSettings){const d=r.prototype.getSettings;r.prototype.getSettings=function(){const u=d.apply(this,arguments);return o(u,"mozAutoGainControl","autoGainControl"),o(u,"mozNoiseSuppression","noiseSuppression"),u}}if(r&&r.prototype.applyConstraints){const d=r.prototype.applyConstraints;r.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),o(u,"autoGainControl","mozAutoGainControl"),o(u,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[u])}}}}function OR(i,e){i.navigator.mediaDevices&&"getDisplayMedia"in i.navigator.mediaDevices||i.navigator.mediaDevices&&(i.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,i.navigator.mediaDevices.getUserMedia(r)})}function $b(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Pf(i,e){if(typeof i!="object"||!(i.RTCPeerConnection||i.mozRTCPeerConnection))return;!i.RTCPeerConnection&&i.mozRTCPeerConnection&&(i.RTCPeerConnection=i.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const c=i.RTCPeerConnection.prototype[o],d={[o](){return arguments[0]=new(o==="addIceCandidate"?i.RTCIceCandidate:i.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}};i.RTCPeerConnection.prototype[o]=d[o]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=i.RTCPeerConnection.prototype.getStats;i.RTCPeerConnection.prototype.getStats=function(){const[c,d,u]=arguments;return r.apply(this,[c||null]).then(f=>{if(e.version<53&&!d)try{f.forEach(h=>{h.type=n[h.type]||h.type})}catch(h){if(h.name!=="TypeError")throw h;f.forEach((g,v)=>{f.set(v,Object.assign({},g,{type:n[g.type]||g.type}))})}return f}).then(d,u)}}function eS(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpSender.prototype)return;const e=i.RTCPeerConnection.prototype.getSenders;e&&(i.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(c=>c._pc=this),o});const n=i.RTCPeerConnection.prototype.addTrack;n&&(i.RTCPeerConnection.prototype.addTrack=function(){const o=n.apply(this,arguments);return o._pc=this,o}),i.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function tS(i){if(!(typeof i=="object"&&i.RTCPeerConnection&&i.RTCRtpSender)||i.RTCRtpSender&&"getStats"in i.RTCRtpReceiver.prototype)return;const e=i.RTCPeerConnection.prototype.getReceivers;e&&(i.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(o=>o._pc=this),r}),xa(i,"track",n=>(n.receiver._pc=n.srcElement,n)),i.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function nS(i){!i.RTCPeerConnection||"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(n){Th("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function iS(i){i.DataChannel&&!i.RTCDataChannel&&(i.RTCDataChannel=i.DataChannel)}function aS(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.addTransceiver;e&&(i.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const o=r.length>0;o&&r.forEach(d=>{if("rid"in d&&!/^[a-z0-9]{0,16}$/i.test(d.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in d&&!(parseFloat(d.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in d&&!(parseFloat(d.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const c=e.apply(this,arguments);if(o){const{sender:d}=c,u=d.getParameters();(!("encodings"in u)||u.encodings.length===1&&Object.keys(u.encodings[0]).length===0)&&(u.encodings=r,d.sendEncodings=r,this.setParametersPromises.push(d.setParameters(u).then(()=>{delete d.sendEncodings}).catch(()=>{delete d.sendEncodings})))}return c})}function rS(i){if(!(typeof i=="object"&&i.RTCRtpSender))return;const e=i.RTCRtpSender.prototype.getParameters;e&&(i.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function sS(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function oS(i){if(!(typeof i=="object"&&i.RTCPeerConnection))return;const e=i.RTCPeerConnection.prototype.createAnswer;i.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Py=Object.freeze({__proto__:null,shimAddTransceiver:aS,shimCreateAnswer:oS,shimCreateOffer:sS,shimGetDisplayMedia:OR,shimGetParameters:rS,shimGetUserMedia:Wb,shimOnTrack:$b,shimPeerConnection:Pf,shimRTCDataChannel:iS,shimReceiverGetStats:tS,shimRemoveStream:nS,shimSenderGetStats:eS});function cS(i){if(!(typeof i!="object"||!i.RTCPeerConnection)){if("getLocalStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in i.RTCPeerConnection.prototype)){const e=i.RTCPeerConnection.prototype.addTrack;i.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(o=>e.call(this,o,r)),r.getVideoTracks().forEach(o=>e.call(this,o,r))},i.RTCPeerConnection.prototype.addTrack=function(r){for(var o=arguments.length,c=new Array(o>1?o-1:0),d=1;d<o;d++)c[d-1]=arguments[d];return c&&c.forEach(u=>{this._localStreams?this._localStreams.includes(u)||this._localStreams.push(u):this._localStreams=[u]}),e.apply(this,arguments)}}"removeStream"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const o=n.getTracks();this.getSenders().forEach(c=>{o.includes(c.track)&&this.removeTrack(c)})})}}function lS(i){if(!(typeof i!="object"||!i.RTCPeerConnection)&&("getRemoteStreams"in i.RTCPeerConnection.prototype||(i.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in i.RTCPeerConnection.prototype))){Object.defineProperty(i.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const c=new Event("addstream");c.stream=o,this.dispatchEvent(c)})})}});const e=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(o){o.streams.forEach(c=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(c)>=0)return;r._remoteStreams.push(c);const d=new Event("addstream");d.stream=c,r.dispatchEvent(d)})}),e.apply(r,arguments)}}}function uS(i){if(typeof i!="object"||!i.RTCPeerConnection)return;const e=i.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,o=e.setLocalDescription,c=e.setRemoteDescription,d=e.addIceCandidate;e.createOffer=function(h,g){const v=arguments.length>=2?arguments[2]:arguments[0],b=n.apply(this,[v]);return g?(b.then(h,g),Promise.resolve()):b},e.createAnswer=function(h,g){const v=arguments.length>=2?arguments[2]:arguments[0],b=r.apply(this,[v]);return g?(b.then(h,g),Promise.resolve()):b};let u=function(f,h,g){const v=o.apply(this,[f]);return g?(v.then(h,g),Promise.resolve()):v};e.setLocalDescription=u,u=function(f,h,g){const v=c.apply(this,[f]);return g?(v.then(h,g),Promise.resolve()):v},e.setRemoteDescription=u,u=function(f,h,g){const v=d.apply(this,[f]);return g?(v.then(h,g),Promise.resolve()):v},e.addIceCandidate=u}function dS(i){const e=i&&i.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=o=>r(fS(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,o,c){e.mediaDevices.getUserMedia(r).then(o,c)}).bind(e))}function fS(i){return i&&i.video!==void 0?Object.assign({},i,{video:Fb(i.video)}):i}function hS(i){if(!i.RTCPeerConnection)return;const e=i.RTCPeerConnection;i.RTCPeerConnection=function(r,o){if(r&&r.iceServers){const c=[];for(let d=0;d<r.iceServers.length;d++){let u=r.iceServers[d];u.urls===void 0&&u.url?(Th("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,c.push(u)):c.push(r.iceServers[d])}r.iceServers=c}return new e(r,o)},i.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(i.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function mS(i){typeof i=="object"&&i.RTCTrackEvent&&"receiver"in i.RTCTrackEvent.prototype&&!("transceiver"in i.RTCTrackEvent.prototype)&&Object.defineProperty(i.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function pS(i){const e=i.RTCPeerConnection.prototype.createOffer;i.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const o=this.getTransceivers().find(d=>d.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveAudio===!0&&!o&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const c=this.getTransceivers().find(d=>d.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):r.offerToReceiveVideo===!0&&!c&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function gS(i){typeof i!="object"||i.AudioContext||(i.AudioContext=i.webkitAudioContext)}var Ny=Object.freeze({__proto__:null,shimAudioContext:gS,shimCallbacksAPI:uS,shimConstraints:fS,shimCreateOfferLegacy:pS,shimGetUserMedia:dS,shimLocalStreamsAPI:cS,shimRTCIceServerUrls:hS,shimRemoteStreamsAPI:lS,shimTrackEventTransceiver:mS}),nf={exports:{}},Ly;function AR(){return Ly||(Ly=1,(function(i){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((o,c)=>(c>0?"m="+o:o).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(o=>o.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const o={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let c=8;c<r.length;c+=2)switch(r[c]){case"raddr":o.relatedAddress=r[c+1];break;case"rport":o.relatedPort=parseInt(r[c+1],10);break;case"tcptype":o.tcpType=r[c+1];break;case"ufrag":o.ufrag=r[c+1],o.usernameFragment=r[c+1];break;default:o[r[c]]===void 0&&(o[r[c]]=r[c+1]);break}return o},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const o=n.component;o==="rtp"?r.push(1):o==="rtcp"?r.push(2):r.push(o),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const c=n.type;return r.push("typ"),r.push(c),c!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const o={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),o.name=r[0],o.clockRate=parseInt(r[1],10),o.channels=r.length===3?parseInt(r[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const o=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let o;const c=n.substring(n.indexOf(" ")+1).split(";");for(let d=0;d<c.length;d++)o=c[d].trim().split("="),r[o[0].trim()]=o[1];return r},e.writeFmtp=function(n){let r="",o=n.payloadType;if(n.preferredPayloadType!==void 0&&(o=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const c=[];Object.keys(n.parameters).forEach(d=>{n.parameters[d]!==void 0?c.push(d+"="+n.parameters[d]):c.push(d)}),r+="a=fmtp:"+o+" "+c.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",o=n.payloadType;return n.preferredPayloadType!==void 0&&(o=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(c=>{r+="a=rtcp-fb:"+o+" "+c.type+(c.parameter&&c.parameter.length?" "+c.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),o={ssrc:parseInt(n.substring(7,r),10)},c=n.indexOf(":",r);return c>-1?(o.attribute=n.substring(r+1,c),o.value=n.substring(c+1)):o.attribute=n.substring(r+1),o},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(o=>parseInt(o,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let o="a=setup:"+r+`\r
`;return n.fingerprints.forEach(c=>{o+="a=fingerprint:"+c.algorithm+" "+c.value+`\r
`}),o},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const o=e.matchPrefix(n+r,"a=ice-ufrag:")[0],c=e.matchPrefix(n+r,"a=ice-pwd:")[0];return o&&c?{usernameFragment:o.substring(12),password:c.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=e.splitLines(n)[0].split(" ");r.profile=c[2];for(let u=3;u<c.length;u++){const f=c[u],h=e.matchPrefix(n,"a=rtpmap:"+f+" ")[0];if(h){const g=e.parseRtpMap(h),v=e.matchPrefix(n,"a=fmtp:"+f+" ");switch(g.parameters=v.length?e.parseFmtp(v[0]):{},g.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+f+" ").map(e.parseRtcpFb),r.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(g.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(u=>{r.headerExtensions.push(e.parseExtmap(u))});const d=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(u=>{d.forEach(f=>{u.rtcpFeedback.find(g=>g.type===f.type&&g.parameter===f.parameter)||u.rtcpFeedback.push(f)})}),r},e.writeRtpDescription=function(n,r){let o="";o+="m="+n+" ",o+=r.codecs.length>0?"9":"0",o+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",o+=r.codecs.map(d=>d.preferredPayloadType!==void 0?d.preferredPayloadType:d.payloadType).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(d=>{o+=e.writeRtpMap(d),o+=e.writeFmtp(d),o+=e.writeRtcpFb(d)});let c=0;return r.codecs.forEach(d=>{d.maxptime>c&&(c=d.maxptime)}),c>0&&(o+="a=maxptime:"+c+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(d=>{o+=e.writeExtmap(d)}),o},e.parseRtpEncodingParameters=function(n){const r=[],o=e.parseRtpParameters(n),c=o.fecMechanisms.indexOf("RED")!==-1,d=o.fecMechanisms.indexOf("ULPFEC")!==-1,u=e.matchPrefix(n,"a=ssrc:").map(b=>e.parseSsrcMedia(b)).filter(b=>b.attribute==="cname"),f=u.length>0&&u[0].ssrc;let h;const g=e.matchPrefix(n,"a=ssrc-group:FID").map(b=>b.substring(17).split(" ").map(_=>parseInt(_,10)));g.length>0&&g[0].length>1&&g[0][0]===f&&(h=g[0][1]),o.codecs.forEach(b=>{if(b.name.toUpperCase()==="RTX"&&b.parameters.apt){let T={ssrc:f,codecPayloadType:parseInt(b.parameters.apt,10)};f&&h&&(T.rtx={ssrc:h}),r.push(T),c&&(T=JSON.parse(JSON.stringify(T)),T.fec={ssrc:f,mechanism:d?"red+ulpfec":"red"},r.push(T))}}),r.length===0&&f&&r.push({ssrc:f});let v=e.matchPrefix(n,"b=");return v.length&&(v[0].indexOf("b=TIAS:")===0?v=parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?v=parseInt(v[0].substring(5),10)*1e3*.95-2e3*8:v=void 0,r.forEach(b=>{b.maxBitrate=v})),r},e.parseRtcpParameters=function(n){const r={},o=e.matchPrefix(n,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="cname")[0];o&&(r.cname=o.value,r.ssrc=o.ssrc);const c=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=c.length>0,r.compound=c.length===0;const d=e.matchPrefix(n,"a=rtcp-mux");return r.mux=d.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const o=e.matchPrefix(n,"a=msid:");if(o.length===1)return r=o[0].substring(7).split(" "),{stream:r[0],track:r[1]};const c=e.matchPrefix(n,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="msid");if(c.length>0)return r=c[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),o=e.matchPrefix(n,"a=max-message-size:");let c;o.length>0&&(c=parseInt(o[0].substring(19),10)),isNaN(c)&&(c=65536);const d=e.matchPrefix(n,"a=sctp-port:");if(d.length>0)return{port:parseInt(d[0].substring(12),10),protocol:r.fmt,maxMessageSize:c};const u=e.matchPrefix(n,"a=sctpmap:");if(u.length>0){const f=u[0].substring(10).split(" ");return{port:parseInt(f[0],10),protocol:f[1],maxMessageSize:c}}},e.writeSctpDescription=function(n,r){let o=[];return n.protocol!=="DTLS/SCTP"?o=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:o=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&o.push("a=max-message-size:"+r.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,o){let c;const d=r!==void 0?r:2;return n?c=n:c=e.generateSessionId(),`v=0\r
o=`+(o||"thisisadapterortc")+" "+c+" "+d+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const o=e.splitLines(n);for(let c=0;c<o.length;c++)switch(o[c]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[c].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const o=e.splitLines(n)[0].substring(2).split(" ");return{kind:o[0],port:parseInt(o[1],10),protocol:o[2],fmt:o.slice(3).join(" ")}},e.parseOLine=function(n){const o=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:o[0],sessionId:o[1],sessionVersion:parseInt(o[2],10),netType:o[3],addressType:o[4],address:o[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let o=0;o<r.length;o++)if(r[o].length<2||r[o].charAt(1)!=="=")return!1;return!0},i.exports=e})(nf)),nf.exports}var vS=AR(),_r=vR(vS),DR=B1({__proto__:null,default:_r},[vS]);function Fc(i){if(!i.RTCIceCandidate||i.RTCIceCandidate&&"foundation"in i.RTCIceCandidate.prototype)return;const e=i.RTCIceCandidate;i.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const o=new e(r),c=_r.parseCandidate(r.candidate);for(const d in c)d in o||Object.defineProperty(o,d,{value:c[d]});return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new e(r)},i.RTCIceCandidate.prototype=e.prototype,xa(i,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new i.RTCIceCandidate(n.candidate),writable:"false"}),n))}function Nf(i){!i.RTCIceCandidate||i.RTCIceCandidate&&"relayProtocol"in i.RTCIceCandidate.prototype||xa(i,"icecandidate",e=>{if(e.candidate){const n=_r.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Hc(i,e){if(!i.RTCPeerConnection)return;"sctp"in i.RTCPeerConnection.prototype||Object.defineProperty(i.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(u){if(!u||!u.sdp)return!1;const f=_r.splitSections(u.sdp);return f.shift(),f.some(h=>{const g=_r.parseMLine(h);return g&&g.kind==="application"&&g.protocol.indexOf("SCTP")!==-1})},r=function(u){const f=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(f===null||f.length<2)return-1;const h=parseInt(f[1],10);return h!==h?-1:h},o=function(u){let f=65536;return e.browser==="firefox"&&(e.version<57?u===-1?f=16384:f=2147483637:e.version<60?f=e.version===57?65535:65536:f=2147483637),f},c=function(u,f){let h=65536;e.browser==="firefox"&&e.version===57&&(h=65535);const g=_r.matchPrefix(u.sdp,"a=max-message-size:");return g.length>0?h=parseInt(g[0].substring(19),10):e.browser==="firefox"&&f!==-1&&(h=2147483637),h},d=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const f=r(arguments[0]),h=o(f),g=c(arguments[0],f);let v;h===0&&g===0?v=Number.POSITIVE_INFINITY:h===0||g===0?v=Math.max(h,g):v=Math.min(h,g);const b={};Object.defineProperty(b,"maxMessageSize",{get(){return v}}),this._sctp=b}return d.apply(this,arguments)}}function Gc(i){if(!(i.RTCPeerConnection&&"createDataChannel"in i.RTCPeerConnection.prototype))return;function e(r,o){const c=r.send;r.send=function(){const u=arguments[0],f=u.length||u.size||u.byteLength;if(r.readyState==="open"&&o.sctp&&f>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return c.apply(r,arguments)}}const n=i.RTCPeerConnection.prototype.createDataChannel;i.RTCPeerConnection.prototype.createDataChannel=function(){const o=n.apply(this,arguments);return e(o,this),o},xa(i,"datachannel",r=>(e(r.channel,r.target),r))}function Lf(i){if(!i.RTCPeerConnection||"connectionState"in i.RTCPeerConnection.prototype)return;const e=i.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const c=o.target;if(c._lastConnectionState!==c.connectionState){c._lastConnectionState=c.connectionState;const d=new Event("connectionstatechange",o);c.dispatchEvent(d)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Uf(i,e){if(!i.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const n=i.RTCPeerConnection.prototype.setRemoteDescription;i.RTCPeerConnection.prototype.setRemoteDescription=function(o){if(o&&o.sdp&&o.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const c=o.sdp.split(`
`).filter(d=>d.trim()!=="a=extmap-allow-mixed").join(`
`);i.RTCSessionDescription&&o instanceof i.RTCSessionDescription?arguments[0]=new i.RTCSessionDescription({type:o.type,sdp:c}):o.sdp=c}return n.apply(this,arguments)}}function Yc(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const n=i.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(i.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Kc(i,e){if(!(i.RTCPeerConnection&&i.RTCPeerConnection.prototype))return;const n=i.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(i.RTCPeerConnection.prototype.setLocalDescription=function(){let o=arguments[0]||{};if(typeof o!="object"||o.type&&o.sdp)return n.apply(this,arguments);if(o={type:o.type,sdp:o.sdp},!o.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":o.type="offer";break;default:o.type="answer";break}return o.sdp||o.type!=="offer"&&o.type!=="answer"?n.apply(this,[o]):(o.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(d=>n.apply(this,[d]))})}var MR=Object.freeze({__proto__:null,removeExtmapAllowMixed:Uf,shimAddIceCandidateNullOrEmpty:Yc,shimConnectionState:Lf,shimMaxMessageSize:Hc,shimParameterlessSetLocalDescription:Kc,shimRTCIceCandidate:Fc,shimRTCIceCandidateRelayProtocol:Nf,shimSendThrowTypeError:Gc});function xR(){let{window:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Vb,r=wR(i),o={browserDetails:r,commonShim:MR,extractVersion:Hs,disableLog:_R,disableWarnings:RR,sdp:DR};switch(r.browser){case"chrome":if(!xy||!xf||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=xy,Yc(i,r),Kc(i),Hb(i,r),Gb(i),xf(i,r),Yb(i),Xb(i,r),Kb(i),Jb(i),Zb(i,r),Fc(i),Nf(i),Lf(i),Hc(i,r),Gc(i),Uf(i,r);break;case"firefox":if(!Py||!Pf||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=Py,Yc(i,r),Kc(i),Wb(i,r),Pf(i,r),$b(i),nS(i),eS(i),tS(i),iS(i),aS(i),rS(i),sS(i),oS(i),Fc(i),Lf(i),Hc(i,r),Gc(i);break;case"safari":if(!Ny||!e.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=Ny,Yc(i,r),Kc(i),hS(i),pS(i),uS(i),cS(i),lS(i),mS(i),dS(i),gS(i),Fc(i),Nf(i),Hc(i,r),Gc(i),Uf(i,r);break;default:n("Unsupported browser!");break}return o}xR({window:typeof window>"u"?void 0:window});class Yt extends Promise{constructor(e){super(e)}catch(e){return super.catch(e)}static reject(e){return super.reject(e)}static all(e){return super.all(e)}static race(e){return super.race(e)}}const PR=/version\/(\d+(\.?_?\d+)+)/i;let af;function Jt(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(af===void 0||e){const r=NR.find(o=>{let{test:c}=o;return c.test(n)});af=r?.describe(n)}return af}const NR=[{test:/firefox|iceweasel|fxios/i,describe(i){return{name:"Firefox",version:Jc(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,i),os:i.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:rf(i)}}},{test:/chrom|crios|crmo/i,describe(i){return{name:"Chrome",version:Jc(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,i),os:i.toLowerCase().includes("crios")?"iOS":void 0,osVersion:rf(i)}}},{test:/safari|applewebkit/i,describe(i){return{name:"Safari",version:Jc(PR,i),os:i.includes("mobile/")?"iOS":"macOS",osVersion:rf(i)}}}];function Jc(i,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(i);return r&&r.length>=n&&r[n]||""}function rf(i){return i.includes("mac os")?Jc(/\(.+?(\d+_\d+(:?_\d+)?)/,i,1).replace(/_/g,"."):void 0}var LR="2.17.0";const UR=LR,IR=16;class Fn extends Error{constructor(e,n){super(n||"an error has occured"),this.name="LiveKitError",this.code=e}}var Je;(function(i){i[i.NotAllowed=0]="NotAllowed",i[i.ServerUnreachable=1]="ServerUnreachable",i[i.InternalError=2]="InternalError",i[i.Cancelled=3]="Cancelled",i[i.LeaveRequest=4]="LeaveRequest",i[i.Timeout=5]="Timeout",i[i.WebSocket=6]="WebSocket",i[i.ServiceNotFound=7]="ServiceNotFound"})(Je||(Je={}));class he extends Fn{constructor(e,n,r,o){super(1,e),this.name="ConnectionError",this.status=r,this.reason=n,this.context=o,this.reasonName=Je[n]}static notAllowed(e,n,r){return new he(e,Je.NotAllowed,n,r)}static timeout(e){return new he(e,Je.Timeout)}static leaveRequest(e,n){return new he(e,Je.LeaveRequest,void 0,n)}static internal(e,n){return new he(e,Je.InternalError,void 0,n)}static cancelled(e){return new he(e,Je.Cancelled)}static serverUnreachable(e,n){return new he(e,Je.ServerUnreachable,n)}static websocket(e,n,r){return new he(e,Je.WebSocket,n,r)}static serviceNotFound(e,n){return new he(e,Je.ServiceNotFound,void 0,n)}}class Ch extends Fn{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class mi extends Fn{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class jR extends Fn{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class lt extends Fn{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Rr extends Fn{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class Uy extends Fn{constructor(e,n){super(15,e),this.name="PublishTrackError",this.status=n}}class Iy extends Fn{constructor(e,n){super(15,e),this.name="SignalRequestError",this.reason=n,this.reasonName=typeof n=="string"?n:Sh[n]}}var Nt;(function(i){i[i.AlreadyOpened=0]="AlreadyOpened",i[i.AbnormalEnd=1]="AbnormalEnd",i[i.DecodeFailed=2]="DecodeFailed",i[i.LengthExceeded=3]="LengthExceeded",i[i.Incomplete=4]="Incomplete",i[i.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",i[i.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"})(Nt||(Nt={}));class bn extends Fn{constructor(e,n){super(16,e),this.name="DataStreamError",this.reason=n,this.reasonName=Nt[n]}}class br extends Fn{constructor(e){super(18,e),this.name="SignalReconnectError"}}var $s;(function(i){i.PermissionDenied="PermissionDenied",i.NotFound="NotFound",i.DeviceInUse="DeviceInUse",i.Other="Other"})($s||($s={}));(function(i){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?i.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?i.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?i.DeviceInUse:i.Other}i.getFailure=e})($s||($s={}));class Ot{}Ot.setTimeout=function(){return setTimeout(...arguments)};Ot.setInterval=function(){return setInterval(...arguments)};Ot.clearTimeout=function(){return clearTimeout(...arguments)};Ot.clearInterval=function(){return clearInterval(...arguments)};var H;(function(i){i.Connected="connected",i.Reconnecting="reconnecting",i.SignalReconnecting="signalReconnecting",i.Reconnected="reconnected",i.Disconnected="disconnected",i.ConnectionStateChanged="connectionStateChanged",i.Moved="moved",i.MediaDevicesChanged="mediaDevicesChanged",i.ParticipantConnected="participantConnected",i.ParticipantDisconnected="participantDisconnected",i.TrackPublished="trackPublished",i.TrackSubscribed="trackSubscribed",i.TrackSubscriptionFailed="trackSubscriptionFailed",i.TrackUnpublished="trackUnpublished",i.TrackUnsubscribed="trackUnsubscribed",i.TrackMuted="trackMuted",i.TrackUnmuted="trackUnmuted",i.LocalTrackPublished="localTrackPublished",i.LocalTrackUnpublished="localTrackUnpublished",i.LocalAudioSilenceDetected="localAudioSilenceDetected",i.ActiveSpeakersChanged="activeSpeakersChanged",i.ParticipantMetadataChanged="participantMetadataChanged",i.ParticipantNameChanged="participantNameChanged",i.ParticipantAttributesChanged="participantAttributesChanged",i.ParticipantActive="participantActive",i.RoomMetadataChanged="roomMetadataChanged",i.DataReceived="dataReceived",i.SipDTMFReceived="sipDTMFReceived",i.TranscriptionReceived="transcriptionReceived",i.ConnectionQualityChanged="connectionQualityChanged",i.TrackStreamStateChanged="trackStreamStateChanged",i.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",i.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",i.AudioPlaybackStatusChanged="audioPlaybackChanged",i.VideoPlaybackStatusChanged="videoPlaybackChanged",i.MediaDevicesError="mediaDevicesError",i.ParticipantPermissionsChanged="participantPermissionsChanged",i.SignalConnected="signalConnected",i.RecordingStatusChanged="recordingStatusChanged",i.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",i.EncryptionError="encryptionError",i.DCBufferStatusChanged="dcBufferStatusChanged",i.ActiveDeviceChanged="activeDeviceChanged",i.ChatMessage="chatMessage",i.LocalTrackSubscribed="localTrackSubscribed",i.MetricsReceived="metricsReceived"})(H||(H={}));var ee;(function(i){i.TrackPublished="trackPublished",i.TrackSubscribed="trackSubscribed",i.TrackSubscriptionFailed="trackSubscriptionFailed",i.TrackUnpublished="trackUnpublished",i.TrackUnsubscribed="trackUnsubscribed",i.TrackMuted="trackMuted",i.TrackUnmuted="trackUnmuted",i.LocalTrackPublished="localTrackPublished",i.LocalTrackUnpublished="localTrackUnpublished",i.LocalTrackCpuConstrained="localTrackCpuConstrained",i.LocalSenderCreated="localSenderCreated",i.ParticipantMetadataChanged="participantMetadataChanged",i.ParticipantNameChanged="participantNameChanged",i.DataReceived="dataReceived",i.SipDTMFReceived="sipDTMFReceived",i.TranscriptionReceived="transcriptionReceived",i.IsSpeakingChanged="isSpeakingChanged",i.ConnectionQualityChanged="connectionQualityChanged",i.TrackStreamStateChanged="trackStreamStateChanged",i.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",i.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",i.TrackCpuConstrained="trackCpuConstrained",i.MediaDevicesError="mediaDevicesError",i.AudioStreamAcquired="audioStreamAcquired",i.ParticipantPermissionsChanged="participantPermissionsChanged",i.PCTrackAdded="pcTrackAdded",i.AttributesChanged="attributesChanged",i.LocalTrackSubscribed="localTrackSubscribed",i.ChatMessage="chatMessage",i.Active="active"})(ee||(ee={}));var re;(function(i){i.TransportsCreated="transportsCreated",i.Connected="connected",i.Disconnected="disconnected",i.Resuming="resuming",i.Resumed="resumed",i.Restarting="restarting",i.Restarted="restarted",i.SignalResumed="signalResumed",i.SignalRestarted="signalRestarted",i.Closing="closing",i.MediaTrackAdded="mediaTrackAdded",i.ActiveSpeakersUpdate="activeSpeakersUpdate",i.DataPacketReceived="dataPacketReceived",i.RTPVideoMapUpdate="rtpVideoMapUpdate",i.DCBufferStatusChanged="dcBufferStatusChanged",i.ParticipantUpdate="participantUpdate",i.RoomUpdate="roomUpdate",i.SpeakersChanged="speakersChanged",i.StreamStateChanged="streamStateChanged",i.ConnectionQualityUpdate="connectionQualityUpdate",i.SubscriptionError="subscriptionError",i.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",i.RemoteMute="remoteMute",i.SubscribedQualityUpdate="subscribedQualityUpdate",i.LocalTrackUnpublished="localTrackUnpublished",i.LocalTrackSubscribed="localTrackSubscribed",i.Offline="offline",i.SignalRequestResponse="signalRequestResponse",i.SignalConnected="signalConnected",i.RoomMoved="roomMoved"})(re||(re={}));var ne;(function(i){i.Message="message",i.Muted="muted",i.Unmuted="unmuted",i.Restarted="restarted",i.Ended="ended",i.Subscribed="subscribed",i.Unsubscribed="unsubscribed",i.CpuConstrained="cpuConstrained",i.UpdateSettings="updateSettings",i.UpdateSubscription="updateSubscription",i.AudioPlaybackStarted="audioPlaybackStarted",i.AudioPlaybackFailed="audioPlaybackFailed",i.AudioSilenceDetected="audioSilenceDetected",i.VisibilityChanged="visibilityChanged",i.VideoDimensionsChanged="videoDimensionsChanged",i.VideoPlaybackStarted="videoPlaybackStarted",i.VideoPlaybackFailed="videoPlaybackFailed",i.ElementAttached="elementAttached",i.ElementDetached="elementDetached",i.UpstreamPaused="upstreamPaused",i.UpstreamResumed="upstreamResumed",i.SubscriptionPermissionChanged="subscriptionPermissionChanged",i.SubscriptionStatusChanged="subscriptionStatusChanged",i.SubscriptionFailed="subscriptionFailed",i.TrackProcessorUpdate="trackProcessorUpdate",i.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",i.TranscriptionReceived="transcriptionReceived",i.TimeSyncUpdate="timeSyncUpdate",i.PreConnectBufferFlushed="preConnectBufferFlushed"})(ne||(ne={}));function BR(i){return typeof i>"u"?i:typeof structuredClone=="function"?typeof i=="object"&&i!==null?structuredClone(Object.assign({},i)):structuredClone(i):JSON.parse(JSON.stringify(i))}class He{constructor(e,n,r,o,c){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&r!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:r,maxFramerate:o,priority:c};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const zR=["vp8","h264"],qR=["vp8","h264","vp9","av1","h265"];function VR(i){return!!zR.find(e=>e===i)}const FR=VR;var jy;(function(i){i[i.PREFER_REGRESSION=0]="PREFER_REGRESSION",i[i.SIMULCAST=1]="SIMULCAST",i[i.REGRESSION=2]="REGRESSION"})(jy||(jy={}));var If;(function(i){i.telephone={maxBitrate:12e3},i.speech={maxBitrate:24e3},i.music={maxBitrate:48e3},i.musicStereo={maxBitrate:64e3},i.musicHighQuality={maxBitrate:96e3},i.musicHighQualityStereo={maxBitrate:128e3}})(If||(If={}));const eo={h90:new He(160,90,9e4,20),h180:new He(320,180,16e4,20),h216:new He(384,216,18e4,20),h360:new He(640,360,45e4,20),h540:new He(960,540,8e5,25),h720:new He(1280,720,17e5,30),h1080:new He(1920,1080,3e6,30),h1440:new He(2560,1440,5e6,30),h2160:new He(3840,2160,8e6,30)},jf={h120:new He(160,120,7e4,20),h180:new He(240,180,125e3,20),h240:new He(320,240,14e4,20),h360:new He(480,360,33e4,20),h480:new He(640,480,5e5,20),h540:new He(720,540,6e5,25),h720:new He(960,720,13e5,30),h1080:new He(1440,1080,23e5,30),h1440:new He(1920,1440,38e5,30)},kh={h360fps3:new He(640,360,2e5,3,"medium"),h360fps15:new He(640,360,4e5,15,"medium"),h720fps5:new He(1280,720,8e5,5,"medium"),h720fps15:new He(1280,720,15e5,15,"medium"),h720fps30:new He(1280,720,2e6,30,"medium"),h1080fps15:new He(1920,1080,25e5,15,"medium"),h1080fps30:new He(1920,1080,5e6,30,"medium"),original:new He(0,0,7e6,30,"medium")};function yS(i,e,n){var r,o,c,d;const{optionsWithoutProcessor:u,audioProcessor:f,videoProcessor:h}=TS(i??{}),g=e?.processor,v=n?.processor,b=u??{};return b.audio===!0&&(b.audio={}),b.video===!0&&(b.video={}),b.audio&&(Bf(b.audio,e),(r=(c=b.audio).deviceId)!==null&&r!==void 0||(c.deviceId={ideal:"default"}),(f||g)&&(b.audio.processor=f??g)),b.video&&(Bf(b.video,n),(o=(d=b.video).deviceId)!==null&&o!==void 0||(d.deviceId={ideal:"default"}),(h||v)&&(b.video.processor=h??v)),b}function Bf(i,e){return Object.keys(e).forEach(n=>{i[n]===void 0&&(i[n]=e[n])}),i}function Eh(i){var e,n,r,o;const c={};if(i.video)if(typeof i.video=="object"){const d={},u=d,f=i.video;Object.keys(f).forEach(h=>{h==="resolution"?Bf(u,f.resolution):u[h]=f[h]}),c.video=d,(e=(r=c.video).deviceId)!==null&&e!==void 0||(r.deviceId={ideal:"default"})}else c.video=i.video?{deviceId:{ideal:"default"}}:!1;else c.video=!1;return i.audio?typeof i.audio=="object"?(c.audio=i.audio,(n=(o=c.audio).deviceId)!==null&&n!==void 0||(o.deviceId={ideal:"default"})):c.audio={deviceId:{ideal:"default"}}:c.audio=!1,c}function bS(i){return w(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return(function*(){const r=SS();if(r){const o=r.createAnalyser();o.fftSize=2048;const c=o.frequencyBinCount,d=new Uint8Array(c);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(o),yield At(n),o.getByteTimeDomainData(d);const f=d.some(h=>h!==128&&h!==0);return r.close(),!f}return!1})()})}function SS(){var i;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const n=new e({latencyHint:"interactive"});if(n.state==="suspended"&&typeof window<"u"&&(!((i=window.document)===null||i===void 0)&&i.body)){const r=()=>w(this,void 0,void 0,function*(){var o;try{n.state==="suspended"&&(yield n.resume())}catch(c){console.warn("Error trying to auto-resume audio context",c)}finally{(o=window.document.body)===null||o===void 0||o.removeEventListener("click",r)}});n.addEventListener("statechange",()=>{var o;n.state==="closed"&&((o=window.document.body)===null||o===void 0||o.removeEventListener("click",r))}),window.document.body.addEventListener("click",r)}return n}}function HR(i){return i==="audioinput"?J.Source.Microphone:i==="videoinput"?J.Source.Camera:J.Source.Unknown}function zf(i){return i===J.Source.Microphone?"audioinput":i===J.Source.Camera?"videoinput":void 0}function GR(i){var e,n;let r=(e=i.video)!==null&&e!==void 0?e:!0;return i.resolution&&i.resolution.width>0&&i.resolution.height>0&&(r=typeof r=="boolean"?{}:r,Da()?r=Object.assign(Object.assign({},r),{width:{max:i.resolution.width},height:{max:i.resolution.height},frameRate:i.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:i.resolution.width},height:{ideal:i.resolution.height},frameRate:i.resolution.frameRate})),{audio:(n=i.audio)!==null&&n!==void 0?n:!1,video:r,controller:i.controller,selfBrowserSurface:i.selfBrowserSurface,surfaceSwitching:i.surfaceSwitching,systemAudio:i.systemAudio,preferCurrentTab:i.preferCurrentTab}}function Ks(i){return i.split("/")[1].toLowerCase()}function YR(i){const e=[];return i.forEach(n=>{n.track!==void 0&&e.push(new ph({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function Re(i){return"mediaStreamTrack"in i?{trackID:i.sid,source:i.source,muted:i.isMuted,enabled:i.mediaStreamTrack.enabled,kind:i.kind,streamID:i.mediaStreamID,streamTrackID:i.mediaStreamTrack.id}:{trackID:i.trackSid,enabled:i.isEnabled,muted:i.isMuted,trackInfo:Object.assign({mimeType:i.mimeType,name:i.trackName,encrypted:i.isEncrypted,kind:i.kind,source:i.source},i.track?Re(i.track):{})}}function KR(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function JR(i,e){var n;i===void 0&&(i={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(i)],o={};for(const c of r)i[c]!==e[c]&&(o[c]=(n=e[c])!==null&&n!==void 0?n:"");return o}function TS(i){const e=Object.assign({},i);let n,r;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:r,optionsWithoutProcessor:BR(e)}}function QR(i){switch(i){case pt.CAMERA:return J.Source.Camera;case pt.MICROPHONE:return J.Source.Microphone;case pt.SCREEN_SHARE:return J.Source.ScreenShare;case pt.SCREEN_SHARE_AUDIO:return J.Source.ScreenShareAudio;default:return J.Source.Unknown}}function By(i,e){return i.width*i.height<e.width*e.height}function XR(i,e){var n;return(n=i.layers)===null||n===void 0?void 0:n.find(r=>r.quality===e)}const ZR=5e3,Bs=[];var sn;(function(i){i[i.LOW=0]="LOW",i[i.MEDIUM=1]="MEDIUM",i[i.HIGH=2]="HIGH"})(sn||(sn={}));class J extends Vn.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=J.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=Te,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),ZR):this.handleAppVisibilityChanged()},this.log=vi((o=r.loggerName)!==null&&o!==void 0?o:Mn.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=J.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Re(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===J.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===J.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(Bs.forEach(c=>{c.parentElement===null&&!e&&(e=c)}),e&&Bs.splice(Bs.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Tr(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),o=r.some(c=>c.kind==="audio");return e.play().then(()=>{this.emit(o?ne.AudioPlaybackStarted:ne.VideoPlaybackStarted)}).catch(c=>{c.name==="NotAllowedError"?this.emit(o?ne.AudioPlaybackFailed:ne.VideoPlaybackFailed,c):c.name==="AbortError"?Te.debug("".concat(o?"audio":"video"," playback aborted, likely due to new play request")):Te.warn("could not playback ".concat(o?"audio":"video"),c),o&&e&&r.some(d=>d.kind==="video")&&c.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ne.ElementAttached,e),e}detach(e){try{if(e){wr(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ne.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{wr(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(ne.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=vi(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),Bs.forEach(r=>{r.parentElement||(n=!1)}),n&&Bs.push(e)}}handleAppVisibilityChanged(){return w(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===J.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Kt()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Kt()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Tr(i,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;i.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(i)||(r.forEach(o=>{n.removeTrack(o)}),n.addTrack(i)),(!Da()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Da()||Aa())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function wr(i,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(i),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(i){let e;(function(h){h.Audio="audio",h.Video="video",h.Unknown="unknown"})(e=i.Kind||(i.Kind={}));let n;(function(h){h.Camera="camera",h.Microphone="microphone",h.ScreenShare="screen_share",h.ScreenShareAudio="screen_share_audio",h.Unknown="unknown"})(n=i.Source||(i.Source={}));let r;(function(h){h.Active="active",h.Paused="paused",h.Unknown="unknown"})(r=i.StreamState||(i.StreamState={}));function o(h){switch(h){case e.Audio:return wn.AUDIO;case e.Video:return wn.VIDEO;default:return wn.DATA}}i.kindToProto=o;function c(h){switch(h){case wn.AUDIO:return e.Audio;case wn.VIDEO:return e.Video;default:return e.Unknown}}i.kindFromProto=c;function d(h){switch(h){case n.Camera:return pt.CAMERA;case n.Microphone:return pt.MICROPHONE;case n.ScreenShare:return pt.SCREEN_SHARE;case n.ScreenShareAudio:return pt.SCREEN_SHARE_AUDIO;default:return pt.UNKNOWN}}i.sourceToProto=d;function u(h){switch(h){case pt.CAMERA:return n.Camera;case pt.MICROPHONE:return n.Microphone;case pt.SCREEN_SHARE:return n.ScreenShare;case pt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}i.sourceFromProto=u;function f(h){switch(h){case Of.ACTIVE:return r.Active;case Of.PAUSED:return r.Paused;default:return r.Unknown}}i.streamStateFromProto=f})(J||(J={}));const WR="|",zy="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function $R(i){const e=i.split(WR);return e.length>1?[e[0],i.substr(e[0].length+1)]:[i,""]}function At(i){return new Yt(e=>Ot.setTimeout(e,i))}function qf(){return"addTransceiver"in RTCPeerConnection.prototype}function Vf(){return"addTrack"in RTCPeerConnection.prototype}function ew(){if(!("getCapabilities"in RTCRtpSender)||Da()||Aa())return!1;const i=RTCRtpSender.getCapabilities("video");let e=!1;if(i){for(const n of i.codecs)if(n.mimeType.toLowerCase()==="video/av1"){e=!0;break}}return e}function tw(){if(!("getCapabilities"in RTCRtpSender)||Aa())return!1;if(Da()){const n=Jt();if(n?.version&&qn(n.version,"16")<0||n?.os==="iOS"&&n?.osVersion&&qn(n.osVersion,"16")<0)return!1}const i=RTCRtpSender.getCapabilities("video");let e=!1;if(i){for(const n of i.codecs)if(n.mimeType.toLowerCase()==="video/vp9"){e=!0;break}}return e}function An(i){return i==="av1"||i==="vp9"}function Ff(i){return!document||to()?!1:(i||(i=document.createElement("audio")),"setSinkId"in i)}function nw(){return typeof RTCPeerConnection>"u"?!1:qf()||Vf()}function Aa(){var i;return((i=Jt())===null||i===void 0?void 0:i.name)==="Firefox"}function qy(){const i=Jt();return!!i&&i.name==="Chrome"&&i.os!=="iOS"}function Da(){var i;return((i=Jt())===null||i===void 0?void 0:i.name)==="Safari"}function to(){const i=Jt();return i?.name==="Safari"||i?.os==="iOS"}function iw(){const i=Jt();return i?.name==="Safari"&&i.version.startsWith("17.")||i?.os==="iOS"&&!!i?.osVersion&&qn(i.osVersion,"17")>=0}function aw(i){return i||(i=Jt()),i?.name==="Safari"&&qn(i.version,"18.3")>0||i?.os==="iOS"&&!!i?.osVersion&&qn(i.osVersion,"18.3")>0}function CS(){var i,e;return Kt()?(e=(i=navigator.userAgentData)===null||i===void 0?void 0:i.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function rw(){const i=Jt(),e="17.2";if(i)return i.name!=="Safari"&&i.os!=="iOS"||i.os==="iOS"&&i.osVersion&&qn(i.osVersion,e)>=0?!0:i.name==="Safari"&&qn(i.version,e)>=0}function Kt(){return typeof document<"u"}function zn(){return navigator.product=="ReactNative"}function Pr(i){return i.hostname.endsWith(".livekit.cloud")||i.hostname.endsWith(".livekit.run")}function sf(i){return Pr(i)?i.hostname.split(".")[0]:null}function kS(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function ES(){if(!zn())return;let i=kS();if(i)return i.platform}function Vy(){if(Kt())return window.devicePixelRatio;if(zn()){let i=kS();if(i)return i.devicePixelRatio}return 1}function qn(i,e){const n=i.split("."),r=e.split("."),o=Math.min(n.length,r.length);for(let c=0;c<o;++c){const d=parseInt(n[c],10),u=parseInt(r[c],10);if(d>u)return 1;if(d<u)return-1;if(c===o-1&&d===u)return 0}return i===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function sw(i){for(const e of i)e.target.handleResize(e)}function ow(i){for(const e of i)e.target.handleVisibilityChanged(e)}let of=null;const Fy=()=>(of||(of=new ResizeObserver(sw)),of);let cf=null;const Hy=()=>(cf||(cf=new IntersectionObserver(ow,{root:null,rootMargin:"0px"})),cf);function cw(){var i;const e=new Eb({sdk:_b.JS,protocol:IR,version:UR});return zn()&&(e.os=(i=ES())!==null&&i!==void 0?i:""),e}function Gy(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=document.createElement("canvas");o.width=i,o.height=e;const c=o.getContext("2d");c?.fillRect(0,0,o.width,o.height),r&&c&&(c.beginPath(),c.arc(i/2,e/2,50,0,Math.PI*2,!0),c.closePath(),c.fillStyle="grey",c.fill());const d=o.captureStream(),[u]=d.getTracks();if(!u)throw Error("Could not get empty media stream video track");return u.enabled=n,u}let zs;function lf(){if(!zs){const i=new AudioContext,e=i.createOscillator(),n=i.createGain();n.gain.setValueAtTime(0,0);const r=i.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[zs]=r.stream.getAudioTracks(),!zs)throw Error("Could not get empty media stream audio track");zs.enabled=!1}return zs.clone()}class Sn{get isResolved(){return this._isResolved}constructor(e,n){this._isResolved=!1,this.onFinally=n,this.promise=new Promise((r,o)=>w(this,void 0,void 0,function*(){this.resolve=r,this.reject=o,e&&(yield e(r,o))})).finally(()=>{var r;this._isResolved=!0,(r=this.onFinally)===null||r===void 0||r.call(this)})}}function lw(i){return qR.includes(i)}function Wi(i){if(typeof i=="string"||typeof i=="number")return i;if(Array.isArray(i))return i[0];if(i.exact!==void 0)return Array.isArray(i.exact)?i.exact[0]:i.exact;if(i.ideal!==void 0)return Array.isArray(i.ideal)?i.ideal[0]:i.ideal;throw Error("could not unwrap constraint")}function uw(i){return i.startsWith("http")?i.replace(/^(http)/,"ws"):i}function no(i){return i.startsWith("ws")?i.replace(/^(ws)/,"http"):i}function dw(i,e){return i.segments.map(n=>{let{id:r,text:o,language:c,startTime:d,endTime:u,final:f}=n;var h;const g=(h=e.get(r))!==null&&h!==void 0?h:Date.now(),v=Date.now();return f?e.delete(r):e.set(r,g),{id:r,text:o,startTime:Number.parseInt(d.toString()),endTime:Number.parseInt(u.toString()),final:f,language:c,firstReceivedTime:g,lastReceivedTime:v}})}function fw(i){const{id:e,timestamp:n,message:r,editTimestamp:o}=i;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:r}}function Yy(i){switch(i.reason){case Je.LeaveRequest:return i.context;case Je.Cancelled:return Dn.CLIENT_INITIATED;case Je.NotAllowed:return Dn.USER_REJECTED;case Je.ServerUnreachable:return Dn.JOIN_FAILURE;default:return Dn.UNKNOWN_REASON}}function Qc(i){return i!==void 0?Number(i):void 0}function Ra(i){return i!==void 0?BigInt(i):void 0}function Or(i){return!!i&&!(i instanceof MediaStreamTrack)&&i.isLocal}function Bn(i){return!!i&&i.kind==J.Kind.Audio}function aa(i){return!!i&&i.kind==J.Kind.Video}function Ki(i){return Or(i)&&aa(i)}function li(i){return Or(i)&&Bn(i)}function Hf(i){return!!i&&!i.isLocal}function hw(i){return!!i&&!i.isLocal}function uf(i){return Hf(i)&&aa(i)}function mw(i){return i.isLocal}function pw(i,e){const n=[];let r=new TextEncoder().encode(i);for(;r.length>e;){let o=e;for(;o>0;){const c=r[o];if(c!==void 0&&(c&192)!==128)break;o--}n.push(r.slice(0,o)),r=r.slice(o)}return r.length>0&&n.push(r),n}function gw(i){var e;const n=i.get("Cache-Control");if(n){const r=(e=n.match(/(?:^|[,\s])max-age=(\d+)/))===null||e===void 0?void 0:e[1];if(r)return parseInt(r,10)}}function vw(i,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=yw(i,e);return n?r:_h(r,"v1")}function yw(i,e){const n=new URL(uw(i));return e.forEach((r,o)=>{n.searchParams.set(o,r)}),_h(n,"rtc")}function bw(i){const e=new URL(no(i));return _h(e,"validate")}function _S(i){return i.endsWith("/")?i:"".concat(i,"/")}function _h(i,e){return i.pathname="".concat(_S(i.pathname)).concat(e),i}function Ky(i){if(typeof i=="string")return _y.fromJson(JSON.parse(i),{ignoreUnknownFields:!0});if(i instanceof ArrayBuffer)return _y.fromBinary(new Uint8Array(i));throw new Error("could not decode websocket message: ".concat(typeof i))}function Sw(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Unknown reason";if(!(i instanceof AbortSignal))return e;const n=i.reason;switch(typeof n){case"string":return n;case"object":return n instanceof Error?n.message:e;default:return"toString"in n?n.toString():e}}const Tw=10,qs="lk_e2ee",Cw="LKFrameEncryptionKey",kw={sharedKey:!1,ratchetSalt:Cw,ratchetWindowSize:8,failureTolerance:Tw,keyringSize:16};var $i;(function(i){i.SetKey="setKey",i.RatchetRequest="ratchetRequest",i.KeyRatcheted="keyRatcheted"})($i||($i={}));var Jy;(function(i){i.KeyRatcheted="keyRatcheted"})(Jy||(Jy={}));var Xi;(function(i){i.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",i.EncryptionError="encryptionError"})(Xi||(Xi={}));var Qy;(function(i){i.Error="cryptorError"})(Qy||(Qy={}));function Ew(){return _w()||Gf()}function Gf(){return typeof window.RTCRtpScriptTransform<"u"}function _w(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}function Rw(i){var e,n,r,o,c;if(((e=i.value)===null||e===void 0?void 0:e.case)!=="sipDtmf"&&((n=i.value)===null||n===void 0?void 0:n.case)!=="metrics"&&((r=i.value)===null||r===void 0?void 0:r.case)!=="speaker"&&((o=i.value)===null||o===void 0?void 0:o.case)!=="transcription"&&((c=i.value)===null||c===void 0?void 0:c.case)!=="encryptedPacket")return new vb({value:i.value})}class mM extends Vn.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r,o)=>{Te.debug("key ratcheted event received",{ratchetResult:n,participantId:r,keyIndex:o})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},kw),e),this.on($i.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const o={key:e,participantIdentity:n,keyIndex:r};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),o),this.emit($i.SetKey,o)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit($i.RatchetRequest,e,n)}}var Xy;(function(i){i[i.InvalidKey=0]="InvalidKey",i[i.MissingKey=1]="MissingKey",i[i.InternalError=2]="InternalError"})(Xy||(Xy={}));class ww extends Vn.EventEmitter{constructor(e,n){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=r=>{var o,c;const{kind:d,data:u}=r.data;switch(d){case"error":if(Te.error(u.error.message),u.uuid){const g=this.decryptDataRequests.get(u.uuid);if(g?.reject){g.reject(u.error);break}const v=this.encryptDataRequests.get(u.uuid);if(v?.reject){v.reject(u.error);break}}this.emit(Xi.EncryptionError,u.error,u.participantIdentity);break;case"initAck":u.enabled&&this.keyProvider.getKeys().forEach(g=>{this.postKey(g)});break;case"enable":if(u.enabled&&this.keyProvider.getKeys().forEach(g=>{this.postKey(g)}),this.encryptionEnabled!==u.enabled&&u.participantIdentity===((o=this.room)===null||o===void 0?void 0:o.localParticipant.identity))this.emit(Xi.ParticipantEncryptionStatusChanged,u.enabled,this.room.localParticipant),this.encryptionEnabled=u.enabled;else if(u.participantIdentity){const g=(c=this.room)===null||c===void 0?void 0:c.getParticipantByIdentity(u.participantIdentity);if(!g)throw TypeError("couldn't set encryption status, participant not found".concat(u.participantIdentity));this.emit(Xi.ParticipantEncryptionStatusChanged,u.enabled,g)}break;case"ratchetKey":this.keyProvider.emit($i.KeyRatcheted,u.ratchetResult,u.participantIdentity,u.keyIndex);break;case"decryptDataResponse":const f=this.decryptDataRequests.get(u.uuid);f?.resolve&&f.resolve(u);break;case"encryptDataResponse":const h=this.encryptDataRequests.get(u.uuid);h?.resolve&&h.resolve(u);break}},this.onWorkerError=r=>{Te.error("e2ee worker encountered an error:",{error:r.error}),this.emit(Xi.EncryptionError,r.error,void 0)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=n}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!Ew())throw new Ch("tried to setup end-to-end encryption on an unsupported browser");if(Te.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:SR.getLevel()}};this.worker&&(Te.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){Te.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?Te.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(re.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(H.TrackPublished,(r,o)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==yt.NONE,o.identity)),e.on(H.ConnectionStateChanged,r=>{r===Ie.Connected&&e.remoteParticipants.forEach(o=>{o.trackPublications.forEach(c=>{this.setParticipantCryptorEnabled(c.trackInfo.encryption!==yt.NONE,o.identity)})})}).on(H.TrackUnsubscribed,(r,o,c)=>{var d;const u={kind:"removeTransform",data:{participantIdentity:c.identity,trackId:r.mediaStreamID}};(d=this.worker)===null||d===void 0||d.postMessage(u)}).on(H.TrackSubscribed,(r,o,c)=>{this.setupE2EEReceiver(r,c.identity,o.trackInfo)}).on(H.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(ee.LocalSenderCreated,(r,o)=>w(this,void 0,void 0,function*(){this.setupE2EESender(o,r)})),e.localParticipant.on(ee.LocalTrackPublished,r=>{if(!aa(r.track)||!to())return;const o={kind:"updateCodec",data:{trackId:r.track.mediaStreamID,codec:Ks(r.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(o)}),n.on($i.SetKey,r=>this.postKey(r)).on($i.RatchetRequest,(r,o)=>this.postRatchetRequest(r,o))}encryptData(e){return w(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const n=crypto.randomUUID(),r={kind:"encryptDataRequest",data:{uuid:n,payload:e,participantIdentity:this.room.localParticipant.identity}},o=new Sn;return o.onFinally=()=>{this.encryptDataRequests.delete(n)},this.encryptDataRequests.set(n,o),this.worker.postMessage(r),o.promise})}handleEncryptedData(e,n,r,o){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const c=crypto.randomUUID(),d={kind:"decryptDataRequest",data:{uuid:c,payload:e,iv:n,participantIdentity:r,keyIndex:o}},u=new Sn;return u.onFinally=()=>{this.decryptDataRequests.delete(c)},this.decryptDataRequests.set(c,u),this.worker.postMessage(d),u.promise}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:o}=e;var c;if(!this.worker)throw Error("could not set key, worker is missing");const d={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((c=this.room)===null||c===void 0?void 0:c.localParticipant.identity),key:n,keyIndex:o}};this.worker.postMessage(d)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!r?.mimeType||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?Ks(r.mimeType):void 0)}}setupE2EESender(e,n){if(!Or(e)||!n){n||Te.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,o){return w(this,void 0,void 0,function*(){if(this.worker){if(Gf()&&!qy()){const c={kind:"decode",participantIdentity:r,trackId:n,codec:o};e.transform=new RTCRtpScriptTransform(this.worker,c)}else{if(qs in e&&o){const f={kind:"updateCodec",data:{trackId:n,codec:o,participantIdentity:r}};this.worker.postMessage(f);return}let c=e.writableStream,d=e.readableStream;if(!c||!d){const f=e.createEncodedStreams();e.writableStream=f.writable,c=f.writable,e.readableStream=f.readable,d=f.readable}const u={kind:"decode",data:{readableStream:d,writableStream:c,trackId:n,codec:o,participantIdentity:r,isReuse:qs in e}};this.worker.postMessage(u,[d,c])}e[qs]=!0}})}handleSender(e,n,r){var o;if(!(qs in e||!this.worker)){if(!(!((o=this.room)===null||o===void 0)&&o.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Gf()&&!qy()){Te.info("initialize script transform");const c={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,c)}else{Te.info("initialize encoded streams");const c=e.createEncodedStreams(),d={kind:"encode",data:{readableStream:c.readable,writableStream:c.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(d,[c.readable,c.writable])}e[qs]=!0}}}const Ow=500,Aw=15e3;class Ar{constructor(){this.failedConnectionAttempts=new Map,this.backOffPromises=new Map}static getInstance(){return this._instance||(this._instance=new Ar),this._instance}addFailedConnectionAttempt(e){var n;const r=new URL(e),o=sf(r);if(!o)return;let c=(n=this.failedConnectionAttempts.get(o))!==null&&n!==void 0?n:0;this.failedConnectionAttempts.set(o,c+1),this.backOffPromises.set(o,At(Math.min(Ow*Math.pow(2,c),Aw)))}getBackOffPromise(e){const n=new URL(e),r=n&&sf(n);return r&&this.backOffPromises.get(r)||Promise.resolve()}resetFailedConnectionAttempts(e){const n=new URL(e),r=n&&sf(n);r&&(this.failedConnectionAttempts.set(r,0),this.backOffPromises.set(r,Promise.resolve()))}resetAll(){this.backOffPromises.clear(),this.failedConnectionAttempts.clear()}}Ar._instance=null;const df="default";class Ct{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new Ct),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return w(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var c;if(((c=Ct.userMediaPromiseMap)===null||c===void 0?void 0:c.size)>0){Te.debug("awaiting getUserMedia promise");try{n?yield Ct.userMediaPromiseMap.get(n):yield Promise.all(Ct.userMediaPromiseMap.values())}catch{Te.warn("error waiting for media permissons")}}let d=yield navigator.mediaDevices.enumerateDevices();if(o&&!(Da()&&r.hasDeviceInUse(n))&&(d.filter(f=>f.kind===n).length===0||d.some(f=>{const h=f.label==="",g=n?f.kind===n:!0;return h&&g}))){const f={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:{ideal:"default"}}},h=yield navigator.mediaDevices.getUserMedia(f);d=yield navigator.mediaDevices.enumerateDevices(),h.getTracks().forEach(g=>{g.stop()})}return r._previousDevices=d,n&&(d=d.filter(u=>u.kind===n)),d})()})}normalizeDeviceId(e,n,r){return w(this,void 0,void 0,function*(){if(n!==df)return n;const o=yield this.getDevices(e),c=o.find(u=>u.deviceId===df);if(!c){Te.warn("could not reliably determine default device");return}const d=o.find(u=>u.deviceId!==df&&u.groupId===(r??c.groupId));if(!d){Te.warn("could not reliably determine default device");return}return d?.deviceId})}hasDeviceInUse(e){return e?Ct.userMediaPromiseMap.has(e):Ct.userMediaPromiseMap.size>0}}Ct.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Ct.userMediaPromiseMap=new Map;var Js;(function(i){i[i.WAITING=0]="WAITING",i[i.RUNNING=1]="RUNNING",i[i.COMPLETED=2]="COMPLETED"})(Js||(Js={}));class Dw{constructor(){this.pendingTasks=new Map,this.taskMutex=new Ut,this.nextTaskIndex=0}run(e){return w(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:Js.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=Js.RUNNING,yield e()}finally{n.status=Js.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return w(this,void 0,void 0,function*(){return this.run(()=>w(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class Mw{get readyState(){return this.ws.readyState}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r,o;if(!((r=n.signal)===null||r===void 0)&&r.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const c=new WebSocket(e,(o=n.protocols)!==null&&o!==void 0?o:[]);c.binaryType="arraybuffer",this.ws=c;const d=function(){let{closeCode:u,reason:f}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return c.close(u,f)};this.opened=new Yt((u,f)=>{const h=()=>{f(he.websocket("Encountered websocket error during connection establishment"))};c.onopen=()=>{u({readable:new ReadableStream({start(g){c.onmessage=v=>{let{data:b}=v;return g.enqueue(b)},c.onerror=v=>g.error(v)},cancel:d}),writable:new WritableStream({write(g){c.send(g)},abort(){c.close()},close:d}),protocol:c.protocol,extensions:c.extensions}),c.removeEventListener("error",h)},c.addEventListener("error",h)}),this.closed=new Yt((u,f)=>{const h=()=>w(this,void 0,void 0,function*(){const g=new Yt(b=>{c.readyState!==WebSocket.CLOSED&&c.addEventListener("close",T=>{b(T)},{once:!0})}),v=yield Yt.race([At(250),g]);v?u(v):f(he.websocket("Encountered unspecified websocket error without a timely close event"))});c.onclose=g=>{let{code:v,reason:b}=g;u({closeCode:v,reason:b}),c.removeEventListener("error",h)},c.addEventListener("error",h)}),n.signal&&(n.signal.onabort=()=>c.close()),this.close=d}}const xw=["syncState","trickle","offer","answer","simulate","leave"];function Pw(i){const e=xw.indexOf(i.case)>=0;return Te.trace("request allowed to bypass queue:",{canPass:e,req:i}),e}var Ke;(function(i){i[i.CONNECTING=0]="CONNECTING",i[i.CONNECTED=1]="CONNECTED",i[i.RECONNECTING=2]="RECONNECTING",i[i.DISCONNECTING=3]="DISCONNECTING",i[i.DISCONNECTED=4]="DISCONNECTED"})(Ke||(Ke={}));const Nw=250;class Rh{get currentState(){return this.state}get isDisconnected(){return this.state===Ke.DISCONNECTING||this.state===Ke.DISCONNECTED}get isEstablishingConnection(){return this.state===Ke.CONNECTING||this.state===Ke.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Ke.DISCONNECTED,this.log=Te,this._requestId=0,this.useV0SignalPath=!1,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=vi((r=n.loggerName)!==null&&r!==void 0?r:Mn.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new Dw,this.queuedRequests=[],this.closingLock=new Ut,this.connectionLock=new Ut,this.state=Ke.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,o){return w(this,arguments,void 0,function(c,d,u,f){var h=this;let g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){return h.state=Ke.CONNECTING,h.options=u,yield h.connect(c,d,u,f,g)})()})}reconnect(e,n,r,o){return w(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Ke.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:o}),void 0,this.useV0SignalPath)})}connect(e,n,r,o){return w(this,arguments,void 0,function(c,d,u,f){var h=this;let g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){const v=yield h.connectionLock.lock();h.connectOptions=u,h.useV0SignalPath=g;const b=cw(),T=g?Lw(d,b,u):Uw(d,b,u),_=vw(c,T,g).toString(),C=bw(_).toString();return new Promise((M,R)=>w(h,void 0,void 0,function*(){var B,q;try{let E=!1;const k=Q=>w(this,void 0,void 0,function*(){if(E)return;E=!0;const W=Q instanceof Event?Q.currentTarget:Q,ie=Sw(W,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(ie)).catch(ve=>{this.log.error(ve),this.close()}):this.close(),D(),R(he.cancelled(ie))});f?.addEventListener("abort",k);const D=()=>{clearTimeout(L),f?.removeEventListener("abort",k)},L=setTimeout(()=>{k(he.timeout("room connection has timed out (signal)"))},u.websocketTimeout),K=(Q,W)=>{this.handleSignalConnected(Q,L,W)},G=new URL(_);G.searchParams.has("access_token")&&G.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(G),Object.assign({reconnect:u.reconnect,reconnectReason:u.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new Mw(_);try{this.ws.closed.then(V=>{var ae;this.isEstablishingConnection&&R(he.internal("Websocket got closed during a (re)connection attempt: ".concat(V.reason))),V.closeCode!==1e3&&(this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:V.reason,code:V.closeCode,wasClean:V.closeCode===1e3,state:this.state})),this.state===Ke.CONNECTED&&this.handleOnClose((ae=V.reason)!==null&&ae!==void 0?ae:"Unexpected WS error"))}).catch(V=>{this.isEstablishingConnection&&R(he.internal("Websocket error during a (re)connection attempt: ".concat(V)))});const Q=yield this.ws.opened.catch(V=>w(this,void 0,void 0,function*(){if(this.state!==Ke.CONNECTED){this.state=Ke.DISCONNECTED,clearTimeout(L);const ae=yield this.handleConnectionError(V,C);R(ae);return}this.handleWSError(V),R(V)}));if(clearTimeout(L),!Q)return;const W=Q.readable.getReader();this.streamWriter=Q.writable.getWriter();const ie=yield W.read();if(W.releaseLock(),!ie.value)throw he.internal("no message received as first message");const ve=Ky(ie.value),Ne=this.validateFirstMessage(ve,(B=u.reconnect)!==null&&B!==void 0?B:!1);if(!Ne.isValid){R(Ne.error);return}((q=ve.message)===null||q===void 0?void 0:q.case)==="join"&&(this.pingTimeoutDuration=ve.message.value.pingTimeout,this.pingIntervalDuration=ve.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));const tt=Ne.shouldProcessFirstMessage?ve:void 0;K(Q,tt),M(Ne.response)}catch(Q){R(Q)}finally{D()}}finally{v()}}))})()})}startReadingLoop(e,n){return w(this,void 0,void 0,function*(){for(n&&this.handleSignalResponse(n);;){this.signalLatency&&(yield At(this.signalLatency));const{done:r,value:o}=yield e.read();if(r)break;const c=Ky(o);this.handleSignalResponse(c)}})}close(){return w(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Close method called on signal client";return(function*(){if([Ke.DISCONNECTING||Ke.DISCONNECTED].includes(e.state)){e.log.debug("ignoring signal close as it's already in disconnecting state");return}const o=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=Ke.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:r});const c=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([c,At(Nw)])}}catch(c){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:c}))}finally{n&&(e.state=Ke.DISCONNECTED),o()}})()})}sendOffer(e,n){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Cr(e,n)})}sendAnswer(e,n){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Cr(e,n)})}sendIceCandidate(e,n){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new gl({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new vl({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return w(this,arguments,void 0,function(r,o){var c=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return(function*(){const u=c.getNextRequestId();return yield c.sendRequest({case:"updateMetadata",value:new vh({requestId:u,metadata:r,name:o,attributes:d})}),u})()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new xb({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new Lb({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:$e.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new jb({timestamp:$e.parse(Date.now()),rtt:$e.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new gh({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new bl({reason:Dn.CLIENT_INITIATED,action:Er.DISCONNECT})})}sendRequest(e){return w(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(function*(){if(!o&&!Pw(n)&&r.state===Ke.RECONNECTING){r.queuedRequests.push(()=>w(r,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(o||(yield r.requestQueue.flush()),r.signalLatency&&(yield At(r.signalLatency)),r.isDisconnected){r.log.debug("skipping signal request (type: ".concat(n.case,") - SignalClient disconnected"));return}if(!r.streamWriter){r.log.error("cannot send signal request before connected, type: ".concat(n?.case),r.logContext);return}const d=new G_({message:n});try{r.useJSON?yield r.streamWriter.write(d.toJsonString()):yield r.streamWriter.write(d.toBinary())}catch(u){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:u}))}})()})}handleSignalResponse(e){var n,r;const o=e.message;if(o==null){this.log.debug("received unsupported message",this.logContext);return}let c=!1;if(o.case==="answer"){const d=Zy(o.value);this.onAnswer&&this.onAnswer(d,o.value.id,o.value.midToTrackId)}else if(o.case==="offer"){const d=Zy(o.value);this.onOffer&&this.onOffer(d,o.value.id,o.value.midToTrackId)}else if(o.case==="trickle"){const d=JSON.parse(o.value.candidateInit);this.onTrickle&&this.onTrickle(d,o.value.target)}else o.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=o.value.participants)!==null&&n!==void 0?n:[]):o.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(o.value):o.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=o.value.speakers)!==null&&r!==void 0?r:[]):o.case==="leave"?this.onLeave&&this.onLeave(o.value):o.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(o.value.sid,o.value.muted):o.case==="roomUpdate"?this.onRoomUpdate&&o.value.room&&this.onRoomUpdate(o.value.room):o.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(o.value):o.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(o.value):o.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(o.value):o.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(o.value):o.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(o.value):o.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(o.value):o.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(o.value):o.case==="pong"||(o.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(o.value.lastPingTimestamp.toString()),this.resetPingTimeout(),c=!0):o.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(o.value):o.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(o.value.trackSid):o.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(o.value.token),this.onRoomMoved&&this.onRoomMoved(o.value)):o.case==="mediaSectionsRequirement"?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(o.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:o.case})));c||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return w(this,void 0,void 0,function*(){if(this.state===Ke.DISCONNECTED)return;const n=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=Ot.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&Ot.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=Ot.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&Ot.clearInterval(this.pingInterval)}handleSignalConnected(e,n,r){this.state=Ke.CONNECTED,clearTimeout(n),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),r)}validateFirstMessage(e,n){var r,o,c,d,u;return((r=e.message)===null||r===void 0?void 0:r.case)==="join"?{isValid:!0,response:e.message.value}:this.state===Ke.RECONNECTING&&((o=e.message)===null||o===void 0?void 0:o.case)!=="leave"?((c=e.message)===null||c===void 0?void 0:c.case)==="reconnect"?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&((d=e.message)===null||d===void 0?void 0:d.case)==="leave"?{isValid:!1,error:he.leaveRequest("Received leave request while trying to (re)connect",e.message.value.reason)}:n?{isValid:!1,error:he.internal("Unexpected first message")}:{isValid:!1,error:he.internal("did not receive join response, got ".concat((u=e.message)===null||u===void 0?void 0:u.case," instead"))}}handleConnectionError(e,n){return w(this,void 0,void 0,function*(){try{const r=yield fetch(n);switch(r.status){case 404:return he.serviceNotFound("v1 RTC path not found. Consider upgrading your LiveKit server version","v0-rtc");case 401:case 403:const o=yield r.text();return he.notAllowed(o,r.status);default:break}return e instanceof he?e:he.internal("Encountered unknown websocket error during connection: ".concat(e),{status:r.status,statusText:r.statusText})}catch(r){return r instanceof he?r:he.serverUnreachable(r instanceof Error?r.message:"server was not reachable")}})}}function Zy(i){const e={type:"offer",sdp:i.sdp};switch(i.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=i.type;break}return e}function Cr(i,e){return new ta({sdp:i.sdp,type:i.type,id:e})}function Lw(i,e,n){var r;const o=new URLSearchParams;return o.set("access_token",i),n.reconnect&&(o.set("reconnect","1"),n.sid&&o.set("sid",n.sid)),o.set("auto_subscribe",n.autoSubscribe?"1":"0"),o.set("sdk",zn()?"reactnative":"js"),o.set("version",e.version),o.set("protocol",e.protocol.toString()),e.deviceModel&&o.set("device_model",e.deviceModel),e.os&&o.set("os",e.os),e.osVersion&&o.set("os_version",e.osVersion),e.browser&&o.set("browser",e.browser),e.browserVersion&&o.set("browser_version",e.browserVersion),n.adaptiveStream&&o.set("adaptive_stream","1"),n.reconnectReason&&o.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&o.set("network",navigator.connection.type),o}function Uw(i,e,n){const r=new URLSearchParams;r.set("access_token",i);const o=new hR({clientInfo:e,connectionSettings:new Bb({autoSubscribe:!!n.autoSubscribe,adaptiveStream:!!n.adaptiveStream}),reconnect:!!n.reconnect,participantSid:n.sid?n.sid:void 0});n.reconnectReason&&(o.reconnectReason=n.reconnectReason);const c=new mR({joinRequest:o.toBinary()});return r.set("join_request",btoa(new TextDecoder("utf-8").decode(c.toBinary()))),r}class Wy{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const n=this.buffer[0];if(this._totalSize-n.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class Iw{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,n){const r=Date.now();r-this._lastCleanup>this.ttl/2&&this.cleanup();const o=r+this.ttl;return this._map.set(e,{value:n,expiresAt:o}),this}get(e){const n=this._map.get(e);if(n){if(n.expiresAt<Date.now()){this._map.delete(e);return}return n.value}}has(e){const n=this._map.get(e);return n?n.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[n,r]of this._map.entries())r.expiresAt<e&&this._map.delete(n);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[n,r]of this._map.entries())r.expiresAt>=Date.now()&&e(r.value,n,this.asValueMap())}map(e){this.cleanup();const n=[],r=this.asValueMap();for(const[o,c]of r.entries())n.push(e(c,o,r));return n}asValueMap(){const e=new Map;for(const[n,r]of this._map.entries())r.expiresAt>=Date.now()&&e.set(n,r.value);return e}}var _n={},ff={},hf={exports:{}},$y;function wh(){if($y)return hf.exports;$y=1;var i=hf.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(i).forEach(function(e){var n=i[e];n.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),hf.exports}var e0;function jw(){return e0||(e0=1,(function(i){var e=function(u){return String(Number(u))===u?Number(u):u},n=function(u,f,h,g){if(g&&!h)f[g]=e(u[1]);else for(var v=0;v<h.length;v+=1)u[v+1]!=null&&(f[h[v]]=e(u[v+1]))},r=function(u,f,h){var g=u.name&&u.names;u.push&&!f[u.push]?f[u.push]=[]:g&&!f[u.name]&&(f[u.name]={});var v=u.push?{}:g?f[u.name]:f;n(h.match(u.reg),v,u.names,u.name),u.push&&f[u.push].push(v)},o=wh(),c=RegExp.prototype.test.bind(/^([a-z])=(.*)/);i.parse=function(u){var f={},h=[],g=f;return u.split(/(\r\n|\r|\n)/).filter(c).forEach(function(v){var b=v[0],T=v.slice(2);b==="m"&&(h.push({rtp:[],fmtp:[]}),g=h[h.length-1]);for(var _=0;_<(o[b]||[]).length;_+=1){var C=o[b][_];if(C.reg.test(T))return r(C,g,T)}}),f.media=h,f};var d=function(u,f){var h=f.split(/=(.+)/,2);return h.length===2?u[h[0]]=e(h[1]):h.length===1&&f.length>1&&(u[h[0]]=void 0),u};i.parseParams=function(u){return u.split(/;\s?/).reduce(d,{})},i.parseFmtpConfig=i.parseParams,i.parsePayloads=function(u){return u.toString().split(" ").map(Number)},i.parseRemoteCandidates=function(u){for(var f=[],h=u.split(" ").map(e),g=0;g<h.length;g+=3)f.push({component:h[g],ip:h[g+1],port:h[g+2]});return f},i.parseImageAttributes=function(u){return u.split(" ").map(function(f){return f.substring(1,f.length-1).split(",").reduce(d,{})})},i.parseSimulcastStreamList=function(u){return u.split(";").map(function(f){return f.split(",").map(function(h){var g,v=!1;return h[0]!=="~"?g=e(h):(g=e(h.substring(1,h.length)),v=!0),{scid:g,paused:v}})})}})(ff)),ff}var mf,t0;function Bw(){if(t0)return mf;t0=1;var i=wh(),e=/%[sdv%]/g,n=function(d){var u=1,f=arguments,h=f.length;return d.replace(e,function(g){if(u>=h)return g;var v=f[u];switch(u+=1,g){case"%%":return"%";case"%s":return String(v);case"%d":return Number(v);case"%v":return""}})},r=function(d,u,f){var h=u.format instanceof Function?u.format(u.push?f:f[u.name]):u.format,g=[d+"="+h];if(u.names)for(var v=0;v<u.names.length;v+=1){var b=u.names[v];u.name?g.push(f[u.name][b]):g.push(f[u.names[v]])}else g.push(f[u.name]);return n.apply(null,g)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];return mf=function(d,u){u=u||{},d.version==null&&(d.version=0),d.name==null&&(d.name=" "),d.media.forEach(function(v){v.payloads==null&&(v.payloads="")});var f=u.outerOrder||o,h=u.innerOrder||c,g=[];return f.forEach(function(v){i[v].forEach(function(b){b.name in d&&d[b.name]!=null?g.push(r(v,b,d)):b.push in d&&d[b.push]!=null&&d[b.push].forEach(function(T){g.push(r(v,b,T))})})}),d.media.forEach(function(v){g.push(r("m",i.m[0],v)),h.forEach(function(b){i[b].forEach(function(T){T.name in v&&v[T.name]!=null?g.push(r(b,T,v)):T.push in v&&v[T.push]!=null&&v[T.push].forEach(function(_){g.push(r(b,T,_))})})})}),g.join(`\r
`)+`\r
`},mf}var n0;function zw(){if(n0)return _n;n0=1;var i=jw(),e=Bw(),n=wh();return _n.grammar=n,_n.write=e,_n.parse=i.parse,_n.parseParams=i.parseParams,_n.parseFmtpConfig=i.parseFmtpConfig,_n.parsePayloads=i.parsePayloads,_n.parseRemoteCandidates=i.parseRemoteCandidates,_n.parseImageAttributes=i.parseImageAttributes,_n.parseSimulcastStreamList=i.parseSimulcastStreamList,_n}var Ji=zw();function Oh(i,e,n){var r,o,c;e===void 0&&(e=50),n===void 0&&(n={});var d=(r=n.isImmediate)!=null&&r,u=(o=n.callback)!=null&&o,f=n.maxWait,h=Date.now(),g=[];function v(){if(f!==void 0){var T=Date.now()-h;if(T+e>=f)return f-T}return e}var b=function(){var T=[].slice.call(arguments),_=this;return new Promise(function(C,M){var R=d&&c===void 0;if(c!==void 0&&clearTimeout(c),c=setTimeout(function(){if(c=void 0,h=Date.now(),!d){var q=i.apply(_,T);u&&u(q),g.forEach(function(E){return(0,E.resolve)(q)}),g=[]}},v()),R){var B=i.apply(_,T);return u&&u(B),C(B)}g.push({resolve:C,reject:M})})};return b.cancel=function(T){c!==void 0&&clearTimeout(c),g.forEach(function(_){return(0,_.reject)(T)}),g=[]},b}const qw=.7,Vw=20,Dr={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class i0 extends Vn.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=Te,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Oh(o=>w(this,void 0,void 0,function*(){this.emit(Dr.NegotiationStarted);try{yield this.createAndSendOffer()}catch(c){if(o)o(c);else throw c}}),Vw),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=vi((r=n.loggerName)!==null&&r!==void 0?r:Mn.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC(),this.offerLock=new Ut}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return w(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,n){return w(this,void 0,void 0,function*(){var r;if(e.type==="answer"&&this.latestOfferId>0&&n>0&&n!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:n,latestOfferId:this.latestOfferId})),!1;let o;if(e.type==="offer"){let{stereoMids:c,nackMids:d}=Fw(e);this.remoteStereoMids=c,this.remoteNackMids=d}else if(e.type==="answer"){const c=Ji.parse((r=e.sdp)!==null&&r!==void 0?r:"");c.media.forEach(d=>{const u=Ah(d.mid);d.type==="audio"&&this.trackBitrates.some(f=>{if(!f.transceiver||u!=f.transceiver.mid)return!1;let h=0;if(d.rtp.some(v=>v.codec.toUpperCase()===f.codec.toUpperCase()?(h=v.payload,!0):!1),h===0)return!0;let g=!1;for(const v of d.fmtp)if(v.payload===h){v.config=v.config.split(";").filter(b=>!b.includes("maxaveragebitrate")).join(";"),f.maxbr>0&&(v.config+=";maxaveragebitrate=".concat(f.maxbr*1e3)),g=!0;break}return g||f.maxbr>0&&d.fmtp.push({payload:h,config:"maxaveragebitrate=".concat(f.maxbr*1e3)}),!0})}),o=Ji.write(c)}return yield this.setMungedSDP(e,o,!0),this.pendingCandidates.forEach(c=>{this.pc.addIceCandidate(c)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Dr.NegotiationComplete),e.sdp&&Ji.parse(e.sdp).media.forEach(d=>{d.type==="video"&&this.emit(Dr.RTPVideoPayloadTypes,d.rtp)})),!0})}createAndSendOffer(e){return w(this,void 0,void 0,function*(){var n;const r=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e?.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const u=this._pc.remoteDescription;if(e?.iceRestart&&u)yield this._pc.setRemoteDescription(u);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const o=this.latestOfferId+1;this.latestOfferId=o;const c=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:c.sdp},this.logContext));const d=Ji.parse((n=c.sdp)!==null&&n!==void 0?n:"");if(d.media.forEach(u=>{r0(u),u.type==="audio"?a0(u,["all"],[]):u.type==="video"&&this.trackBitrates.some(f=>{if(!u.msid||!f.cid||!u.msid.includes(f.cid))return!1;let h=0;if(u.rtp.some(v=>v.codec.toUpperCase()===f.codec.toUpperCase()?(h=v.payload,!0):!1),h===0||(An(f.codec)&&!Da()&&this.ensureVideoDDExtensionForSVC(u,d),!An(f.codec)))return!0;const g=Math.round(f.maxbr*qw);for(const v of u.fmtp)if(v.payload===h){v.config.includes("x-google-start-bitrate")||(v.config+=";x-google-start-bitrate=".concat(g));break}return!0})}),this.latestOfferId>o){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:o}));return}yield this.setMungedSDP(c,Ji.write(d)),this.onOffer(c,this.latestOfferId)}finally{r()}})}createAndSetAnswer(){return w(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),r=Ji.parse((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(o=>{r0(o),o.type==="audio"&&a0(o,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Ji.write(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTransceiverOfKind(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new lt("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new lt("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return w(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const r=new Map,o=new Map;if((yield this._pc.getStats()).forEach(u=>{switch(u.type){case"transport":n=u.selectedCandidatePairId;break;case"candidate-pair":n===""&&u.selected&&(n=u.id),r.set(u.id,u);break;case"remote-candidate":o.set(u.id,"".concat(u.address,":").concat(u.port));break}}),n==="")return;const d=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(d!==void 0)return o.get(d)})}setMungedSDP(e,n,r){return w(this,void 0,void 0,function*(){if(n){const o=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(c){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:c,sdp:n})),e.sdp=o}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(o){let c="unknown error";o instanceof Error?c=o.message:typeof o=="string"&&(c=o);const d={error:c,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(d.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:d})),new Rr(c)}})}ensureVideoDDExtensionForSVC(e,n){var r,o;if(!((r=e.ext)===null||r===void 0?void 0:r.some(d=>d.uri===zy))){if(this.ddExtID===0){let d=0;n.media.forEach(u=>{var f;u.type==="video"&&((f=u.ext)===null||f===void 0||f.forEach(h=>{h.value>d&&(d=h.value)}))}),this.ddExtID=d+1}(o=e.ext)===null||o===void 0||o.push({value:this.ddExtID,uri:zy})}}}function a0(i,e,n){const r=Ah(i.mid);let o=0;i.rtp.some(c=>c.codec==="opus"?(o=c.payload,!0):!1),o>0&&(i.rtcpFb||(i.rtcpFb=[]),n.includes(r)&&!i.rtcpFb.some(c=>c.payload===o&&c.type==="nack")&&i.rtcpFb.push({payload:o,type:"nack"}),(e.includes(r)||e.length===1&&e[0]==="all")&&i.fmtp.some(c=>c.payload===o?(c.config.includes("stereo=1")||(c.config+=";stereo=1"),!0):!1))}function Fw(i){var e;const n=[],r=[],o=Ji.parse((e=i.sdp)!==null&&e!==void 0?e:"");let c=0;return o.media.forEach(d=>{var u;const f=Ah(d.mid);d.type==="audio"&&(d.rtp.some(h=>h.codec==="opus"?(c=h.payload,!0):!1),!((u=d.rtcpFb)===null||u===void 0)&&u.some(h=>h.payload===c&&h.type==="nack")&&r.push(f),d.fmtp.some(h=>h.payload===c?(h.config.includes("sprop-stereo=1")&&n.push(f),!0):!1))}),{stereoMids:n,nackMids:r}}function r0(i){if(i.connection){const e=i.connection.ip.indexOf(":")>=0;(i.connection.version===4&&e||i.connection.version===6&&!e)&&(i.connection.ip="0.0.0.0",i.connection.version=4)}}function Ah(i){return typeof i=="number"?i.toFixed(0):i}const Yf="vp8",Hw={audioPreset:If.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:kh.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Yf,backupCodec:!0,preConnectBuffer:!1},RS={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},wS={deviceId:{ideal:"default"},resolution:eo.h720.resolution},Gw={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new CR,disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!0},Dh={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var at;(function(i){i[i.NEW=0]="NEW",i[i.CONNECTING=1]="CONNECTING",i[i.CONNECTED=2]="CONNECTED",i[i.FAILED=3]="FAILED",i[i.CLOSING=4]="CLOSING",i[i.CLOSED=5]="CLOSED"})(at||(at={}));class Yw{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}get mode(){return this._mode}constructor(e,n,r){var o;this.peerConnectionTimeout=Dh.peerConnectionTimeout,this.log=Te,this.updateState=()=>{var c,d;const u=this.state,f=this.requiredTransports.map(h=>h.getConnectionState());f.every(h=>h==="connected")?this.state=at.CONNECTED:f.some(h=>h==="failed")?this.state=at.FAILED:f.some(h=>h==="connecting")?this.state=at.CONNECTING:f.every(h=>h==="closed")?this.state=at.CLOSED:f.some(h=>h==="closed")?this.state=at.CLOSING:f.every(h=>h==="new")&&(this.state=at.NEW),u!==this.state&&(this.log.debug("pc state change: from ".concat(at[u]," to ").concat(at[this.state]),this.logContext),(c=this.onStateChange)===null||c===void 0||c.call(this,this.state,this.publisher.getConnectionState(),(d=this.subscriber)===null||d===void 0?void 0:d.getConnectionState()))},this.log=vi((o=r.loggerName)!==null&&o!==void 0?o:Mn.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=n!=="subscriber-primary",this.isSubscriberConnectionRequired=n==="subscriber-primary",this.publisher=new i0(e,r),this._mode=n,n!=="publisher-only"&&(this.subscriber=new i0(e,r),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=c=>{var d;(d=this.onIceCandidate)===null||d===void 0||d.call(this,c,On.SUBSCRIBER)},this.subscriber.onDataChannel=c=>{var d;(d=this.onDataChannel)===null||d===void 0||d.call(this,c)},this.subscriber.onTrack=c=>{var d;(d=this.onTrack)===null||d===void 0||d.call(this,c)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=c=>{var d;(d=this.onIceCandidate)===null||d===void 0||d.call(this,c,On.PUBLISHER)},this.publisher.onTrack=c=>{var d;(d=this.onTrack)===null||d===void 0||d.call(this,c)},this.publisher.onOffer=(c,d)=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,c,d)},this.state=at.NEW,this.connectionLock=new Ut,this.remoteOfferLock=new Ut}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,n){return this.publisher.setRemoteDescription(e,n)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return w(this,void 0,void 0,function*(){var e;if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const n=this.publisher;for(const r of n.getSenders())try{n.canRemoveTrack()&&n.removeTrack(r)}catch(o){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:o}))}}yield Promise.all([this.publisher.close(),(e=this.subscriber)===null||e===void 0?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return w(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return w(this,void 0,void 0,function*(){var r;n===On.PUBLISHER?yield this.publisher.addIceCandidate(e):yield(r=this.subscriber)===null||r===void 0?void 0:r.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,n){return w(this,void 0,void 0,function*(){var r,o,c;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:(r=this.subscriber)===null||r===void 0?void 0:r.getSignallingState().toString()}));const d=yield this.remoteOfferLock.lock();try{return(yield(o=this.subscriber)===null||o===void 0?void 0:o.setRemoteDescription(e,n))?yield(c=this.subscriber)===null||c===void 0?void 0:c.createAndSetAnswer():void 0}finally{d()}})}updateConfiguration(e,n){var r;this.publisher.setConfiguration(e),(r=this.subscriber)===null||r===void 0||r.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return w(this,void 0,void 0,function*(){var r;const o=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(c=>this.ensureTransportConnected(c,e,n)))}finally{o()}})}negotiate(e){return w(this,void 0,void 0,function*(){return new Yt((n,r)=>w(this,void 0,void 0,function*(){const o=setTimeout(()=>{r(new Rr("negotiation timed out"))},this.peerConnectionTimeout),c=()=>{clearTimeout(o),r(new Rr("negotiation aborted"))};e.signal.addEventListener("abort",c),this.publisher.once(Dr.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Dr.NegotiationComplete,()=>{clearTimeout(o),n()})}),yield this.publisher.negotiate(d=>{clearTimeout(o),d instanceof Error?r(d):r(new Error(String(d)))})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTransceiverOfKind(e,n){return this.publisher.addTransceiverOfKind(e,n)}getMidForReceiver(e){const r=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(o=>o.receiver===e);return r?.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===On.PUBLISHER?this.publisher.getConnectedAddress():e===On.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return w(this,arguments,void 0,function(r,o){var c=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return(function*(){if(r.getConnectionState()!=="connected")return new Promise((f,h)=>w(c,void 0,void 0,function*(){const g=()=>{this.log.warn("abort transport connection",this.logContext),Ot.clearTimeout(v),h(he.cancelled("room connection has been cancelled"))};o?.signal.aborted&&g(),o?.signal.addEventListener("abort",g);const v=Ot.setTimeout(()=>{o?.signal.removeEventListener("abort",g),h(he.internal("could not establish pc connection"))},d);for(;this.state!==at.CONNECTED;)if(yield At(50),o?.signal.aborted){h(he.cancelled("room connection has been cancelled"));return}Ot.clearTimeout(v),o?.signal.removeEventListener("abort",g),f()}))})()})}}const OS=5e3,Kw=3e4;class Pe{static fetchRegionSettings(e,n,r){return w(this,void 0,void 0,function*(){const o=yield Pe.fetchLock.lock();try{const c=yield fetch("".concat(Jw(e),"/regions"),{headers:{authorization:"Bearer ".concat(n)},signal:r});if(c.ok){const d=gw(c.headers),u=d?d*1e3:OS;return{regionSettings:yield c.json(),updatedAtInMs:Date.now(),maxAgeInMs:u}}else throw c.status===401?he.notAllowed("Could not fetch region settings: ".concat(c.statusText),c.status):he.internal("Could not fetch region settings: ".concat(c.statusText))}catch(c){throw c instanceof he?c:r?.aborted?he.cancelled("Region fetching was aborted"):he.serverUnreachable("Could not fetch region settings, ".concat(c instanceof Error?"".concat(c.name,": ").concat(c.message):c))}finally{o()}})}static scheduleRefetch(e,n,r){return w(this,void 0,void 0,function*(){const o=Pe.settingsTimeouts.get(e.hostname);clearTimeout(o),Pe.settingsTimeouts.set(e.hostname,setTimeout(()=>w(this,void 0,void 0,function*(){try{const c=yield Pe.fetchRegionSettings(e,n);Pe.updateCachedRegionSettings(e,n,c)}catch(c){if(c instanceof he&&c.reason===Je.NotAllowed){Te.debug("token is not valid, cancelling auto region refresh");return}Te.debug("auto refetching of region settings failed",{error:c}),Pe.scheduleRefetch(e,n,r)}}),r))})}static updateCachedRegionSettings(e,n,r){Pe.cache.set(e.hostname,r),Pe.scheduleRefetch(e,n,r.maxAgeInMs)}static stopRefetch(e){const n=Pe.settingsTimeouts.get(e);n&&(clearTimeout(n),Pe.settingsTimeouts.delete(e))}static scheduleCleanup(e){let n=Pe.connectionTrackers.get(e);n&&(n.cleanupTimeout&&clearTimeout(n.cleanupTimeout),n.cleanupTimeout=setTimeout(()=>{const r=Pe.connectionTrackers.get(e);r&&r.connectionCount===0&&(Te.debug("stopping region refetch after disconnect delay",{hostname:e}),Pe.stopRefetch(e)),r&&(r.cleanupTimeout=void 0)},Kw))}static cancelCleanup(e){const n=Pe.connectionTrackers.get(e);n?.cleanupTimeout&&(clearTimeout(n.cleanupTimeout),n.cleanupTimeout=void 0)}notifyConnected(){const e=this.serverUrl.hostname;let n=Pe.connectionTrackers.get(e);n||(n={connectionCount:0},Pe.connectionTrackers.set(e,n)),n.connectionCount++,Pe.cancelCleanup(e)}notifyDisconnected(){const e=this.serverUrl.hostname,n=Pe.connectionTrackers.get(e);n&&(n.connectionCount=Math.max(0,n.connectionCount-1),n.connectionCount===0&&Pe.scheduleCleanup(e))}constructor(e,n){this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return Pr(this.serverUrl)}getServerUrl(){return this.serverUrl}fetchRegionSettings(e){return w(this,void 0,void 0,function*(){return Pe.fetchRegionSettings(this.serverUrl,this.token,e)})}getNextBestRegionUrl(e){return w(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");let n=Pe.cache.get(this.serverUrl.hostname);(!n||Date.now()-n.updatedAtInMs>n.maxAgeInMs)&&(n=yield this.fetchRegionSettings(e),Pe.updateCachedRegionSettings(this.serverUrl,this.token,n));const r=n.regionSettings.regions.filter(o=>!this.attemptedRegions.find(c=>c.url===o.url));if(r.length>0){const o=r[0];return this.attemptedRegions.push(o),Te.debug("next region: ".concat(o.region)),o.url}else return null})}resetAttempts(){this.attemptedRegions=[]}setServerReportedRegions(e){Pe.updateCachedRegionSettings(this.serverUrl,this.token,e)}}Pe.cache=new Map;Pe.settingsTimeouts=new Map;Pe.connectionTrackers=new Map;Pe.fetchLock=new Ut;function Jw(i){return"".concat(i.protocol.replace("ws","http"),"//").concat(i.host,"/settings")}class st extends Error{constructor(e,n,r){super(n),this.code=e,this.message=s0(n,st.MAX_MESSAGE_BYTES),this.data=r?s0(r,st.MAX_DATA_BYTES):void 0}static fromProto(e){return new st(e.code,e.message,e.data)}toProto(){return new Sb({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new st(st.ErrorCode[e],st.ErrorMessage[e],n)}}st.MAX_MESSAGE_BYTES=256;st.MAX_DATA_BYTES=15360;st.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};st.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const AS=15360;function Mh(i){return new TextEncoder().encode(i).length}function s0(i,e){if(Mh(i)<=e)return i;let n=0,r=i.length;const o=new TextEncoder;for(;n<r;){const c=Math.floor((n+r+1)/2);o.encode(i.slice(0,c)).length<=e?n=c:r=c-1}return i.slice(0,n)}const xh=2e3;function Tl(i,e){if(!e)return 0;let n,r;return"bytesReceived"in i?(n=i.bytesReceived,r=e.bytesReceived):"bytesSent"in i&&(n=i.bytesSent,r=e.bytesSent),n===void 0||r===void 0||i.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(i.timestamp-e.timestamp)}const Ph=typeof MediaRecorder<"u";class Qw{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const Xw=Ph?MediaRecorder:Qw;class Zw extends Xw{constructor(e,n){if(!Ph)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),n);let r,o;const c=()=>o===void 0,d=()=>{this.removeEventListener("dataavailable",r),this.removeEventListener("stop",d),this.removeEventListener("error",u),o?.close(),o=void 0},u=f=>{o?.error(f),this.removeEventListener("dataavailable",r),this.removeEventListener("stop",d),this.removeEventListener("error",u),o=void 0};this.byteStream=new ReadableStream({start:f=>{o=f,r=h=>w(this,void 0,void 0,function*(){let g;if(h.data.arrayBuffer){const v=yield h.data.arrayBuffer();g=new Uint8Array(v)}else if(h.data.byteArray)g=h.data.byteArray;else throw new Error("no data available!");c()||f.enqueue(g)}),this.addEventListener("dataavailable",r)},cancel:()=>{d()}}),this.addEventListener("stop",d),this.addEventListener("error",u)}}function Ww(){return Ph}const $w=1e3,eO=1e4;class DS extends J{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,c=arguments.length>4?arguments[4]:void 0;super(e,n,c),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Oh(()=>w(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>w(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ne.Ended,this)},this.reacquireTrack=!1,this.providedByUser=o,this.muteLock=new Ut,this.pauseUpstreamLock=new Ut,this.trackChangeLock=new Ut,this.trackChangeLock.lock().then(d=>w(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{d()}})),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==J.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return w(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(c=>{wr(this._mediaStreamTrack,c)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let o;if(this.processor&&e){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Tr(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),o=this.processor.processedTrack}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(o??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(c=>{Tr(o??e,c)}))})}waitForDimensions(){return w(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$w;return(function*(){var r;if(e.kind===J.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=Jt())===null||r===void 0?void 0:r.os)==="iOS"&&(yield At(10));const o=Date.now();for(;Date.now()-o<n;){const c=e.dimensions;if(c)return c;yield At(50)}throw new mi("unable to get track dimensions after timeout")})()})}setDeviceId(e){return w(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Wi(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Wi(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return w(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){if(e.source===J.Source.ScreenShare)return;const{deviceId:r,groupId:o}=e._mediaStreamTrack.getSettings(),c=e.kind===J.Kind.Audio?"audioinput":"videoinput";return n?Ct.getInstance().normalizeDeviceId(c,r,o):r})()})}mute(){return w(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return w(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return w(this,void 0,void 0,function*(){const r=yield this.trackChangeLock.lock();try{if(!this.sender)throw new mi("unable to replace an unpublished track");let o,c;return typeof n=="boolean"?o=n:n!==void 0&&(o=n.userProvidedTrack,c=n.stopProcessor),this.providedByUser=o??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),c&&this.processor&&(yield this.internalStopProcessor()),this}finally{r()}})}restart(e){return w(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:o}=e,c=kR(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const d={audio:!1,video:!1};this.kind===J.Kind.Video?d.video=r||o?{deviceId:r,facingMode:o}:!0:d.audio=r?Object.assign({deviceId:r},c):!0,this.attachedElements.forEach(h=>{wr(this.mediaStreamTrack,h)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const f=(yield navigator.mediaDevices.getUserMedia(d)).getTracks()[0];return this.kind===J.Kind.Video&&(yield f.applyConstraints(c)),f.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(f),this._constraints=e,this.emit(ne.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ne.Muted:ne.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return w(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),CS()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return w(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ne.UpstreamPaused,this);const r=Jt();if(r?.name==="Safari"&&qn(r.version,"12.0")<0)throw new Ch("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{n()}})}resumeUpstream(){return w(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ne.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{n()}})}getRTCStatsReport(){return w(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return w(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var c;const d=yield r.trackChangeLock.lock();try{r.log.debug("setting up processor",r.logContext);const u=document.createElement(r.kind),f={kind:r.kind,track:r._mediaStreamTrack,element:u,audioContext:r.audioContext};if(yield n.init(f),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.internalStopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Tr(r._mediaStreamTrack,u),u.muted=!0,u.play().catch(h=>{h instanceof DOMException&&h.name==="AbortError"?(r.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},r.logContext),{error:h})),setTimeout(()=>{u.play().catch(g=>{r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{err:g}))})},100)):r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:h}))}),r.processor=n,r.processorElement=u,r.processor.processedTrack){for(const h of r.attachedElements)h!==r.processorElement&&o&&(wr(r._mediaStreamTrack,h),Tr(r.processor.processedTrack,h));yield(c=r.sender)===null||c===void 0?void 0:c.replaceTrack(r.processor.processedTrack)}r.emit(ne.TrackProcessorUpdate,r.processor)}finally{d()}})()})}getProcessor(){return this.processor}stopProcessor(){return w(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){const r=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(n)}finally{r()}})()})}internalStopProcessor(){return w(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var r,o;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,n||((o=e.processorElement)===null||o===void 0||o.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(ne.TrackProcessorUpdate))})()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!Ww()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let n="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(n)||(n="video/mp4"),this.localTrackRecorder=new Zw(this,{mimeType:n})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},eO)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class rl extends DS{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0;super(e,J.Kind.Audio,n,r,c),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>w(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let d;try{d=yield this.getSenderStats()}catch(u){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:u}));return}d&&this.prevStats&&(this._currentBitrate=Tl(d,this.prevStats)),this.prevStats=d}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(ne.AudioTrackFeatureUpdate,this,Tt.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(ne.AudioTrackFeatureUpdate,this,Tt.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=o,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return w(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===J.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return w(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Wi(this._constraints.deviceId);return this.source===J.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return w(this,void 0,void 0,function*(){let n;if(e){const r=Eh({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return w(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){Kt()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},xh)))}setProcessor(e){return w(this,void 0,void 0,function*(){var n;const r=yield this.trackChangeLock.lock();try{if(!zn()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const o={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(o),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(ne.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return w(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(o=>{o.type==="outbound-rtp"&&(r={type:"audio",streamId:o.id,packetsSent:o.packetsSent,packetsLost:o.packetsLost,bytesSent:o.bytesSent,timestamp:o.timestamp,roundTripTime:o.roundTripTime,jitter:o.jitter})}),r})}checkForSilence(){return w(this,void 0,void 0,function*(){const e=yield bS(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(ne.AudioSilenceDetected)),e})}}function tO(i,e,n){switch(i.kind){case"audio":return new rl(i,e,!1,void 0,n);case"video":return new sl(i,e,!1,n);default:throw new mi("unsupported track type: ".concat(i.kind))}}const nO=Object.values(eo),iO=Object.values(jf),aO=Object.values(kh),rO=[eo.h180,eo.h360],sO=[jf.h180,jf.h360],oO=i=>[{scaleResolutionDownBy:2,fps:i.encoding.maxFramerate}].map(n=>{var r,o;return new He(Math.floor(i.width/n.scaleResolutionDownBy),Math.floor(i.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(i.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=i.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((o=n.fps)!==null&&o!==void 0?o:30))))),n.fps,i.encoding.priority)}),Kf=["q","h","f"];function Jf(i,e,n,r){var o,c;let d=r?.videoEncoding;i&&(d=r?.screenShareEncoding);const u=r?.simulcast,f=r?.scalabilityMode,h=r?.videoCodec;if(!d&&!u&&!f||!e||!n)return[{}];d||(d=lO(i,e,n,h),Te.debug("using video encoding",d));const g=d.maxFramerate,v=new He(e,n,d.maxBitrate,d.maxFramerate,d.priority);if(f&&An(h)){const _=new MS(f),C=[];if(_.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(f));const M=Jt();if(to()||zn()||M?.name==="Chrome"&&qn(M?.version,"113")<0){const R=_.suffix=="h"?2:3,B=aw(M);for(let q=0;q<_.spatial;q+=1)C.push({rid:Kf[2-q],maxBitrate:d.maxBitrate/Math.pow(R,q),maxFramerate:v.encoding.maxFramerate,scaleResolutionDownBy:B?Math.pow(2,q):void 0});C[0].scalabilityMode=f}else C.push({maxBitrate:d.maxBitrate,maxFramerate:v.encoding.maxFramerate,scalabilityMode:f});return v.encoding.priority&&(C[0].priority=v.encoding.priority,C[0].networkPriority=v.encoding.priority),Te.debug("using svc encoding",{encodings:C}),C}if(!u)return[d];let b=[];i?b=(o=c0(r?.screenShareSimulcastLayers))!==null&&o!==void 0?o:o0(i,v):b=(c=c0(r?.videoSimulcastLayers))!==null&&c!==void 0?c:o0(i,v);let T;if(b.length>0){const _=b[0];b.length>1&&([,T]=b);const C=Math.max(e,n);if(C>=960&&T)return pf(e,n,[_,T,v],g);if(C>=480)return pf(e,n,[_,v],g)}return pf(e,n,[v])}function cO(i,e,n){var r,o,c,d;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&Te.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const u=i.mediaStreamTrack.getSettings(),f=(r=u.width)!==null&&r!==void 0?r:(o=i.dimensions)===null||o===void 0?void 0:o.width,h=(c=u.height)!==null&&c!==void 0?c:(d=i.dimensions)===null||d===void 0?void 0:d.height;return i.source===J.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),Jf(i.source===J.Source.ScreenShare,f,h,n)}function lO(i,e,n,r){const o=uO(i,e,n);let{encoding:c}=o[0];const d=Math.max(e,n);for(let u=0;u<o.length;u+=1){const f=o[u];if(c=f.encoding,f.width>=d)break}if(r)switch(r){case"av1":case"h265":c=Object.assign({},c),c.maxBitrate=c.maxBitrate*.7;break;case"vp9":c=Object.assign({},c),c.maxBitrate=c.maxBitrate*.85;break}return c}function uO(i,e,n){if(i)return aO;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?nO:iO}function o0(i,e){if(i)return oO(e);const{width:n,height:r}=e,o=n>r?n/r:r/n;return Math.abs(o-16/9)<Math.abs(o-4/3)?rO:sO}function pf(i,e,n,r){const o=[];if(n.forEach((c,d)=>{if(d>=Kf.length)return;const u=Math.min(i,e),h={rid:Kf[d],scaleResolutionDownBy:Math.max(1,u/Math.min(c.width,c.height)),maxBitrate:c.encoding.maxBitrate},g=r&&c.encoding.maxFramerate?Math.min(r,c.encoding.maxFramerate):c.encoding.maxFramerate;g&&(h.maxFramerate=g);const v=Aa()||d===0;c.encoding.priority&&v&&(h.priority=c.encoding.priority,h.networkPriority=c.encoding.priority),o.push(h)}),zn()&&ES()==="ios"){let c;o.forEach(u=>{c?u.maxFramerate&&u.maxFramerate>c&&(c=u.maxFramerate):c=u.maxFramerate});let d=!0;o.forEach(u=>{var f;u.maxFramerate!=c&&(d&&(d=!1,Te.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),Te.info('Setting framerate of encoding "'.concat((f=u.rid)!==null&&f!==void 0?f:"",'" to ').concat(c)),u.maxFramerate=c)})}return o}function c0(i){if(i)return i.sort((e,n)=>{const{encoding:r}=e,{encoding:o}=n;return r.maxBitrate>o.maxBitrate?1:r.maxBitrate<o.maxBitrate?-1:r.maxBitrate===o.maxBitrate&&r.maxFramerate&&o.maxFramerate?r.maxFramerate>o.maxFramerate?1:-1:0})}class MS{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function dO(i){return i.source===J.Source.ScreenShare||i.constraints.height&&Wi(i.constraints.height)>=1080?"maintain-resolution":"balanced"}const fO=5e3;class sl extends DS{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0;super(e,J.Kind.Video,n,r,o),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>w(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let c;try{c=yield this.getSenderStats()}catch(f){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:f}));return}const d=new Map(c.map(f=>[f.rid,f])),u=c.some(f=>f.qualityLimitationReason==="cpu");if(u!==this.isCpuConstrained&&(this.isCpuConstrained=u,this.isCpuConstrained&&this.emit(ne.CpuConstrained)),this.prevStats){let f=0;d.forEach((h,g)=>{var v;const b=(v=this.prevStats)===null||v===void 0?void 0:v.get(g);f+=Tl(h,b)}),this._currentBitrate=f}this.prevStats=d}),this.senderLock=new Ut}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!Kt())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},xh))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return w(this,void 0,void 0,function*(){var n,r,o,c,d;yield e.pauseUpstream.call(this);try{for(var u=!0,f=hi(this.simulcastCodecs.values()),h;h=yield f.next(),n=h.done,!n;u=!0)c=h.value,u=!1,yield(d=c.sender)===null||d===void 0?void 0:d.replaceTrack(null)}catch(g){r={error:g}}finally{try{!u&&!n&&(o=f.return)&&(yield o.call(f))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return w(this,void 0,void 0,function*(){var n,r,o,c,d;yield e.resumeUpstream.call(this);try{for(var u=!0,f=hi(this.simulcastCodecs.values()),h;h=yield f.next(),n=h.done,!n;u=!0){c=h.value,u=!1;const g=c;yield(d=g.sender)===null||d===void 0?void 0:d.replaceTrack(g.mediaStreamTrack)}}catch(g){r={error:g}}finally{try{!u&&!n&&(o=f.return)&&(yield o.call(f))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return w(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===J.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return w(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===J.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return w(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(o=>{var c;if(o.type==="outbound-rtp"){const d={type:"video",streamId:o.id,frameHeight:o.frameHeight,frameWidth:o.frameWidth,framesPerSecond:o.framesPerSecond,framesSent:o.framesSent,firCount:o.firCount,pliCount:o.pliCount,nackCount:o.nackCount,packetsSent:o.packetsSent,bytesSent:o.bytesSent,qualityLimitationReason:o.qualityLimitationReason,qualityLimitationDurations:o.qualityLimitationDurations,qualityLimitationResolutionChanges:o.qualityLimitationResolutionChanges,rid:(c=o.rid)!==null&&c!==void 0?c:o.id,retransmittedPacketsSent:o.retransmittedPacketsSent,targetBitrate:o.targetBitrate,timestamp:o.timestamp},u=r.get(o.remoteId);u&&(d.jitter=u.jitter,d.packetsLost=u.packetsLost,d.roundTripTime=u.roundTripTime),n.push(d)}}),n.sort((o,c)=>{var d,u;return((d=c.frameWidth)!==null&&d!==void 0?d:0)-((u=o.frameWidth)!==null&&u!==void 0?u:0)}),n})}setPublishingQuality(e){const n=[];for(let r=sn.LOW;r<=sn.HIGH;r+=1)n.push(new yh({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(An(this.codec),n)}restartTrack(e){return w(this,void 0,void 0,function*(){var n,r,o,c,d;let u;if(e){const v=Eh({video:e});typeof v.video!="boolean"&&(u=v.video)}yield this.restart(u),this.isCpuConstrained=!1;try{for(var f=!0,h=hi(this.simulcastCodecs.values()),g;g=yield h.next(),n=g.done,!n;f=!0){c=g.value,f=!1;const v=c;v.sender&&((d=v.sender.transport)===null||d===void 0?void 0:d.state)!=="closed"&&(v.mediaStreamTrack=this.mediaStreamTrack.clone(),yield v.sender.replaceTrack(v.mediaStreamTrack))}}catch(v){r={error:v}}finally{try{!f&&!n&&(o=h.return)&&(yield o.call(h))}finally{if(r)throw r.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return w(this,arguments,void 0,function(r){var o=this;let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){var d,u,f,h,g,v;if(yield n.setProcessor.call(o,r,c),!((g=o.processor)===null||g===void 0)&&g.processedTrack)try{for(var b=!0,T=hi(o.simulcastCodecs.values()),_;_=yield T.next(),d=_.done,!d;b=!0)h=_.value,b=!1,yield(v=h.sender)===null||v===void 0?void 0:v.replaceTrack(o.processor.processedTrack)}catch(C){u={error:C}}finally{try{!b&&!d&&(f=T.return)&&(yield f.call(T))}finally{if(u)throw u.error}}})()})}setDegradationPreference(e){return w(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},fO))}setPublishingCodecs(e){return w(this,void 0,void 0,function*(){var n,r,o,c,d,u,f;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(An(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const h=[];try{for(n=!0,r=hi(e);o=yield r.next(),c=o.done,!c;n=!0){f=o.value,n=!1;const g=f;if(!this.codec||this.codec===g.codec)yield this.setPublishingLayers(An(g.codec),g.qualities);else{const v=this.simulcastCodecs.get(g.codec);if(this.log.debug("try setPublishingCodec for ".concat(g.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:v})),!v||!v.sender){for(const b of g.qualities)if(b.enabled){h.push(g.codec);break}}else v.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(g.codec),this.logContext),yield l0(v.sender,v.encodings,g.qualities,this.senderLock,An(g.codec),this.log,this.logContext))}}}catch(g){d={error:g}}finally{try{!n&&!c&&(u=r.return)&&(yield u.call(r))}finally{if(d)throw d.error}}return h})}setPublishingLayers(e,n){return w(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:n}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:n})),!(!this.sender||!this.encodings)&&(yield l0(this.sender,this.encodings,n,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return w(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const n=this.sender.getParameters();n.encodings=n.encodings.map((r,o)=>{var c;return Object.assign(Object.assign({},r),{active:o===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((c=this.mediaStreamTrack.getSettings().height)!==null&&c!==void 0?c:360)/360)),scalabilityMode:o===0&&An(this.codec)?"L1T3":void 0,maxFramerate:o===0?15:0,maxBitrate:o===0?r.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:n.encodings})),this.encodings=n.encodings,yield this.sender.setParameters(n)}catch(n){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:n})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return w(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),CS()&&this.isInBackground&&this.source===J.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function l0(i,e,n,r,o,c,d){return w(this,void 0,void 0,function*(){const u=yield r.lock();c.debug("setPublishingLayersForSender",Object.assign(Object.assign({},d),{sender:i,qualities:n,senderEncodings:e}));try{const f=i.getParameters(),{encodings:h}=f;if(!h)return;if(h.length!==e.length){c.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},d),{encodings:h,senderEncodings:e}));return}let g=!1;!1&&h[0].scalabilityMode||(o&&n.some(T=>T.enabled)&&n.forEach(T=>T.enabled=!0),h.forEach((b,T)=>{var _;let C=(_=b.rid)!==null&&_!==void 0?_:"";C===""&&(C="q");const M=xS(C),R=n.find(B=>B.quality===M);R&&b.active!==R.enabled&&(g=!0,b.active=R.enabled,c.debug("setting layer ".concat(R.quality," to ").concat(b.active?"enabled":"disabled"),d),Aa()&&(R.enabled?(b.scaleResolutionDownBy=e[T].scaleResolutionDownBy,b.maxBitrate=e[T].maxBitrate,b.maxFrameRate=e[T].maxFrameRate):(b.scaleResolutionDownBy=4,b.maxBitrate=10,b.maxFrameRate=2)))})),g&&(f.encodings=h,c.debug("setting encodings",Object.assign(Object.assign({},d),{encodings:f.encodings})),yield i.setParameters(f))}finally{u()}})}function xS(i){switch(i){case"f":return sn.HIGH;case"h":return sn.MEDIUM;case"q":return sn.LOW;default:return sn.HIGH}}function u0(i,e,n,r){if(!n)return[new Zi({quality:sn.HIGH,width:i,height:e,bitrate:0,ssrc:0})];if(r){const o=n[0].scalabilityMode,c=new MS(o),d=[],u=c.suffix=="h"?1.5:2,f=c.suffix=="h"?2:3;for(let h=0;h<c.spatial;h+=1)d.push(new Zi({quality:Math.min(sn.HIGH,c.spatial-1)-h,width:Math.ceil(i/Math.pow(u,h)),height:Math.ceil(e/Math.pow(u,h)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(f,h)):0,ssrc:0}));return d}return n.map(o=>{var c,d,u;const f=(c=o.scaleResolutionDownBy)!==null&&c!==void 0?c:1;let h=xS((d=o.rid)!==null&&d!==void 0?d:"");return new Zi({quality:h,width:Math.ceil(i/f),height:Math.ceil(e/f),bitrate:(u=o.maxBitrate)!==null&&u!==void 0?u:0,ssrc:0})})}const d0="_lossy",f0="_reliable",hO=2*1e3,gf="leave-reconnect",mO=3e4,pO=8*1024,gO=256*1024;var yn;(function(i){i[i.New=0]="New",i[i.Connected=1]="Connected",i[i.Disconnected=2]="Disconnected",i[i.Reconnecting=3]="Reconnecting",i[i.Closed=4]="Closed"})(yn||(yn={}));class vO extends Vn.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Dh.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=yn.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=Te,this.reliableDataSequence=1,this.reliableMessageBuffer=new Wy,this.reliableReceivedState=new Iw(mO),this.lossyDataStatCurrentBytes=0,this.lossyDataStatByterate=0,this.lossyDataDropCount=0,this.midToTrackId={},this.isWaitingForNetworkReconnect=!1,this.handleDataChannel=r=>w(this,[r],void 0,function(o){var c=this;let{channel:d}=o;return(function*(){if(d){if(d.label===f0)c.reliableDCSub=d;else if(d.label===d0)c.lossyDCSub=d;else return;c.log.debug("on data channel ".concat(d.id,", ").concat(d.label),c.logContext),d.onmessage=c.handleDataMessage}})()}),this.handleDataMessage=r=>w(this,void 0,void 0,function*(){var o,c,d,u,f;const h=yield this.dataProcessLock.lock();try{let g;if(r.data instanceof ArrayBuffer)g=r.data;else if(r.data instanceof Blob)g=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const v=Lt.fromBinary(new Uint8Array(g));if(v.sequence>0&&v.participantSid!==""){const b=this.reliableReceivedState.get(v.participantSid);if(b&&v.sequence<=b)return;this.reliableReceivedState.set(v.participantSid,v.sequence)}if(((o=v.value)===null||o===void 0?void 0:o.case)==="speaker")this.emit(re.ActiveSpeakersUpdate,v.value.value.speakers);else if(((c=v.value)===null||c===void 0?void 0:c.case)==="encryptedPacket"){if(!this.e2eeManager){this.log.error("Received encrypted packet but E2EE not set up",this.logContext);return}const b=yield(d=this.e2eeManager)===null||d===void 0?void 0:d.handleEncryptedData(v.value.value.encryptedValue,v.value.value.iv,v.participantIdentity,v.value.value.keyIndex),T=vb.fromBinary(b.payload),_=new Lt({value:T.value,participantIdentity:v.participantIdentity,participantSid:v.participantSid});((u=_.value)===null||u===void 0?void 0:u.case)==="user"&&h0(_,_.value.value),this.emit(re.DataPacketReceived,_,v.value.value.encryptionType)}else((f=v.value)===null||f===void 0?void 0:f.case)==="user"&&h0(v,v.value.value),this.emit(re.DataPacketReceived,v,yt.NONE)}finally{h()}}),this.handleDataError=r=>{const c=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:d}=r.error;this.log.error("DataChannel error on ".concat(c,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:d}))}else this.log.error("Unknown DataChannel error on ".concat(c),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const c=r.currentTarget.maxRetransmits===0?ke.LOSSY:ke.RELIABLE;this.updateAndEmitDCBufferStatus(c)},this.handleDisconnect=(r,o)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const c=f=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(f,"ms. giving up"),this.logContext),this.emit(re.Disconnected),this.close()},d=Date.now()-this.reconnectStart;let u=this.getNextRetryDelay({elapsedMs:d,retryCount:this.reconnectAttempts});if(u===null){c(d);return}r===gf&&(u=0),this.log.debug("reconnecting in ".concat(u,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=Ot.setTimeout(()=>this.attemptReconnect(o).finally(()=>this.reconnectTimeout=void 0),u)},this.waitForRestarted=()=>new Promise((r,o)=>{this.pcState===yn.Connected&&r();const c=()=>{this.off(re.Disconnected,d),r()},d=()=>{this.off(re.Restarted,c),o()};this.once(re.Restarted,c),this.once(re.Disconnected,d)}),this.updateAndEmitDCBufferStatus=r=>{if(r===ke.RELIABLE){const c=this.dataChannelForKind(r);c&&this.reliableMessageBuffer.alignBufferedAmount(c.bufferedAmount)}const o=this.isBufferStatusLow(r);typeof o<"u"&&o!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,o),this.emit(re.DCBufferStatusChanged,o,r))},this.isBufferStatusLow=r=>{const o=this.dataChannelForKind(r);if(o)return o.bufferedAmount<=o.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>w(this,void 0,void 0,function*(){!this.url||!(yield fetch(no(this.url),{method:"HEAD"}).then(o=>o.ok).catch(()=>!1))||(this.log.info("detected network reconnected"),(this.client.currentState===Ke.RECONNECTING||this.isWaitingForNetworkReconnect&&this.client.currentState===Ke.CONNECTED)&&(this.clearReconnectTimeout(),this.attemptReconnect(_a.RR_SIGNAL_DISCONNECTED),this.isWaitingForNetworkReconnect=!1))}),this.handleBrowserOffline=()=>w(this,void 0,void 0,function*(){if(this.url)try{yield Promise.race([fetch(no(this.url),{method:"HEAD"}),At(4e3).then(()=>Promise.reject())])}catch{window.navigator.onLine===!1&&(this.log.info("detected network interruption"),this.isWaitingForNetworkReconnect=!0)}}),this.log=vi((n=e.loggerName)!==null&&n!==void 0?n:Mn.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Rh(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new Ut,this.dataProcessLock=new Ut,this.dcBufferStatus=new Map([[ke.LOSSY,!0],[ke.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(re.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(re.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(re.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(re.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(re.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(re.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(re.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(re.SignalRequestResponse,r)}get logContext(){var e,n,r,o,c,d;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(o=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||o===void 0?void 0:o.sid,participant:(d=(c=this.latestJoinResponse)===null||c===void 0?void 0:c.participant)===null||d===void 0?void 0:d.identity,pID:this.participantSid}}join(e,n,r,o){return w(this,arguments,void 0,function(c,d,u,f){var h=this;let g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return(function*(){h.url=c,h.token=d,h.signalOpts=u,h.maxJoinAttempts=u.maxRetries;try{h.joinAttempts+=1,h.setupSignalClientCallbacks();const v=yield h.client.join(c,d,u,f,g);return h._isClosed=!1,h.latestJoinResponse=v,h.subscriberPrimary=v.subscriberPrimary,h.pcManager||(yield h.configure(v,!g)),(!h.subscriberPrimary||v.fastPublish)&&h.negotiate().catch(b=>{Te.error(b,h.logContext)}),h.registerOnLineListener(),h.clientConfiguration=v.clientConfiguration,h.emit(re.SignalConnected,v),v}catch(v){if(v instanceof he){if(v.reason===Je.ServerUnreachable){if(h.log.warn("Couldn't connect to server, attempt ".concat(h.joinAttempts," of ").concat(h.maxJoinAttempts),h.logContext),h.joinAttempts<h.maxJoinAttempts)return h.join(c,d,u,f,g)}else if(v.reason===Je.ServiceNotFound)return h.log.warn("Initial connection failed: ".concat(v.message,"  Retrying")),h.join(c,d,u,f,!0)}throw v}})()})}close(){return w(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(re.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.cleanupLossyDataStats(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return w(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Wy,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupLossyDataStats(){this.lossyDataStatByterate=0,this.lossyDataStatCurrentBytes=0,this.lossyDataStatInterval&&(clearInterval(this.lossyDataStatInterval),this.lossyDataStatInterval=void 0),this.lossyDataDropCount=0}cleanupClient(){return w(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new mi("a track with the same ID has already been published");return new Promise((n,r)=>{const o=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(he.timeout("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:c=>{clearTimeout(o),n(c)},reject:()=>{clearTimeout(o),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return w(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e,n){return w(this,void 0,void 0,function*(){var r,o;if(this.pcManager&&this.pcManager.currentState!==at.NEW)return;this.participantSid=(r=e.participant)===null||r===void 0?void 0:r.sid;const c=this.makeRTCConfiguration(e);this.pcManager=new Yw(c,n?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(re.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(d,u)=>{this.client.sendIceCandidate(d,u)},this.pcManager.onPublisherOffer=(d,u)=>{this.client.sendOffer(d,u)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(d,u,f)=>w(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(d),this.logContext),["closed","disconnected","failed"].includes(u)&&(this.publisherConnectionPromise=void 0),d===at.CONNECTED){const v=this.pcState===yn.New;this.pcState=yn.Connected,v&&this.emit(re.Connected,e)}else d===at.FAILED&&(this.pcState===yn.Connected||this.pcState===yn.Reconnecting)&&(this.pcState=yn.Disconnected,this.handleDisconnect("peerconnection failed",f==="failed"?_a.RR_SUBSCRIBER_FAILED:_a.RR_PUBLISHER_FAILED));const h=this.client.isDisconnected||this.client.currentState===Ke.RECONNECTING,g=[at.FAILED,at.CLOSING,at.CLOSED].includes(d);h&&g&&!this._isClosed&&this.emit(re.Offline)}),this.pcManager.onTrack=d=>{d.streams.length!==0&&this.emit(re.MediaTrackAdded,d.track,d.streams[0],d.receiver)},yO((o=e.serverInfo)===null||o===void 0?void 0:o.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,n,r)=>w(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:r})),this.midToTrackId=r,yield this.pcManager.setPublisherAnswer(e,n))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=(e,n,r)=>w(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=n,!this.pcManager)return;this.midToTrackId=r;const o=yield this.pcManager.createSubscriberAnswerFromOffer(e,n);o&&this.client.sendAnswer(o,n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(re.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(re.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{var n;this.token=e,(n=this.regionUrlProvider)===null||n===void 0||n.updateToken(e)},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(re.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(re.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var n;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(re.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var n,r;const o={direction:"recvonly"};for(let c=0;c<e.numAudios;c++)(n=this.pcManager)===null||n===void 0||n.addPublisherTransceiverOfKind("audio",o);for(let c=0;c<e.numVideos;c++)(r=this.pcManager)===null||r===void 0||r.addPublisherTransceiverOfKind("video",o);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",_a.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e?.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions({updatedAtInMs:Date.now(),maxAgeInMs:OS,regionSettings:e.regions})),e.action){case Er.DISCONNECT:this.emit(re.Disconnected,e?.reason),this.close();break;case Er.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(gf);break;case Er.RESUME:this.handleDisconnect(gf)}}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const o=[];e.iceServers.forEach(c=>{const d={urls:c.urls};c.username&&(d.username=c.username),c.credential&&(d.credential=c.credential),o.push(d)}),r.iceServers=o}return e.clientConfiguration&&e.clientConfiguration.forceRelay===Xs.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(d0,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(f0,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow,this.cleanupLossyDataStats(),this.lossyDataStatInterval=setInterval(()=>{this.lossyDataStatByterate=this.lossyDataStatCurrentBytes,this.lossyDataStatCurrentBytes=0;const e=this.dataChannelForKind(ke.LOSSY);if(e){const n=this.lossyDataStatByterate/10;e.bufferedAmountLowThreshold=Math.min(Math.max(n,pO),gO)}},1e3))}createSender(e,n,r){return w(this,void 0,void 0,function*(){if(qf())return yield this.createTransceiverRTCRtpSender(e,n,r);if(Vf())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new lt("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,o){return w(this,void 0,void 0,function*(){if(qf())return this.createSimulcastTransceiverSender(e,n,r,o);if(Vf())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new lt("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return w(this,void 0,void 0,function*(){if(!this.pcManager)throw new lt("publisher is closed");const o=[];e.mediaStream&&o.push(e.mediaStream),aa(e)&&(e.codec=n.videoCodec);const c={direction:"sendonly",streams:o};return r&&(c.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,c)).sender})}createSimulcastTransceiverSender(e,n,r,o){return w(this,void 0,void 0,function*(){if(!this.pcManager)throw new lt("publisher is closed");const c={direction:"sendonly"};o&&(c.sendEncodings=o);const d=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,c);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,d.sender),d.sender})}createRTCRtpSender(e){return w(this,void 0,void 0,function*(){if(!this.pcManager)throw new lt("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return w(this,void 0,void 0,function*(){var n,r,o;if(!this._isClosed){if(this.attemptingReconnect){Te.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===Xs.DISABLED||((o=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&o!==void 0?o:at.NEW)===at.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(c){this.reconnectAttempts+=1;let d=!0;c instanceof lt?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:c})),d=!1):c instanceof br||(this.fullReconnectOnNext=!0),d?this.handleDisconnect("reconnect",_a.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(re.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return w(this,void 0,void 0,function*(){var n,r,o;try{if(!this.url||!this.token)throw new lt("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(re.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let c;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new br;c=yield this.join(e??this.url,this.token,this.signalOpts,void 0,!this.options.singlePeerConnection)}catch(d){throw d instanceof he&&d.reason===Je.NotAllowed?new lt("could not reconnect, token might be expired"):new br}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(re.SignalRestarted,c),yield this.waitForPCReconnected(),this.client.currentState!==Ke.CONNECTED)throw new br("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(re.Restarted)}catch(c){const d=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(d){yield this.restartConnection(d);return}else throw(o=this.regionUrlProvider)===null||o===void 0||o.resetAttempts(),c}})}resumeConnection(e){return w(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new lt("could not reconnect, url or token not saved");if(!this.pcManager)throw new lt("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(re.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(o){let c="";throw o instanceof Error&&(c=o.message,this.log.error(o.message,Object.assign(Object.assign({},this.logContext),{error:o}))),o instanceof he&&o.reason===Je.NotAllowed?new lt("could not reconnect, token might be expired"):o instanceof he&&o.reason===Je.LeaveRequest?o:new br(c)}if(this.emit(re.SignalResumed),r){const o=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(o),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=r.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Ke.CONNECTED)throw new br("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),r?.lastMessageSeq&&this.resendReliableMessagesForResume(r.lastMessageSeq),this.emit(re.Resumed)})}waitForPCInitialConnection(e,n){return w(this,void 0,void 0,function*(){if(!this.pcManager)throw new lt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return w(this,void 0,void 0,function*(){this.pcState=yn.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield At(hO),!this.pcManager)throw new lt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=yn.Connected}catch(e){throw this.pcState=yn.Disconnected,he.internal("could not establish PC connection, ".concat(e.message))}})}publishRpcResponse(e,n,r,o){return w(this,void 0,void 0,function*(){const c=new Lt({destinationIdentities:[e],kind:ke.RELIABLE,value:{case:"rpcResponse",value:new mh({requestId:n,value:o?{case:"error",value:o.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(c,ke.RELIABLE)})}publishRpcAck(e,n){return w(this,void 0,void 0,function*(){const r=new Lt({destinationIdentities:[e],kind:ke.RELIABLE,value:{case:"rpcAck",value:new hh({requestId:n})}});yield this.sendDataPacket(r,ke.RELIABLE)})}sendDataPacket(e,n){return w(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(n),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const c=Rw(e);if(c){const d=yield this.e2eeManager.encryptData(c.toBinary());e.value={case:"encryptedPacket",value:new gb({encryptedValue:d.payload,iv:d.iv,keyIndex:d.keyIndex})}}}n===ke.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const r=e.toBinary(),o=this.dataChannelForKind(n);if(o){if(n===ke.RELIABLE)yield this.waitForBufferStatusLow(n),this.reliableMessageBuffer.push({data:r,sequence:e.sequence});else{if(!this.isBufferStatusLow(n)){this.lossyDataDropCount+=1,this.lossyDataDropCount%100===0&&this.log.warn("dropping lossy data channel messages, total dropped: ".concat(this.lossyDataDropCount),this.logContext);return}this.lossyDataStatCurrentBytes+=r.byteLength}if(this.attemptingReconnect)return;o.send(r)}this.updateAndEmitDCBufferStatus(n)})}resendReliableMessagesForResume(e){return w(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(ke.RELIABLE);const n=this.dataChannelForKind(ke.RELIABLE);n&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(r=>{n.send(r.data)})),this.updateAndEmitDCBufferStatus(ke.RELIABLE)})}waitForBufferStatusLow(e){return new Yt((n,r)=>w(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))n();else{const o=()=>r(new lt("engine closed"));for(this.once(re.Closing,o);!this.dcBufferStatus.get(e);)yield At(10);this.off(re.Closing,o),n()}}))}ensureDataTransportConnected(e){return w(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return(function*(){var c;if(!r.pcManager)throw new lt("PC manager is closed");const d=o?r.pcManager.subscriber:r.pcManager.publisher,u=o?"Subscriber":"Publisher";if(!d)throw he.internal("".concat(u," connection not set"));let f=!1;!o&&!r.dataChannelForKind(n,o)&&(r.createDataChannels(),f=!0),!f&&!o&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(f=!0),f&&r.negotiate().catch(v=>{Te.error(v,r.logContext)});const h=r.dataChannelForKind(n,o);if(h?.readyState==="open")return;const g=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<g;){if(d.isICEConnected&&((c=r.dataChannelForKind(n,o))===null||c===void 0?void 0:c.readyState)==="open")return;yield At(50)}throw he.internal("could not establish ".concat(u," connection, state: ").concat(d.getICEConnectionState()))})()})}ensurePublisherConnected(e){return w(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==at.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return w(this,void 0,void 0,function*(){return new Yt((e,n)=>w(this,void 0,void 0,function*(){if(!this.pcManager){n(new Rr("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,o=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n(new Rr("cannot negotiate on closed engine")),this.on(re.Closing,o),this.pcManager.publisher.once(Dr.RTPVideoPayloadTypes,c=>{const d=new Map;c.forEach(u=>{const f=u.codec.toLowerCase();lw(f)&&d.set(u.payload,f)}),this.emit(re.RTPVideoMapUpdate,d)});try{yield this.pcManager.negotiate(r),e()}catch(c){c instanceof Rr&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",_a.RR_UNKNOWN),c instanceof Error?n(c):n(new Error(String(c)))}finally{this.off(re.Closing,o)}}))})}dataChannelForKind(e,n){if(n){if(e===ke.LOSSY)return this.lossyDCSub;if(e===ke.RELIABLE)return this.reliableDCSub}else{if(e===ke.LOSSY)return this.lossyDC;if(e===ke.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,o,c,d;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const u=this.pcManager.publisher.getLocalDescription(),f=this.pcManager.publisher.getRemoteDescription(),h=(r=this.pcManager.subscriber)===null||r===void 0?void 0:r.getRemoteDescription(),g=(o=this.pcManager.subscriber)===null||o===void 0?void 0:o.getLocalDescription(),v=(d=(c=this.signalOpts)===null||c===void 0?void 0:c.autoSubscribe)!==null&&d!==void 0?d:!0,b=new Array,T=new Array;e.forEach(_=>{_.isDesired!==v&&b.push(_.trackSid),_.isEnabled||T.push(_.trackSid)}),this.client.sendSyncState(new bh({answer:this.pcManager.mode==="publisher-only"?f?Cr({sdp:f.sdp,type:f.type}):void 0:g?Cr({sdp:g.sdp,type:g.type}):void 0,offer:this.pcManager.mode==="publisher-only"?u?Cr({sdp:u.sdp,type:u.type}):void 0:h?Cr({sdp:h.sdp,type:h.type}):void 0,subscription:new yl({trackSids:b,subscribe:!v,participantTracks:[]}),publishTracks:YR(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:T,datachannelReceiveStates:this.reliableReceivedState.map((_,C)=>new Ub({publisherSid:C,lastSeq:_}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,o)=>{r?.id!==void 0&&r.id!==null&&e.push(new Ib({label:r.label,id:r.id,target:o}))};return n(this.dataChannelForKind(ke.LOSSY),On.PUBLISHER),n(this.dataChannelForKind(ke.RELIABLE),On.PUBLISHER),n(this.dataChannelForKind(ke.LOSSY,!0),On.SUBSCRIBER),n(this.dataChannelForKind(ke.RELIABLE,!0),On.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&Ot.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Kt()&&(window.addEventListener("online",this.handleBrowserOnLine),window.addEventListener("offline",this.handleBrowserOffline))}deregisterOnLineListener(){Kt()&&(window.removeEventListener("online",this.handleBrowserOnLine),window.removeEventListener("offline",this.handleBrowserOffline))}getTrackIdForReceiver(e){var n;const r=(n=this.pcManager)===null||n===void 0?void 0:n.getMidForReceiver(e);if(r){const o=Object.entries(this.midToTrackId).find(c=>{let[d]=c;return d===r});if(o)return o[1]}}}function yO(i){return i!==void 0&&i>13}function h0(i,e){const n=i.participantIdentity?i.participantIdentity:e.participantIdentity;i.participantIdentity=n,e.participantIdentity=n;const r=i.destinationIdentities.length!==0?i.destinationIdentities:e.destinationIdentities;i.destinationIdentities=r,e.destinationIdentities=r}class PS{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(typeof this.totalByteSize!="number"||this.totalByteSize===0)){if(e&&this.bytesReceived<this.totalByteSize)throw new bn("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),Nt.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new bn("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),Nt.LengthExceeded)}}constructor(e,n,r,o){this.reader=n,this.totalByteSize=r,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=o}}class bO extends PS{handleChunkReceived(e){var n;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();let n=new Sn,r=null,o=null;if(this.signal){const d=this.signal;o=()=>{var u;(u=n.reject)===null||u===void 0||u.call(n,d.reason)},d.addEventListener("abort",o),r=d}const c=()=>{e.releaseLock(),r&&o&&r.removeEventListener("abort",o),this.signal=void 0};return{next:()=>w(this,void 0,void 0,function*(){var d,u;try{const{done:f,value:h}=yield Promise.race([e.read(),n.promise,(u=(d=this.outOfBandFailureRejectingFuture)===null||d===void 0?void 0:d.promise)!==null&&u!==void 0?u:new Promise(()=>{})]);return f?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(h),{done:!1,value:h.content})}catch(f){throw c(),f}}),return(){return w(this,void 0,void 0,function*(){return c(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return w(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var r,o,c,d;let u=new Set;const f=n.signal?e.withAbortSignal(n.signal):e;try{for(var h=!0,g=hi(f),v;v=yield g.next(),r=v.done,!r;h=!0){d=v.value,h=!1;const b=d;u.add(b)}}catch(b){o={error:b}}finally{try{!h&&!r&&(c=g.return)&&(yield c.call(g))}finally{if(o)throw o.error}}return Array.from(u)})()})}}class SO extends PS{constructor(e,n,r,o){super(e,n,r,o),this.receivedChunks=new Map}handleChunkReceived(e){var n;const r=Qc(e.chunkIndex),o=this.receivedChunks.get(r);if(o&&o.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const c=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,c)}[Symbol.asyncIterator](){const e=this.reader.getReader(),n=new TextDecoder("utf-8",{fatal:!0});let r=new Sn,o=null,c=null;if(this.signal){const u=this.signal;c=()=>{var f;(f=r.reject)===null||f===void 0||f.call(r,u.reason)},u.addEventListener("abort",c),o=u}const d=()=>{e.releaseLock(),o&&c&&o.removeEventListener("abort",c),this.signal=void 0};return{next:()=>w(this,void 0,void 0,function*(){var u,f;try{const{done:h,value:g}=yield Promise.race([e.read(),r.promise,(f=(u=this.outOfBandFailureRejectingFuture)===null||u===void 0?void 0:u.promise)!==null&&f!==void 0?f:new Promise(()=>{})]);if(h)return this.validateBytesReceived(!0),{done:!0,value:void 0};{this.handleChunkReceived(g);let v;try{v=n.decode(g.content)}catch(b){throw new bn("Cannot decode datastream chunk ".concat(g.chunkIndex," as text: ").concat(b),Nt.DecodeFailed)}return{done:!1,value:v}}}catch(h){throw d(),h}}),return(){return w(this,void 0,void 0,function*(){return d(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return w(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(function*(){var r,o,c,d;let u="";const f=n.signal?e.withAbortSignal(n.signal):e;try{for(var h=!0,g=hi(f),v;v=yield g.next(),r=v.done,!r;h=!0)d=v.value,h=!1,u+=d}catch(b){o={error:b}}finally{try{!h&&!r&&(c=g.return)&&(yield c.call(g))}finally{if(o)throw o.error}}return u})()})}}class TO{constructor(){this.log=Te,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,n){if(this.textStreamHandlers.has(e))throw new bn('A text stream handler for topic "'.concat(e,'" has already been set.'),Nt.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,n)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,n){if(this.byteStreamHandlers.has(e))throw new bn('A byte stream handler for topic "'.concat(e,'" has already been set.'),Nt.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,n)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear()}validateParticipantHasNoActiveDataStreams(e){var n,r,o,c;const d=Array.from(this.textStreamControllers.entries()).filter(f=>f[1].sendingParticipantIdentity===e),u=Array.from(this.byteStreamControllers.entries()).filter(f=>f[1].sendingParticipantIdentity===e);if(d.length>0||u.length>0){const f=new bn("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),Nt.AbnormalEnd);for(const[h,g]of u)(r=(n=g.outOfBandFailureRejectingFuture).reject)===null||r===void 0||r.call(n,f),this.byteStreamControllers.delete(h);for(const[h,g]of d)(c=(o=g.outOfBandFailureRejectingFuture).reject)===null||c===void 0||c.call(o,f),this.textStreamControllers.delete(h)}}handleDataStreamPacket(e,n){return w(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,n);case"streamChunk":return this.handleStreamChunk(e.value.value,n);case"streamTrailer":return this.handleStreamTrailer(e.value.value,n);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,n,r){return w(this,void 0,void 0,function*(){var o;if(e.contentHeader.case==="byteHeader"){const c=this.byteStreamHandlers.get(e.topic);if(!c){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let d;const u=new Sn;u.promise.catch(g=>{this.log.error(g)});const f={id:e.streamId,name:(o=e.contentHeader.value.name)!==null&&o!==void 0?o:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Qc(e.timestamp),attributes:e.attributes,encryptionType:r},h=new ReadableStream({start:g=>{if(d=g,this.textStreamControllers.has(e.streamId))throw new bn("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Nt.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:f,controller:d,startTime:Date.now(),sendingParticipantIdentity:n,outOfBandFailureRejectingFuture:u})}});c(new bO(f,h,Qc(e.totalLength),u),{identity:n})}else if(e.contentHeader.case==="textHeader"){const c=this.textStreamHandlers.get(e.topic);if(!c){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let d;const u=new Sn;u.promise.catch(g=>{this.log.error(g)});const f={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:r},h=new ReadableStream({start:g=>{if(d=g,this.textStreamControllers.has(e.streamId))throw new bn("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Nt.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:f,controller:d,startTime:Date.now(),sendingParticipantIdentity:n,outOfBandFailureRejectingFuture:u})}});c(new SO(f,h,Qc(e.totalLength),u),{identity:n})}})}handleStreamChunk(e,n){const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==n?(r.controller.error(new bn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(r.info.encryptionType),Nt.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&r.controller.enqueue(e));const o=this.textStreamControllers.get(e.streamId);o&&(o.info.encryptionType!==n?(o.controller.error(new bn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(o.info.encryptionType),Nt.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&o.controller.enqueue(e))}handleStreamTrailer(e,n){const r=this.textStreamControllers.get(e.streamId);r&&(r.info.encryptionType!==n?r.controller.error(new bn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(r.info.encryptionType),Nt.EncryptionTypeMismatch)):(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.textStreamControllers.delete(e.streamId)));const o=this.byteStreamControllers.get(e.streamId);o&&(o.info.encryptionType!==n?o.controller.error(new bn("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(n,", got ").concat(o.info.encryptionType),Nt.EncryptionTypeMismatch)):(o.info.attributes=Object.assign(Object.assign({},o.info.attributes),e.attributes),o.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class NS{constructor(e,n,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=n}write(e){return this.defaultWriter.write(e)}close(){return w(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class CO extends NS{}class kO extends NS{}const m0=15e3;class EO{constructor(e,n){this.engine=e,this.log=n}setupEngine(e){this.engine=e}sendText(e,n){return w(this,void 0,void 0,function*(){var r;const o=crypto.randomUUID(),d=new TextEncoder().encode(e).byteLength,u=(r=n?.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),f=new Array(u?u.length+1:1).fill(0),h=(v,b)=>{var T;f[b]=v;const _=f.reduce((C,M)=>C+M,0);(T=n?.onProgress)===null||T===void 0||T.call(n,_)},g=yield this.streamText({streamId:o,totalSize:d,destinationIdentities:n?.destinationIdentities,topic:n?.topic,attachedStreamIds:u,attributes:n?.attributes});return yield g.write(e),h(1,0),yield g.close(),n?.attachments&&u&&(yield Promise.all(n.attachments.map((v,b)=>w(this,void 0,void 0,function*(){return this._sendFile(u[b],v,{topic:n.topic,mimeType:v.type,onProgress:T=>{h(T,b+1)}})})))),g.info})}streamText(e){return w(this,void 0,void 0,function*(){var n,r,o;const c=(n=e?.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),d={id:c,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e?.topic)!==null&&r!==void 0?r:"",size:e?.totalSize,attributes:e?.attributes,encryptionType:!((o=this.engine.e2eeManager)===null||o===void 0)&&o.isDataChannelEncryptionEnabled?yt.GCM:yt.NONE},u=new nl({streamId:c,mimeType:d.mimeType,topic:d.topic,timestamp:Ra(d.timestamp),totalLength:Ra(e?.totalSize),attributes:d.attributes,contentHeader:{case:"textHeader",value:new Ob({version:e?.version,attachedStreamIds:e?.attachedStreamIds,replyToStreamId:e?.replyToStreamId,operationType:e?.type==="update"?wf.UPDATE:wf.CREATE})}}),f=e?.destinationIdentities,h=new Lt({destinationIdentities:f,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(h,ke.RELIABLE);let g=0;const v=this.engine,b=new WritableStream({write(C){return w(this,void 0,void 0,function*(){for(const M of pw(C,m0)){const R=new il({content:M,streamId:c,chunkIndex:Ra(g)}),B=new Lt({destinationIdentities:f,value:{case:"streamChunk",value:R}});yield v.sendDataPacket(B,ke.RELIABLE),g+=1}})},close(){return w(this,void 0,void 0,function*(){const C=new al({streamId:c}),M=new Lt({destinationIdentities:f,value:{case:"streamTrailer",value:C}});yield v.sendDataPacket(M,ke.RELIABLE)})},abort(C){console.log("Sink error:",C)}});let T=()=>w(this,void 0,void 0,function*(){yield _.close()});v.once(re.Closing,T);const _=new CO(b,d,()=>this.engine.off(re.Closing,T));return _})}sendFile(e,n){return w(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,n),{id:r}})}_sendFile(e,n,r){return w(this,void 0,void 0,function*(){var o;const c=yield this.streamBytes({streamId:e,totalSize:n.size,name:n.name,mimeType:(o=r?.mimeType)!==null&&o!==void 0?o:n.type,topic:r?.topic,destinationIdentities:r?.destinationIdentities}),d=n.stream().getReader();for(;;){const{done:u,value:f}=yield d.read();if(u)break;yield c.write(f)}return yield c.close(),c.info})}streamBytes(e){return w(this,void 0,void 0,function*(){var n,r,o,c,d,u;const f=(n=e?.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),h=e?.destinationIdentities,g={id:f,mimeType:(r=e?.mimeType)!==null&&r!==void 0?r:"application/octet-stream",topic:(o=e?.topic)!==null&&o!==void 0?o:"",timestamp:Date.now(),attributes:e?.attributes,size:e?.totalSize,name:(c=e?.name)!==null&&c!==void 0?c:"unknown",encryptionType:!((d=this.engine.e2eeManager)===null||d===void 0)&&d.isDataChannelEncryptionEnabled?yt.GCM:yt.NONE},v=new nl({totalLength:Ra((u=g.size)!==null&&u!==void 0?u:0),mimeType:g.mimeType,streamId:f,topic:g.topic,timestamp:Ra(Date.now()),attributes:g.attributes,contentHeader:{case:"byteHeader",value:new Ab({name:g.name})}}),b=new Lt({destinationIdentities:h,value:{case:"streamHeader",value:v}});yield this.engine.sendDataPacket(b,ke.RELIABLE);let T=0;const _=new Ut,C=this.engine,M=this.log,R=new WritableStream({write(q){return w(this,void 0,void 0,function*(){const E=yield _.lock();let k=0;try{for(;k<q.byteLength;){const D=q.slice(k,k+m0),L=new Lt({destinationIdentities:h,value:{case:"streamChunk",value:new il({content:D,streamId:f,chunkIndex:Ra(T)})}});yield C.sendDataPacket(L,ke.RELIABLE),T+=1,k+=D.byteLength}}finally{E()}})},close(){return w(this,void 0,void 0,function*(){const q=new al({streamId:f}),E=new Lt({destinationIdentities:h,value:{case:"streamTrailer",value:q}});yield C.sendDataPacket(E,ke.RELIABLE)})},abort(q){M.error("Sink error:",q)}});return new kO(R,g)})}}class LS extends J{constructor(e,n,r,o,c){super(e,r,c),this.sid=n,this.receiver=o}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ne.Muted:ne.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(ne.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return w(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),xh)),KR()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(r){const{timestamp:o,rtpTimestamp:c}=r;c&&this.rtpTimestamp!==c&&(this.emit(ne.TimeSyncUpdate,{timestamp:o,rtpTimestamp:c}),this.rtpTimestamp=c)}};e()}}class US extends LS{constructor(e,n,r,o,c,d){super(e,n,J.Kind.Audio,r,d),this.monitorReceiver=()=>w(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=Tl(u,this.prevStats)),this.prevStats=u}),this.audioContext=o,this.webAudioPluginNodes=[],c&&(this.sinkId=c.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;zn()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(zn())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return w(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(Ff(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&Ff(e)&&e.setSinkId(this.sinkId).catch(r=>{this.log.error("Failed to set sink id on remote audio track",r,this.logContext)}),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(o=>{r.connect(o),r=o}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ne.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(o=>{this.emit(ne.AudioPlaybackFailed,o)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return w(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const vf=100;class _O extends LS{constructor(e,n,r,o,c){super(e,n,J.Kind.Video,r,c),this.elementInfos=[],this.monitorReceiver=()=>w(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const d=yield this.getReceiverStats();d&&this.prevStats&&this.receiver&&(this._currentBitrate=Tl(d,this.prevStats)),this.prevStats=d}),this.debouncedHandleResize=Oh(()=>{this.updateDimensions()},vf),this.adaptiveStreamSettings=o}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}setStreamState(e){super.setStreamState(e),this.log.debug("setStreamState",e),this.isAdaptiveStream&&e===J.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?wr(this._mediaStreamTrack,n):Tr(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new RO(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return w(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",o=new Map;return e.forEach(c=>{c.type==="inbound-rtp"?(r=c.codecId,n={type:"video",streamId:c.id,framesDecoded:c.framesDecoded,framesDropped:c.framesDropped,framesReceived:c.framesReceived,packetsReceived:c.packetsReceived,packetsLost:c.packetsLost,frameWidth:c.frameWidth,frameHeight:c.frameHeight,pliCount:c.pliCount,firCount:c.firCount,nackCount:c.nackCount,jitter:c.jitter,timestamp:c.timestamp,bytesReceived:c.bytesReceived,decoderImplementation:c.decoderImplementation}):c.type==="codec"&&o.set(c.id,c)}),n&&r!==""&&o.get(r)&&(n.mimeType=o.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return w(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var n,r;const o=this.elementInfos.reduce((f,h)=>Math.max(f,h.visibilityChangedAt||0),0),c=!((r=(n=this.adaptiveStreamSettings)===null||n===void 0?void 0:n.pauseVideoInBackground)!==null&&r!==void 0)||r?this.isInBackground:!1,d=this.elementInfos.some(f=>f.pictureInPicture),u=this.elementInfos.some(f=>f.visible)&&!c||d;if(!(this.lastVisible===u&&!e)){if(!u&&Date.now()-o<vf){Ot.setTimeout(()=>{this.updateVisibility()},vf);return}this.lastVisible=u,this.emit(ne.VisibilityChanged,u,this)}}updateDimensions(){var e,n;let r=0,o=0;const c=this.getPixelDensity();for(const d of this.elementInfos){const u=d.width()*c,f=d.height()*c;u+f>r+o&&(r=u,o=f)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===o||(this.lastDimensions={width:r,height:o},this.emit(ne.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?Vy():n||(Vy()>2?2:1)}}class RO{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var o;const{target:c,isIntersecting:d}=r;c===this.element&&(this.isIntersecting=d,this.isPiP=Vs(this.element),this.visibilityChangedAt=Date.now(),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this))},this.onEnterPiP=()=>{var r,o,c;(o=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||o===void 0||o.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Vs(this.element),(c=this.handleVisibilityChanged)===null||c===void 0||c.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=Vs(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??Qf(e),this.isPiP=Kt()&&Vs(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,r;this.isIntersecting=Qf(this.element),this.isPiP=Vs(this.element),this.element.handleResize=()=>{var o;(o=this.handleResize)===null||o===void 0||o.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Hy().observe(this.element),Fy().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,r,o,c;(e=Hy())===null||e===void 0||e.unobserve(this.element),(n=Fy())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(c=(o=window.documentPictureInPicture)===null||o===void 0?void 0:o.window)===null||c===void 0||c.removeEventListener("pagehide",this.onLeavePiP)}}function Vs(i){var e,n;return document.pictureInPictureElement===i?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Qf(i,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Qf(i,e){const n=e||window;let r=i.offsetTop,o=i.offsetLeft;const c=i.offsetWidth,d=i.offsetHeight,{hidden:u}=i,{display:f}=getComputedStyle(i);for(;i.offsetParent;)i=i.offsetParent,r+=i.offsetTop,o+=i.offsetLeft;return r<n.pageYOffset+n.innerHeight&&o<n.pageXOffset+n.innerWidth&&r+d>n.pageYOffset&&o+c>n.pageXOffset&&!u&&f!=="none"}class ui extends Vn.EventEmitter{constructor(e,n,r,o){var c;super(),this.metadataMuted=!1,this.encryption=yt.NONE,this.log=Te,this.handleMuted=()=>{this.emit(ne.Muted)},this.handleUnmuted=()=>{this.emit(ne.Unmuted)},this.log=vi((c=o?.loggerName)!==null&&c!==void 0?c:Mn.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=J.Source.Unknown}setTrack(e){this.track&&(this.track.off(ne.Muted,this.handleMuted),this.track.off(ne.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ne.Muted,this.handleMuted),e.on(ne.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Re(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==yt.NONE}get audioTrack(){if(Bn(this.track))return this.track}get videoTrack(){if(aa(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=J.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===J.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(i){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(i.SubscriptionStatus||(i.SubscriptionStatus={})),(function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"})(i.PermissionStatus||(i.PermissionStatus={}))})(ui||(ui={}));class Xf extends ui{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,o){super(e,n.sid,n.name,o),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ne.Ended)},this.handleCpuConstrained=()=>{this.track&&aa(this.track)&&this.emit(ne.CpuConstrained,this.track)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&(this.track.off(ne.Ended,this.handleTrackEnded),this.track.off(ne.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(ne.Ended,this.handleTrackEnded),e.on(ne.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return w(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return w(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return w(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return w(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Bn(this.track)){const n=this.track.getSourceTrackSettings(),r=new Set;return n.autoGainControl&&r.add(Tt.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&r.add(Tt.TF_ECHO_CANCELLATION),n.noiseSuppression&&r.add(Tt.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&r.add(Tt.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(Tt.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(Tt.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}function Cl(i,e){return w(this,void 0,void 0,function*(){i??(i={});let n=!1;const{audioProcessor:r,videoProcessor:o,optionsWithoutProcessor:c}=TS(i);let d=c.audio,u=c.video;if(r&&typeof c.audio=="object"&&(c.audio.processor=r),o&&typeof c.video=="object"&&(c.video.processor=o),i.audio&&typeof c.audio=="object"&&typeof c.audio.deviceId=="string"){const v=c.audio.deviceId;c.audio.deviceId={exact:v},n=!0,d=Object.assign(Object.assign({},c.audio),{deviceId:{ideal:v}})}if(c.video&&typeof c.video=="object"&&typeof c.video.deviceId=="string"){const v=c.video.deviceId;c.video.deviceId={exact:v},n=!0,u=Object.assign(Object.assign({},c.video),{deviceId:{ideal:v}})}c.audio===!0?c.audio={deviceId:"default"}:typeof c.audio=="object"&&c.audio!==null&&(c.audio=Object.assign(Object.assign({},c.audio),{deviceId:c.audio.deviceId||"default"})),c.video===!0?c.video={deviceId:"default"}:typeof c.video=="object"&&!c.video.deviceId&&(c.video.deviceId="default");const f=yS(c,RS,wS),h=Eh(f),g=navigator.mediaDevices.getUserMedia(h);c.audio&&(Ct.userMediaPromiseMap.set("audioinput",g),g.catch(()=>Ct.userMediaPromiseMap.delete("audioinput"))),c.video&&(Ct.userMediaPromiseMap.set("videoinput",g),g.catch(()=>Ct.userMediaPromiseMap.delete("videoinput")));try{const v=yield g;return yield Promise.all(v.getTracks().map(b=>w(this,void 0,void 0,function*(){const T=b.kind==="audio";let _=T?f.audio:f.video;(typeof _=="boolean"||!_)&&(_={});let C;const M=T?h.audio:h.video;typeof M!="boolean"&&(C=M);const R=b.getSettings().deviceId;C?.deviceId&&Wi(C.deviceId)!==R?C.deviceId=R:C||(C={deviceId:R});const B=tO(b,C,e);return B.kind===J.Kind.Video?B.source=J.Source.Camera:B.kind===J.Kind.Audio&&(B.source=J.Source.Microphone),B.mediaStream=v,Bn(B)&&r?yield B.setProcessor(r):aa(B)&&o&&(yield B.setProcessor(o)),B})))}catch(v){if(!n)throw v;return Cl(Object.assign(Object.assign({},i),{audio:d,video:u}),e)}})}function wO(i){return w(this,void 0,void 0,function*(){return(yield Cl({audio:!1,video:!0}))[0]})}function OO(i){return w(this,void 0,void 0,function*(){return(yield Cl({audio:!0,video:!1}))[0]})}var Qi;(function(i){i.Excellent="excellent",i.Good="good",i.Poor="poor",i.Lost="lost",i.Unknown="unknown"})(Qi||(Qi={}));function AO(i){switch(i){case Fs.EXCELLENT:return Qi.Excellent;case Fs.GOOD:return Qi.Good;case Fs.POOR:return Qi.Poor;case Fs.LOST:return Qi.Lost;default:return Qi.Unknown}}class IS extends Vn.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===Zs.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===kr.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,r,o,c,d){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Zs.STANDARD;var f;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=Qi.Unknown,this.log=Te,this.log=vi((f=d?.loggerName)!==null&&f!==void 0?f:Mn.Participant),this.loggerOptions=d,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=o,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=u,this._attributes=c??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Sn,this.once(ee.Active,()=>{var e,n;(n=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||n===void 0||n.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication(J.Source.Camera);return!(!((e=n?.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication(J.Source.Microphone);return!(!((e=n?.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(J.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var n;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===kr.ACTIVE&&((n=this.participantInfo)===null||n===void 0?void 0:n.state)!==kr.ACTIVE&&this.emit(ee.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(ee.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(ee.ParticipantNameChanged,e)}_setAttributes(e){const n=JR(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(ee.AttributesChanged,n)}setPermissions(e){var n,r,o,c,d,u;const f=this.permissions,h=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((o=this.permissions)===null||o===void 0?void 0:o.canPublishData)||e.hidden!==((c=this.permissions)===null||c===void 0?void 0:c.hidden)||e.recorder!==((d=this.permissions)===null||d===void 0?void 0:d.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((g,v)=>{var b;return g!==((b=this.permissions)===null||b===void 0?void 0:b.canPublishSources[v])})||e.canSubscribeMetrics!==((u=this.permissions)===null||u===void 0?void 0:u.canSubscribeMetrics);return this.permissions=e,h&&this.emit(ee.ParticipantPermissionsChanged,f),h}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(ee.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=AO(e),n!==this._connectionQuality&&this.emit(ee.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,n;this.activeFuture&&((n=(e=this.activeFuture).reject)===null||n===void 0||n.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>Bn(n.track)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(ne.Muted,()=>{this.emit(ee.TrackMuted,e)}),e.on(ne.Unmuted,()=>{this.emit(ee.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case J.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case J.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function DO(i){var e,n,r;if(!i.participantSid&&!i.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Nb({participantIdentity:(e=i.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=i.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=i.allowAll)!==null&&r!==void 0?r:!1,trackSids:i.allowedTrackSids||[]})}class MO extends IS{constructor(e,n,r,o,c,d){super(e,n,void 0,void 0,void 0,{loggerName:o.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=yt.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Sn)},this.handleReconnected=()=>{var u,f;(f=(u=this.reconnectFuture)===null||u===void 0?void 0:u.resolve)===null||f===void 0||f.call(u),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var u,f,h,g,v,b;this.reconnectFuture&&(this.reconnectFuture.promise.catch(T=>this.log.warn(T.message,this.logContext)),(f=(u=this.reconnectFuture)===null||u===void 0?void 0:u.reject)===null||f===void 0||f.call(u,new Error("Got disconnected during reconnection attempt")),this.reconnectFuture=void 0),this.signalConnectedFuture&&((g=(h=this.signalConnectedFuture).reject)===null||g===void 0||g.call(h,new Error("Got disconnected without signal connected")),this.signalConnectedFuture=void 0),(b=(v=this.activeAgentFuture)===null||v===void 0?void 0:v.reject)===null||b===void 0||b.call(v,new Error("Got disconnected without active agent present")),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=u=>{var f,h;u.participant&&this.updateInfo(u.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Sn),(h=(f=this.signalConnectedFuture).resolve)===null||h===void 0||h.call(f)},this.handleSignalRequestResponse=u=>{const{requestId:f,reason:h,message:g}=u,v=this.pendingSignalRequests.get(f);v&&(h!==Sh.OK&&v.reject(new Iy(g,h)),this.pendingSignalRequests.delete(f))},this.handleDataPacket=u=>{switch(u.value.case){case"rpcResponse":let f=u.value.value,h=null,g=null;f.value.case==="payload"?h=f.value.value:f.value.case==="error"&&(g=st.fromProto(f.value.value)),this.handleIncomingRpcResponse(f.requestId,h,g);break;case"rpcAck":let v=u.value.value;this.handleIncomingRpcAck(v.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(u=>DO(u)))},this.onTrackUnmuted=u=>{this.onTrackMuted(u,u.isUpstreamPaused)},this.onTrackMuted=(u,f)=>{if(f===void 0&&(f=!0),!u.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Re(u)));return}this.engine.updateMuteStatus(u.sid,f)},this.onTrackUpstreamPaused=u=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Re(u))),this.onTrackMuted(u,!0)},this.onTrackUpstreamResumed=u=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Re(u))),this.onTrackMuted(u,u.isMuted)},this.onTrackFeatureUpdate=u=>{const f=this.audioTrackPublications.get(u.sid);if(!f){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(u.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(f.trackSid,f.getTrackFeatures())},this.onTrackCpuConstrained=(u,f)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),Re(f))),this.emit(ee.LocalTrackCpuConstrained,u,f)},this.handleSubscribedQualityUpdate=u=>w(this,void 0,void 0,function*(){var f,h,g,v,b;if(!(!((b=this.roomOptions)===null||b===void 0)&&b.dynacast))return;const T=this.videoTrackPublications.get(u.trackSid);if(!T){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}if(!T.videoTrack)return;const _=yield T.videoTrack.setPublishingCodecs(u.subscribedCodecs);try{for(var C=!0,M=hi(_),R;R=yield M.next(),f=R.done,!f;C=!0){v=R.value,C=!1;const B=v;FR(B)&&(this.log.debug("publish ".concat(B," for ").concat(T.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Re(T))),yield this.publishAdditionalCodecForTrack(T.videoTrack,B,T.options))}}catch(B){h={error:B}}finally{try{!C&&!f&&(g=M.return)&&(yield g.call(M))}finally{if(h)throw h.error}}}),this.handleLocalTrackUnpublished=u=>{const f=this.trackPublications.get(u.trackSid);if(!f){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:u.trackSid}));return}this.unpublishTrack(f.track)},this.handleTrackEnded=u=>w(this,void 0,void 0,function*(){if(u.source===J.Source.ScreenShare||u.source===J.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Re(u))),this.unpublishTrack(u);else if(u.isUserProvided)yield u.mute();else if(li(u)||Ki(u))try{if(Kt())try{const f=yield navigator?.permissions.query({name:u.source===J.Source.Camera?"camera":"microphone"});if(f&&f.state==="denied")throw this.log.warn("user has revoked access to ".concat(u.source),Object.assign(Object.assign({},this.logContext),Re(u))),f.onchange=()=>{f.state!=="denied"&&(u.isMuted||u.restartTrack(),f.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}u.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Re(u))),li(u)?yield u.restartTrack({deviceId:"default"}):yield u.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Re(u))),yield u.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=o,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=c,this.roomOutgoingDataStreamManager=d}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==yt.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){var n;this.engine=e,this.engine.on(re.RemoteMute,(r,o)=>{const c=this.trackPublications.get(r);!c||!c.track||(o?c.mute():c.unmute())}),!((n=this.signalConnectedFuture)===null||n===void 0)&&n.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(re.Connected,this.handleReconnected).on(re.SignalConnected,this.handleSignalConnected).on(re.SignalRestarted,this.handleReconnected).on(re.SignalResumed,this.handleReconnected).on(re.Restarting,this.handleReconnecting).on(re.Resuming,this.handleReconnecting).on(re.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(re.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(re.Closing,this.handleClosing).on(re.SignalRequestResponse,this.handleSignalRequestResponse).on(re.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return w(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return w(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return w(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return w(this,arguments,void 0,function(n){var r=this;let{metadata:o,name:c,attributes:d}=n;return(function*(){return new Yt((u,f)=>w(r,void 0,void 0,function*(){var h,g;try{let v=!1;const b=yield this.engine.client.sendUpdateLocalMetadata((h=o??this.metadata)!==null&&h!==void 0?h:"",(g=c??this.name)!==null&&g!==void 0?g:"",d),T=performance.now();for(this.pendingSignalRequests.set(b,{resolve:u,reject:_=>{f(_),v=!0},values:{name:c,metadata:o,attributes:d}});performance.now()-T<5e3&&!v;){if((!c||this.name===c)&&(!o||this.metadata===o)&&(!d||Object.entries(d).every(_=>{let[C,M]=_;return this.attributes[C]===M||M===""&&!this.attributes[C]}))){this.pendingSignalRequests.delete(b),u();return}yield At(50)}f(new Iy("Request to update local metadata timed out","TimeoutError"))}catch(v){v instanceof Error?f(v):f(new Error(String(v)))}}))})()})}setCameraEnabled(e,n,r){return this.setTrackEnabled(J.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(J.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(J.Source.ScreenShare,e,n,r)}setE2EEEnabled(e){return w(this,void 0,void 0,function*(){this.encryptionType=e?yt.GCM:yt.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,o){return w(this,void 0,void 0,function*(){var c,d;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let u=this.getTrackPublication(e);if(n)if(u)yield u.unmute();else{let f;if(this.pendingPublishing.has(e)){const h=yield this.waitForPendingPublicationOfSource(e);return h||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield h?.unmute(),h}this.pendingPublishing.add(e);try{switch(e){case J.Source.Camera:f=yield this.createTracks({video:(c=r)!==null&&c!==void 0?c:!0});break;case J.Source.Microphone:f=yield this.createTracks({audio:(d=r)!==null&&d!==void 0?d:!0});break;case J.Source.ScreenShare:f=yield this.createScreenTracks(Object.assign({},r));break;default:throw new mi(e)}}catch(h){throw f?.forEach(g=>{g.stop()}),h instanceof Error&&this.emit(ee.MediaDevicesError,h,zf(e)),this.pendingPublishing.delete(e),h}for(const h of f){const g=Object.assign(Object.assign({},this.roomOptions.publishDefaults),r);e===J.Source.Microphone&&Bn(h)&&g.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),h.startPreConnectBuffer())}try{const h=[];for(const v of f)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Re(v))),h.push(this.publishTrack(v,o));[u]=yield Promise.all(h)}catch(h){throw f?.forEach(g=>{g.stop()}),h}finally{this.pendingPublishing.delete(e)}}else if(!u?.track&&this.pendingPublishing.has(e)&&(u=yield this.waitForPendingPublicationOfSource(e),u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),u&&u.track)if(e===J.Source.ScreenShare){u=yield this.unpublishTrack(u.track);const f=this.getTrackPublication(J.Source.ScreenShareAudio);f&&f.track&&this.unpublishTrack(f.track)}else yield u.mute();return u})}enableCameraAndMicrophone(){return w(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(J.Source.Camera)||this.pendingPublishing.has(J.Source.Microphone))){this.pendingPublishing.add(J.Source.Camera),this.pendingPublishing.add(J.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(J.Source.Camera),this.pendingPublishing.delete(J.Source.Microphone)}}})}createTracks(e){return w(this,void 0,void 0,function*(){var n,r;e??(e={});const o=yS(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults);try{return(yield Cl(o,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(u=>(Bn(u)&&(this.microphoneError=void 0,u.setAudioContext(this.audioContext),u.source=J.Source.Microphone,this.emit(ee.AudioStreamAcquired)),aa(u)&&(this.cameraError=void 0,u.source=J.Source.Camera),u))}catch(c){throw c instanceof Error&&(e.audio&&(this.microphoneError=c),e.video&&(this.cameraError=c)),c}})}createScreenTracks(e){return w(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Ch("getDisplayMedia not supported");e.resolution===void 0&&!iw()&&(e.resolution=kh.h1080fps30.resolution);const n=GR(e),r=yield navigator.mediaDevices.getDisplayMedia(n),o=r.getVideoTracks();if(o.length===0)throw new mi("no video track found");const c=new sl(o[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});c.source=J.Source.ScreenShare,e.contentHint&&(c.mediaStreamTrack.contentHint=e.contentHint);const d=[c];if(r.getAudioTracks().length>0){this.emit(ee.AudioStreamAcquired);const u=new rl(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});u.source=J.Source.ScreenShareAudio,d.push(u)}return d})}publishTrack(e,n){return w(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return w(this,arguments,void 0,function(r,o){var c=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return(function*(){var u,f,h,g;li(r)&&r.setAudioContext(c.audioContext),yield(u=c.reconnectFuture)===null||u===void 0?void 0:u.promise,c.republishPromise&&!d&&(yield c.republishPromise),Or(r)&&c.pendingPublishPromises.has(r)&&(yield c.pendingPublishPromises.get(r));let v;if(r instanceof MediaStreamTrack)v=r.getConstraints();else{v=r.constraints;let R;switch(r.source){case J.Source.Microphone:R="audioinput";break;case J.Source.Camera:R="videoinput"}R&&c.activeDeviceMap.has(R)&&(v=Object.assign(Object.assign({},v),{deviceId:c.activeDeviceMap.get(R)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new rl(r,v,!0,c.audioContext,{loggerName:c.roomOptions.loggerName,loggerContextCb:()=>c.logContext});break;case"video":r=new sl(r,v,!0,{loggerName:c.roomOptions.loggerName,loggerContextCb:()=>c.logContext});break;default:throw new mi("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:c.roomOptions.loggerName,loggerContextCb:()=>c.logContext});let b;if(c.trackPublications.forEach(R=>{R.track&&R.track===r&&(b=R)}),b)return c.log.warn("track has already been published, skipping",Object.assign(Object.assign({},c.logContext),Re(b))),b;const T=Object.assign(Object.assign({},c.roomOptions.publishDefaults),o),_="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,C=(f=T.forceStereo)!==null&&f!==void 0?f:_;C&&(T.dtx===void 0&&c.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},c.logContext),Re(r))),T.red===void 0&&c.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(h=T.dtx)!==null&&h!==void 0||(T.dtx=!1),(g=T.red)!==null&&g!==void 0||(T.red=!1)),!rw()&&c.roomOptions.e2ee&&(c.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},c.logContext)),T.simulcast=!1),T.source&&(r.source=T.source);const M=new Promise((R,B)=>w(c,void 0,void 0,function*(){try{if(this.engine.client.currentState!==Ke.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:Re(r)}));let q=!1;const E=setTimeout(()=>{q=!0,r.stop(),B(new Uy("publishing rejected as engine not connected within timeout",408))},15e3);if(yield this.waitUntilEngineConnected(),clearTimeout(E),q)return;const k=yield this.publish(r,T,C);R(k)}else try{const q=yield this.publish(r,T,C);R(q)}catch(q){B(q)}}catch(q){B(q)}}));c.pendingPublishPromises.set(r,M);try{return yield M}catch(R){throw R}finally{c.pendingPublishPromises.delete(r)}})()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Sn),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Re(e))),!1;const{canPublish:n,canPublishSources:r}=this.permissions;return n&&(r.length===0||r.map(o=>QR(o)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Re(e))),!1)}publish(e,n,r){return w(this,void 0,void 0,function*(){var o,c,d,u,f,h,g,v,b,T;if(!this.hasPermissionsToPublish(e))throw new Uy("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(G=>Or(e)&&G.source===e.source)&&e.source!==J.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Re(e))),n.stopMicTrackOnMute&&Bn(e)&&(e.stopOnMute=!0),e.source===J.Source.ScreenShare&&Aa()&&(n.simulcast=!1),n.videoCodec==="av1"&&!ew()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!tw()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Yf),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(G=>n.videoCodec===Ks(G.mime))||(n.videoCodec=Ks(this.enabledPublishVideoCodecs[0].mime)));const C=n.videoCodec;e.on(ne.Muted,this.onTrackMuted),e.on(ne.Unmuted,this.onTrackUnmuted),e.on(ne.Ended,this.handleTrackEnded),e.on(ne.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ne.UpstreamResumed,this.onTrackUpstreamResumed),e.on(ne.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const M=[],R=!(!((o=n.dtx)!==null&&o!==void 0)||o),B=e.getSourceTrackSettings();B.autoGainControl&&M.push(Tt.TF_AUTO_GAIN_CONTROL),B.echoCancellation&&M.push(Tt.TF_ECHO_CANCELLATION),B.noiseSuppression&&M.push(Tt.TF_NOISE_SUPPRESSION),B.channelCount&&B.channelCount>1&&M.push(Tt.TF_STEREO),R&&M.push(Tt.TF_NO_DTX),li(e)&&e.hasPreConnectBuffer&&M.push(Tt.TF_PRECONNECT_BUFFER);const q=new Ws({cid:e.mediaStreamTrack.id,name:n.name,type:J.kindToProto(e.kind),muted:e.isMuted,source:J.sourceToProto(e.source),disableDtx:R,encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((c=n.red)!==null&&c!==void 0)||c),stream:n?.stream,backupCodecPolicy:n?.backupCodecPolicy,audioFeatures:M});let E;if(e.kind===J.Kind.Video){let G={width:0,height:0};try{G=yield e.waitForDimensions()}catch{const W=(u=(d=this.roomOptions.videoCaptureDefaults)===null||d===void 0?void 0:d.resolution)!==null&&u!==void 0?u:eo.h720.resolution;G={width:W.width,height:W.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Re(e)),{dims:G}))}q.width=G.width,q.height=G.height,Ki(e)&&(An(C)&&(e.source===J.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Re(e))))),n.scalabilityMode=(f=n.scalabilityMode)!==null&&f!==void 0?f:"L3T3_KEY"),q.simulcastCodecs=[new Af({codec:C,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Yf}),n.backupCodec&&C!==n.backupCodec.codec&&q.encryption===yt.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),q.simulcastCodecs.push(new Af({codec:n.backupCodec.codec,cid:""})))),E=Jf(e.source===J.Source.ScreenShare,q.width,q.height,n),q.layers=u0(q.width,q.height,E,An(n.videoCodec))}else e.kind===J.Kind.Audio&&(E=[{maxBitrate:(h=n.audioPreset)===null||h===void 0?void 0:h.maxBitrate,priority:(v=(g=n.audioPreset)===null||g===void 0?void 0:g.priority)!==null&&v!==void 0?v:"high",networkPriority:(T=(b=n.audioPreset)===null||b===void 0?void 0:b.priority)!==null&&T!==void 0?T:"high"}]);if(!this.engine||this.engine.isClosed)throw new lt("cannot publish track when not connected");const k=()=>w(this,void 0,void 0,function*(){var G,Q,W;if(!this.engine.pcManager)throw new lt("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,E),this.emit(ee.LocalSenderCreated,e.sender,e),Ki(e)&&((G=n.degradationPreference)!==null&&G!==void 0||(n.degradationPreference=dO(e)),e.setDegradationPreference(n.degradationPreference)),E)if(Aa()&&e.kind===J.Kind.Audio){let ie;for(const ve of this.engine.pcManager.publisher.getTransceivers())if(ve.sender===e.sender){ie=ve;break}ie&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:ie,codec:"opus",maxbr:!((Q=E[0])===null||Q===void 0)&&Q.maxBitrate?E[0].maxBitrate/1e3:0})}else e.codec&&An(e.codec)&&(!((W=E[0])===null||W===void 0)&&W.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:q.cid,codec:e.codec,maxbr:E[0].maxBitrate/1e3});yield this.engine.negotiate()});let D;const L=new Promise((G,Q)=>w(this,void 0,void 0,function*(){var W;try{D=yield this.engine.addTrack(q),G(D)}catch(ie){e.sender&&(!((W=this.engine.pcManager)===null||W===void 0)&&W.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(ve=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),Re(e)),{error:ve}))})),Q(ie)}}));if(this.enabledPublishVideoCodecs.length>0)D=(yield Promise.all([L,k()]))[0];else{D=yield L;let G;if(D.codecs.forEach(Q=>{G===void 0&&(G=Q.mimeType)}),G&&e.kind===J.Kind.Video){const Q=Ks(G);Q!==C&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Re(e)),{codec:Q})),n.videoCodec=Q,E=Jf(e.source===J.Source.ScreenShare,q.width,q.height,n))}yield k()}const K=new Xf(e.kind,D,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(K.on(ne.CpuConstrained,G=>this.onTrackCpuConstrained(G,K)),K.options=n,e.sid=D.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:E,trackInfo:D})),Ki(e)?e.startMonitor(this.engine.client):li(e)&&e.startMonitor(),this.addTrackPublication(K),this.emit(ee.LocalTrackPublished,K),li(e)&&D.audioFeatures.includes(Tt.TF_PRECONNECT_BUFFER)){const G=e.getPreConnectBuffer(),Q=e.getPreConnectBufferMimeType();this.on(ee.LocalTrackSubscribed,W=>{if(W.trackSid===D.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),Re(e))),e.stopPreConnectBuffer()}}),G&&new Promise((ie,ve)=>w(this,void 0,void 0,function*(){var Ne,tt,V,ae,ue,Me;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),Re(e)));const se=setTimeout(()=>{ve(new Error("agent not active within 10 seconds"))},1e4),oe=yield this.waitUntilActiveAgentPresent();clearTimeout(se),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),Re(e)));const pe=yield this.streamBytes({name:"preconnect-buffer",mimeType:Q,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[oe.identity],attributes:{trackId:K.trackSid,sampleRate:String((ue=B.sampleRate)!==null&&ue!==void 0?ue:"48000"),channels:String((Me=B.channelCount)!==null&&Me!==void 0?Me:"1")}});try{for(var xe=!0,P=hi(G),X;X=yield P.next(),Ne=X.done,!Ne;xe=!0){ae=X.value,xe=!1;const ge=ae;yield pe.write(ge)}}catch(ge){tt={error:ge}}finally{try{!xe&&!Ne&&(V=P.return)&&(yield V.call(P))}finally{if(tt)throw tt.error}}yield pe.close(),ie()}catch(se){ve(se)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),Re(e)))}).catch(ie=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),Re(e)),{error:ie}))})}return K})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){return w(this,void 0,void 0,function*(){var o;if(this.encryptionType!==yt.NONE)return;let c;if(this.trackPublications.forEach(T=>{T.track&&T.track===e&&(c=T)}),!c)throw new mi("track is not published");if(!Ki(e))throw new mi("track is not a video track");const d=Object.assign(Object.assign({},(o=this.roomOptions)===null||o===void 0?void 0:o.publishDefaults),r),u=cO(e,n,d);if(!u){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Re(e)));return}const f=e.addSimulcastTrack(n,u);if(!f)return;const h=new Ws({cid:f.mediaStreamTrack.id,type:J.kindToProto(e.kind),muted:e.isMuted,source:J.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:d.videoCodec,cid:f.mediaStreamTrack.id}]});if(h.layers=u0(h.width,h.height,u),!this.engine||this.engine.isClosed)throw new lt("cannot publish track when not connected");const g=()=>w(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,f,d,u),yield this.engine.negotiate()}),b=(yield Promise.all([this.engine.addTrack(h),g()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:u,trackInfo:b}))})}unpublishTrack(e,n){return w(this,void 0,void 0,function*(){var r,o;if(Or(e)){const h=this.pendingPublishPromises.get(e);h&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Re(e))),yield h)}const c=this.getPublicationForTrack(e),d=c?Re(c):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),d)),!c||!c.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),d));return}e=c.track,e.off(ne.Muted,this.onTrackMuted),e.off(ne.Unmuted,this.onTrackUnmuted),e.off(ne.Ended,this.handleTrackEnded),e.off(ne.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ne.UpstreamResumed,this.onTrackUpstreamResumed),e.off(ne.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(o=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&o!==void 0?o:!0),n?e.stop():e.stopMonitor();let u=!1;const f=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<at.FAILED&&f)try{for(const h of this.engine.pcManager.publisher.getTransceivers())h.sender===f&&(h.direction="inactive",u=!0);if(this.engine.removeTrack(f)&&(u=!0),Ki(e)){for(const[,h]of e.simulcastCodecs)h.sender&&(this.engine.removeTrack(h.sender)&&(u=!0),h.sender=void 0);e.simulcastCodecs.clear()}}catch(h){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),d),{error:h}))}switch(this.trackPublications.delete(c.trackSid),c.kind){case J.Kind.Audio:this.audioTrackPublications.delete(c.trackSid);break;case J.Kind.Video:this.videoTrackPublications.delete(c.trackSid);break}return this.emit(ee.LocalTrackUnpublished,c),c.setTrack(void 0),u&&(yield this.engine.negotiate()),c})}unpublishTracks(e){return w(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>!!r)})}republishAllTracks(e){return w(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return(function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Yt((c,d)=>w(r,void 0,void 0,function*(){try{const u=[];this.trackPublications.forEach(f=>{f.track&&(n&&(f.options=Object.assign(Object.assign({},f.options),n)),u.push(f))}),yield Promise.all(u.map(f=>w(this,void 0,void 0,function*(){const h=f.track;yield this.unpublishTrack(h,!1),o&&!h.isMuted&&h.source!==J.Source.ScreenShare&&h.source!==J.Source.ScreenShareAudio&&(li(h)||Ki(h))&&!h.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:f.trackSid})),yield h.restartTrack()),yield this.publishOrRepublishTrack(h,f.options,!0)}))),c()}catch(u){u instanceof Error?d(u):d(new Error(String(u)))}finally{this.republishPromise=void 0}})),yield r.republishPromise})()})}publishData(e){return w(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(function*(){const c=o.reliable?ke.RELIABLE:ke.LOSSY,d=o.destinationIdentities,u=o.topic;let f=new dh({participantIdentity:r.identity,payload:n,destinationIdentities:d,topic:u});const h=new Lt({kind:c,value:{case:"user",value:f}});yield r.engine.sendDataPacket(h,c)})()})}publishDtmf(e,n){return w(this,void 0,void 0,function*(){const r=new Lt({kind:ke.RELIABLE,value:{case:"sipDtmf",value:new bb({code:e,digit:n})}});yield this.engine.sendDataPacket(r,ke.RELIABLE)})}sendChatMessage(e,n){return w(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:n?.attachments},o=new Lt({value:{case:"chatMessage",value:new tl(Object.assign(Object.assign({},r),{timestamp:$e.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(o,ke.RELIABLE),this.emit(ee.ChatMessage,r),r})}editChatMessage(e,n){return w(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),o=new Lt({value:{case:"chatMessage",value:new tl(Object.assign(Object.assign({},r),{timestamp:$e.parse(r.timestamp),editTimestamp:$e.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(o,ke.RELIABLE),this.emit(ee.ChatMessage,r),r})}sendText(e,n){return w(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,n)})}streamText(e){return w(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,n){return w(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,n)})}streamBytes(e){return w(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){let{destinationIdentity:n,method:r,payload:o,responseTimeout:c=15e3}=e;const d=7e3,u=d+1e3;return new Yt((f,h)=>w(this,void 0,void 0,function*(){var g,v,b,T;if(Mh(o)>AS){h(st.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((v=(g=this.engine.latestJoinResponse)===null||g===void 0?void 0:g.serverInfo)===null||v===void 0)&&v.version&&qn((T=(b=this.engine.latestJoinResponse)===null||b===void 0?void 0:b.serverInfo)===null||T===void 0?void 0:T.version,"1.8.0")<0){h(st.builtIn("UNSUPPORTED_SERVER"));return}const _=Math.max(c,u),C=crypto.randomUUID();yield this.publishRpcRequest(n,C,r,o,_);const M=setTimeout(()=>{this.pendingAcks.delete(C),h(st.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(C),clearTimeout(R)},d);this.pendingAcks.set(C,{resolve:()=>{clearTimeout(M)},participantIdentity:n});const R=setTimeout(()=>{this.pendingResponses.delete(C),h(st.builtIn("RESPONSE_TIMEOUT"))},c);this.pendingResponses.set(C,{resolve:(B,q)=>{clearTimeout(R),this.pendingAcks.has(C)&&(this.log.warn("RPC response received before ack",C),this.pendingAcks.delete(C),clearTimeout(M)),q?h(q):f(B??"")},participantIdentity:n})}))}registerRpcMethod(e,n){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,r){const o=this.pendingResponses.get(e);o?(o.resolve(n,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,n,r,o,c){return w(this,void 0,void 0,function*(){const d=new Lt({destinationIdentities:[e],kind:ke.RELIABLE,value:{case:"rpcRequest",value:new fh({id:n,method:r,payload:o,responseTimeoutMs:c,version:1})}});yield this.engine.sendDataPacket(d,ke.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:r,resolve:o}]of this.pendingResponses)r===e&&(o(null,st.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(n=>{var r,o;const c=this.trackPublications.get(n.sid);if(c){const d=c.isMuted||((o=(r=c.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&o!==void 0?o:!1);d!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Re(c)),{mutedOnServer:d})),this.engine.client.sendMuteTrack(n.sid,d))}}),!0):!1}setActiveAgent(e){var n,r,o,c;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(r=(n=this.activeAgentFuture)===null||n===void 0?void 0:n.resolve)===null||r===void 0||r.call(n,e):(c=(o=this.activeAgentFuture)===null||o===void 0?void 0:o.reject)===null||c===void 0||c.call(o,new Error("Agent disconnected")),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Sn),this.activeAgentFuture.promise)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(r=>{const o=r.track;o&&(e instanceof MediaStreamTrack?(li(o)||Ki(o))&&o.mediaStreamTrack===e&&(n=r):e===o&&(n=r))}),n}waitForPendingPublicationOfSource(e){return w(this,void 0,void 0,function*(){const r=Date.now();for(;Date.now()<r+1e4;){const o=Array.from(this.pendingPublishPromises.entries()).find(c=>{let[d]=c;return d.source===e});if(o)return o[1];yield At(20)}})}}class ol extends ui{constructor(e,n,r,o){super(e,n.sid,n.name,o),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=c=>{this.setTrack(void 0),this.emit(ne.Ended,c)},this.handleVisibilityChange=c=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(c),this.logContext),this.visible=c,this.emitTrackUpdate()},this.handleVideoDimensionsChange=c=>{this.log.debug("adaptivestream video dimensions ".concat(c.width,"x").concat(c.height),this.logContext),this.videoDimensionsAdaptiveStream=c,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const o=new yl({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Tb({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ne.UpdateSubscription,o),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?ui.SubscriptionStatus.Unsubscribed:super.isSubscribed?ui.SubscriptionStatus.Subscribed:ui.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?ui.PermissionStatus.Allowed:ui.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.requestedVideoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.requestedVideoDimensions)===null||r===void 0?void 0:r.height)===e.height||(uf(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&uf(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:sn.HIGH}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,o=this.track;o!==e&&(o&&(o.off(ne.VideoDimensionsChanged,this.handleVideoDimensionsChange),o.off(ne.VisibilityChanged,this.handleVisibilityChange),o.off(ne.Ended,this.handleEnded),o.detach(),o.stopMonitor(),this.emit(ne.Unsubscribed,o)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ne.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ne.VisibilityChanged,this.handleVisibilityChange),e.on(ne.Ended,this.handleEnded),this.emit(ne.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(ne.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?ne.Muted:ne.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(ne.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ne.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return uf(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new Db({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===J.Kind.Video){let n=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(n)By(this.videoDimensionsAdaptiveStream,n)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const r=XR(this.trackInfo,this.requestedMaxQuality);r&&By(this.videoDimensionsAdaptiveStream,r)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream;n?(e.width=Math.ceil(n.width),e.height=Math.ceil(n.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:sn.HIGH})),e.quality=sn.HIGH)}this.emit(ne.UpdateSettings,e)}}class cl extends IS{static fromParticipantInfo(e,n,r){return new cl(e,n.sid,n.identity,n.name,n.metadata,n.attributes,r,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,r,o,c,d,u){let f=arguments.length>7&&arguments[7]!==void 0?arguments[7]:Zs.STANDARD;super(n,r||"",o,c,d,u,f),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ne.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),Re(e)),{settings:n})),this.signalClient.sendUpdateTrackSettings(n)}),e.on(ne.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(ne.SubscriptionPermissionChanged,n=>{this.emit(ee.TrackSubscriptionPermissionChanged,e,n)}),e.on(ne.SubscriptionStatusChanged,n=>{this.emit(ee.TrackSubscriptionStatusChanged,e,n)}),e.on(ne.Subscribed,n=>{this.emit(ee.TrackSubscribed,n,e)}),e.on(ne.Unsubscribed,n=>{this.emit(ee.TrackUnsubscribed,n,e)}),e.on(ne.SubscriptionFailed,n=>{this.emit(ee.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:J.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrackPublication(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,o,c,d){let u=this.getTrackPublicationBySid(n);if(u||n.startsWith("TR")||this.trackPublications.forEach(g=>{!u&&e.kind===g.kind.toString()&&(u=g)}),!u){if(d===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(ee.TrackSubscriptionFailed,n);return}d===void 0&&(d=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,o,c,d-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Re(u))),this.emit(ee.TrackSubscriptionFailed,n);return}const f=e.kind==="video";let h;return f?h=new _O(e,n,o,c):h=new US(e,n,o,this.audioContext,this.audioOutput),h.source=u.source,h.isMuted=u.isMuted,h.setMediaStream(r),h.start(),u.setTrack(h),this.volumeMap.has(u.source)&&Hf(h)&&Bn(h)&&h.setVolume(this.volumeMap.get(u.source)),u}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(o=>{var c,d;let u=this.getTrackPublicationBySid(o.sid);if(u)u.updateInfo(o);else{const f=J.kindFromProto(o.type);if(!f)return;u=new ol(f,o,(c=this.signalClient.connectOptions)===null||c===void 0?void 0:c.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(d=this.loggerOptions)===null||d===void 0?void 0:d.loggerName}),u.updateInfo(o),r.set(o.sid,u);const h=Array.from(this.trackPublications.values()).find(g=>g.source===u?.source);h&&u.source!==J.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(u.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Re(h),newTrack:Re(u)})),this.addTrackPublication(u)}n.set(o.sid,u)}),this.trackPublications.forEach(o=>{n.has(o.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Re(o))),this.unpublishTrack(o.trackSid,!0))}),r.forEach(o=>{this.emit(ee.TrackPublished,o)}),!0}unpublishTrack(e,n){const r=this.trackPublications.get(e);if(!r)return;const{track:o}=r;switch(o&&(o.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case J.Kind.Audio:this.audioTrackPublications.delete(e);break;case J.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(ee.TrackUnpublished,r)}setAudioOutput(e){return w(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(r=>{var o;Bn(r.track)&&Hf(r.track)&&n.push(r.track.setSinkId((o=e.deviceId)!==null&&o!==void 0?o:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var Ie;(function(i){i.Disconnected="disconnected",i.Connecting="connecting",i.Connected="connected",i.Reconnecting="reconnecting",i.SignalReconnecting="signalReconnecting"})(Ie||(Ie={}));const xO=4*1e3;class Nr extends Vn.EventEmitter{get hasE2EESetup(){return this.e2eeManager!==void 0}constructor(e){var n,r,o,c,d;if(super(),n=this,this.state=Ie.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=Te,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(u,f,h)=>w(this,void 0,void 0,function*(){var g;if(!nw())throw zn()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const v=yield this.disconnectLock.lock();if(this.state===Ie.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),v(),Promise.resolve();if(this.connectFuture)return v(),this.connectFuture.promise;this.setAndEmitConnectionState(Ie.Connecting),((g=this.regionUrlProvider)===null||g===void 0?void 0:g.getServerUrl().toString())!==_S(u)&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Pr(new URL(u))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Pe(u,f):this.regionUrlProvider.updateToken(f),this.regionUrlProvider.fetchRegionSettings().then(_=>{var C;(C=this.regionUrlProvider)===null||C===void 0||C.setServerReportedRegions(_)}).catch(_=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:_}))}));const b=(_,C,M)=>w(this,void 0,void 0,function*(){var R,B;this.abortController&&this.abortController.abort();const q=new AbortController;this.abortController=q,v?.();try{if(yield Ar.getInstance().getBackOffPromise(u),q.signal.aborted)throw he.cancelled("Connection attempt aborted");yield this.attemptConnection(M??u,f,h,q),this.abortController=void 0,_()}catch(E){if(this.regionUrlProvider&&E instanceof he&&E.reason!==Je.Cancelled&&E.reason!==Je.NotAllowed){let k=null;try{this.log.debug("Fetching next region"),k=yield this.regionUrlProvider.getNextBestRegionUrl((R=this.abortController)===null||R===void 0?void 0:R.signal)}catch(D){if(D instanceof he&&(D.status===401||D.reason===Je.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),C(D);return}}[Je.InternalError,Je.ServerUnreachable,Je.Timeout].includes(E.reason)&&(this.log.debug("Adding failed connection attempt to back off"),Ar.getInstance().addFailedConnectionAttempt(u)),k&&!(!((B=this.abortController)===null||B===void 0)&&B.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(E.message,". Retrying with another region: ").concat(k),this.logContext),this.recreateEngine(),yield b(_,C,k)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Yy(E)),C(E))}else{let k=Dn.UNKNOWN_REASON;E instanceof he&&(k=Yy(E)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,k),C(E)}}}),T=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Sn((_,C)=>{b(_,C,T)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(u,f,h,g,v,b)=>w(this,void 0,void 0,function*(){var T,_,C;const M=yield h.join(u,f,{autoSubscribe:g.autoSubscribe,adaptiveStream:typeof v.adaptiveStream=="object"?!0:v.adaptiveStream,maxRetries:g.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:g.websocketTimeout},b.signal,!v.singlePeerConnection);let R=M.serverInfo;if(R||(R={version:M.serverVersion,region:M.serverRegion}),this.serverInfo=R,this.log.debug("connected to Livekit Server ".concat(Object.entries(R).map(B=>{let[q,E]=B;return"".concat(q,": ").concat(E)}).join(", ")),{room:(T=M.room)===null||T===void 0?void 0:T.name,roomSid:(_=M.room)===null||_===void 0?void 0:_.sid,identity:(C=M.participant)===null||C===void 0?void 0:C.identity}),!R.version)throw new jR("unknown server version");return R.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),v.dynacast=!1),M}),this.applyJoinResponse=u=>{const f=u.participant;if(this.localParticipant.sid=f.sid,this.localParticipant.identity=f.identity,this.localParticipant.setEnabledPublishCodecs(u.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(u.sifTrailer)}catch(h){this.log.error(h instanceof Error?h.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:h}))}this.handleParticipantUpdates([f,...u.otherParticipants]),u.room&&this.handleRoomUpdate(u.room)},this.attemptConnection=(u,f,h,g)=>w(this,void 0,void 0,function*(){var v,b;this.state===Ie.Reconnecting||this.isResuming||!((v=this.engine)===null||v===void 0)&&v.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((b=this.regionUrlProvider)===null||b===void 0)&&b.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Dh),h),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const T=yield this.connectSignal(u,f,this.engine,this.connOptions,this.options,g);this.applyJoinResponse(T),this.setupLocalParticipantEvents(),this.emit(H.SignalConnected)}catch(T){yield this.engine.close(),this.recreateEngine();const _=g.signal.aborted?he.cancelled("Signal connection aborted"):he.serverUnreachable("could not establish signal connection");throw T instanceof Error&&(_.message="".concat(_.message,": ").concat(T.message)),T instanceof he&&(_.reason=T.reason,_.status=T.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:T})),_}if(g.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),he.cancelled("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,g)}catch(T){throw yield this.engine.close(),this.recreateEngine(),T}Kt()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Kt()&&window.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(Ie.Connected),this.emit(H.Connected),Ar.getInstance().resetFailedConnectionAttempts(u),this.registerConnectionReconcile(),this.regionUrlProvider&&this.regionUrlProvider.notifyConnected()}),this.disconnect=function(){for(var u=arguments.length,f=new Array(u),h=0;h<u;h++)f[h]=arguments[h];return w(n,[...f],void 0,function(){var g=this;let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return(function*(){var b,T,_;const C=yield g.disconnectLock.lock();try{if(g.state===Ie.Disconnected){g.log.debug("already disconnected",g.logContext);return}if(g.log.info("disconnect from room",Object.assign({},g.logContext)),g.state===Ie.Connecting||g.state===Ie.Reconnecting||g.isResuming){const M="Abort connection attempt due to user initiated disconnect";g.log.warn(M,g.logContext),(b=g.abortController)===null||b===void 0||b.abort(M),(_=(T=g.connectFuture)===null||T===void 0?void 0:T.reject)===null||_===void 0||_.call(T,he.cancelled("Client initiated disconnect")),g.connectFuture=void 0}g.engine&&(g.engine.client.isDisconnected||(yield g.engine.client.sendLeave()),yield g.engine.close()),g.handleDisconnect(v,Dn.CLIENT_INITIATED),g.engine=void 0}finally{C()}})()})},this.onPageLeave=()=>w(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>w(this,void 0,void 0,function*(){const u=[],f=Jt();if(f&&f.os==="iOS"){const h="livekit-dummy-audio-el";let g=document.getElementById(h);if(!g){g=document.createElement("audio"),g.id=h,g.autoplay=!0,g.hidden=!0;const v=lf();v.enabled=!0;const b=new MediaStream([v]);g.srcObject=b,document.addEventListener("visibilitychange",()=>{g&&(g.srcObject=document.hidden?null:b,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(g),this.once(H.Disconnected,()=>{g?.remove(),g=null})}u.push(g)}this.remoteParticipants.forEach(h=>{h.audioTrackPublications.forEach(g=>{g.track&&g.track.attachedElements.forEach(v=>{u.push(v)})})});try{yield Promise.all([this.acquireAudioContext(),...u.map(h=>(h.muted=!1,h.play()))]),this.handleAudioPlaybackStarted()}catch(h){throw this.handleAudioPlaybackFailed(h),h}}),this.startVideo=()=>w(this,void 0,void 0,function*(){const u=[];for(const f of this.remoteParticipants.values())f.videoTrackPublications.forEach(h=>{var g;(g=h.track)===null||g===void 0||g.attachedElements.forEach(v=>{u.includes(v)||u.push(v)})});yield Promise.all(u.map(f=>f.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(f=>{f.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const u of this.remoteParticipants.values())this.handleParticipantDisconnected(u.identity,u);this.setAndEmitConnectionState(Ie.Reconnecting)&&this.emit(H.Reconnecting)},this.handleSignalRestarted=u=>w(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(u.serverRegion),Object.assign(Object.assign({},this.logContext),{region:u.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(u);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(f){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:f}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:u.serverRegion}))}catch{return}this.setAndEmitConnectionState(Ie.Connected),this.emit(H.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=u=>{u.forEach(f=>{var h;if(f.identity===this.localParticipant.identity){this.localParticipant.updateInfo(f);return}f.identity===""&&(f.identity=(h=this.sidToIdentity.get(f.sid))!==null&&h!==void 0?h:"");let g=this.remoteParticipants.get(f.identity);f.state===kr.DISCONNECTED?this.handleParticipantDisconnected(f.identity,g):g=this.getOrCreateParticipant(f.identity,f)})},this.handleActiveSpeakersUpdate=u=>{const f=[],h={};u.forEach(g=>{if(h[g.sid]=!0,g.sid===this.localParticipant.sid)this.localParticipant.audioLevel=g.level,this.localParticipant.setIsSpeaking(!0),f.push(this.localParticipant);else{const v=this.getRemoteParticipantBySid(g.sid);v&&(v.audioLevel=g.level,v.setIsSpeaking(!0),f.push(v))}}),h[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(g=>{h[g.sid]||(g.audioLevel=0,g.setIsSpeaking(!1))}),this.activeSpeakers=f,this.emitWhenConnected(H.ActiveSpeakersChanged,f)},this.handleSpeakersChanged=u=>{const f=new Map;this.activeSpeakers.forEach(g=>{const v=this.remoteParticipants.get(g.identity);v&&v.sid!==g.sid||f.set(g.sid,g)}),u.forEach(g=>{let v=this.getRemoteParticipantBySid(g.sid);g.sid===this.localParticipant.sid&&(v=this.localParticipant),v&&(v.audioLevel=g.level,v.setIsSpeaking(g.active),g.active?f.set(g.sid,v):f.delete(g.sid))});const h=Array.from(f.values());h.sort((g,v)=>v.audioLevel-g.audioLevel),this.activeSpeakers=h,this.emitWhenConnected(H.ActiveSpeakersChanged,h)},this.handleStreamStateUpdate=u=>{u.streamStates.forEach(f=>{const h=this.getRemoteParticipantBySid(f.participantSid);if(!h)return;const g=h.getTrackPublicationBySid(f.trackSid);if(!g||!g.track)return;const v=J.streamStateFromProto(f.state);g.track.setStreamState(v),v!==g.track.streamState&&(h.emit(ee.TrackStreamStateChanged,g,g.track.streamState),this.emitWhenConnected(H.TrackStreamStateChanged,g,g.track.streamState,h))})},this.handleSubscriptionPermissionUpdate=u=>{const f=this.getRemoteParticipantBySid(u.participantSid);if(!f)return;const h=f.getTrackPublicationBySid(u.trackSid);h&&h.setAllowed(u.allowed)},this.handleSubscriptionError=u=>{const f=Array.from(this.remoteParticipants.values()).find(g=>g.trackPublications.has(u.trackSid));if(!f)return;const h=f.getTrackPublicationBySid(u.trackSid);h&&h.setSubscriptionError(u.err)},this.handleDataPacket=(u,f)=>{const h=this.remoteParticipants.get(u.participantIdentity);if(u.value.case==="user")this.handleUserPacket(h,u.value.value,u.kind,f);else if(u.value.case==="transcription")this.handleTranscription(h,u.value.value);else if(u.value.case==="sipDtmf")this.handleSipDtmf(h,u.value.value);else if(u.value.case==="chatMessage")this.handleChatMessage(h,u.value.value);else if(u.value.case==="metrics")this.handleMetrics(u.value.value,h);else if(u.value.case==="streamHeader"||u.value.case==="streamChunk"||u.value.case==="streamTrailer")this.handleDataStream(u,f);else if(u.value.case==="rpcRequest"){const g=u.value.value;this.handleIncomingRpcRequest(u.participantIdentity,g.id,g.method,g.payload,g.responseTimeoutMs,g.version)}},this.handleUserPacket=(u,f,h,g)=>{this.emit(H.DataReceived,f.payload,u,h,f.topic,g),u?.emit(ee.DataReceived,f.payload,h,g)},this.handleSipDtmf=(u,f)=>{this.emit(H.SipDTMFReceived,f,u),u?.emit(ee.SipDTMFReceived,f)},this.handleTranscription=(u,f)=>{const h=f.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(f.transcribedParticipantIdentity),g=h?.trackPublications.get(f.trackId),v=dw(f,this.transcriptionReceivedTimes);g?.emit(ne.TranscriptionReceived,v),h?.emit(ee.TranscriptionReceived,v,g),this.emit(H.TranscriptionReceived,v,h,g)},this.handleChatMessage=(u,f)=>{const h=fw(f);this.emit(H.ChatMessage,h,u)},this.handleMetrics=(u,f)=>{this.emit(H.MetricsReceived,u,f)},this.handleDataStream=(u,f)=>{this.incomingDataStreamManager.handleDataStreamPacket(u,f)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(H.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=u=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:u})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(H.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(H.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(H.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>w(this,void 0,void 0,function*(){var u;((u=Jt())===null||u===void 0?void 0:u.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(H.MediaDevicesChanged)}),this.handleRoomUpdate=u=>{const f=this.roomInfo;this.roomInfo=u,f&&f.metadata!==u.metadata&&this.emitWhenConnected(H.RoomMetadataChanged,u.metadata),f?.activeRecording!==u.activeRecording&&this.emitWhenConnected(H.RecordingStatusChanged,u.activeRecording)},this.handleConnectionQualityUpdate=u=>{u.updates.forEach(f=>{if(f.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(f.quality);return}const h=this.getRemoteParticipantBySid(f.participantSid);h&&h.setConnectionQuality(f.quality)})},this.onLocalParticipantMetadataChanged=u=>{this.emit(H.ParticipantMetadataChanged,u,this.localParticipant)},this.onLocalParticipantNameChanged=u=>{this.emit(H.ParticipantNameChanged,u,this.localParticipant)},this.onLocalAttributesChanged=u=>{this.emit(H.ParticipantAttributesChanged,u,this.localParticipant)},this.onLocalTrackMuted=u=>{this.emit(H.TrackMuted,u,this.localParticipant)},this.onLocalTrackUnmuted=u=>{this.emit(H.TrackUnmuted,u,this.localParticipant)},this.onTrackProcessorUpdate=u=>{var f;(f=u?.onPublish)===null||f===void 0||f.call(u,this)},this.onLocalTrackPublished=u=>w(this,void 0,void 0,function*(){var f,h,g,v,b,T;(f=u.track)===null||f===void 0||f.on(ne.TrackProcessorUpdate,this.onTrackProcessorUpdate),(h=u.track)===null||h===void 0||h.on(ne.Restarted,this.onLocalTrackRestarted),(b=(v=(g=u.track)===null||g===void 0?void 0:g.getProcessor())===null||v===void 0?void 0:v.onPublish)===null||b===void 0||b.call(v,this),this.emit(H.LocalTrackPublished,u,this.localParticipant),li(u.track)&&(yield u.track.checkForSilence())&&this.emit(H.LocalAudioSilenceDetected,u);const _=yield(T=u.track)===null||T===void 0?void 0:T.getDeviceId(!1),C=zf(u.source);C&&_&&_!==this.localParticipant.activeDeviceMap.get(C)&&(this.localParticipant.activeDeviceMap.set(C,_),this.emit(H.ActiveDeviceChanged,C,_))}),this.onLocalTrackUnpublished=u=>{var f,h;(f=u.track)===null||f===void 0||f.off(ne.TrackProcessorUpdate,this.onTrackProcessorUpdate),(h=u.track)===null||h===void 0||h.off(ne.Restarted,this.onLocalTrackRestarted),this.emit(H.LocalTrackUnpublished,u,this.localParticipant)},this.onLocalTrackRestarted=u=>w(this,void 0,void 0,function*(){const f=yield u.getDeviceId(!1),h=zf(u.source);h&&f&&f!==this.localParticipant.activeDeviceMap.get(h)&&(this.log.debug("local track restarted, setting ".concat(h," ").concat(f," active"),this.logContext),this.localParticipant.activeDeviceMap.set(h,f),this.emit(H.ActiveDeviceChanged,h,f))}),this.onLocalConnectionQualityChanged=u=>{this.emit(H.ConnectionQualityChanged,u,this.localParticipant)},this.onMediaDevicesError=(u,f)=>{this.emit(H.MediaDevicesError,u,f)},this.onLocalParticipantPermissionsChanged=u=>{this.emit(H.ParticipantPermissionsChanged,u,this.localParticipant)},this.onLocalChatMessageSent=u=>{this.emit(H.ChatMessage,u,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},Gw),e),this.log=vi((r=this.options.loggerName)!==null&&r!==void 0?r:Mn.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},RS),e?.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},wS),e?.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Hw),e?.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new TO,this.outgoingDataStreamManager=new EO(this.engine,this.log),this.disconnectLock=new Ut,this.localParticipant=new MO("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Wi(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Wi(this.options.audioCaptureDefaults.deviceId)),!((o=this.options.audioOutput)===null||o===void 0)&&o.deviceId&&this.switchActiveDevice("audiooutput",Wi(this.options.audioOutput.deviceId)).catch(u=>this.log.warn("Could not set audio output: ".concat(u.message),this.logContext)),Kt()){const u=new AbortController;(d=(c=navigator.mediaDevices)===null||c===void 0?void 0:c.addEventListener)===null||d===void 0||d.call(c,"devicechange",this.handleDeviceChange,{signal:u.signal}),Nr.cleanupRegistry&&Nr.cleanupRegistry.register(this,()=>{u.abort()})}}registerTextStreamHandler(e,n){return this.incomingDataStreamManager.registerTextStreamHandler(e,n)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,n){return this.incomingDataStreamManager.registerByteStreamHandler(e,n)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,n){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return w(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;const n=!!this.options.encryption,r=this.options.encryption||this.options.e2ee;r&&("e2eeManager"in r?(this.e2eeManager=r.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=n):this.e2eeManager=new ww(r,n),this.e2eeManager.on(Xi.ParticipantEncryptionStatusChanged,(o,c)=>{mw(c)&&(this.isE2EEEnabled=o),this.emit(H.ParticipantEncryptionStatusChanged,o,c)}),this.e2eeManager.on(Xi.EncryptionError,(o,c)=>{const d=c?this.getParticipantByIdentity(c):void 0;this.emit(H.EncryptionError,o,d)}),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return this.state===Ie.Disconnected?Yt.resolve(""):this.roomInfo&&this.roomInfo.sid!==""?Yt.resolve(this.roomInfo.sid):new Yt((e,n)=>{const r=o=>{o.sid!==""&&(this.engine.off(re.RoomUpdate,r),e(o.sid))};this.engine.on(re.RoomUpdate,r),this.once(H.Disconnected,()=>{this.engine.off(re.RoomUpdate,r),n(new lt("Room disconnected before room server id was available"))})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new vO(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(re.ParticipantUpdate,this.handleParticipantUpdates).on(re.RoomUpdate,this.handleRoomUpdate).on(re.SpeakersChanged,this.handleSpeakersChanged).on(re.StreamStateChanged,this.handleStreamStateUpdate).on(re.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(re.SubscriptionError,this.handleSubscriptionError).on(re.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(re.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(re.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(re.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(re.DataPacketReceived,this.handleDataPacket).on(re.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(Ie.SignalReconnecting)&&this.emit(H.SignalReconnecting)}).on(re.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(Ie.Connected)&&this.emit(H.Reconnected)}).on(re.SignalResumed,()=>{this.bufferedEvents=[],(this.state===Ie.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(re.Restarting,this.handleRestarting).on(re.SignalRestarted,this.handleSignalRestarted).on(re.Offline,()=>{this.setAndEmitConnectionState(Ie.Reconnecting)&&this.emit(H.Reconnecting)}).on(re.DCBufferStatusChanged,(e,n)=>{this.emit(H.DCBufferStatusChanged,e,n)}).on(re.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:o}=r;return o===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(ee.LocalTrackSubscribed,n),this.emitWhenConnected(H.LocalTrackSubscribed,n,this.localParticipant)}).on(re.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((n,r)=>{this.handleParticipantDisconnected(r,n)}),this.emit(H.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Ct.getInstance().getDevices(e,n)}prepareConnection(e,n){return w(this,void 0,void 0,function*(){if(this.state===Ie.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Pr(new URL(e))&&n){this.regionUrlProvider=new Pe(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===Ie.Disconnected&&(this.regionUrl=r,yield fetch(no(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(no(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return w(this,void 0,void 0,function*(){let r=()=>w(this,void 0,void 0,function*(){}),o;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":o=new In({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":o=new In({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":o=new In({scenario:{case:"serverLeave",value:!0}});break;case"migration":o=new In({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>w(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new In({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>w(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new In({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":o=new In({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>w(this,void 0,void 0,function*(){const c=this.engine.client.onLeave;c&&c(new bl({reason:Dn.CLIENT_INITIATED,action:Er.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");o=new In({scenario:{case:"subscriberBandwidth",value:Ra(n)}});break;case"leave-full-reconnect":o=new In({scenario:{case:"leaveRequestFullReconnect",value:!0}})}o&&(yield this.engine.client.sendSimulateScenario(o),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return w(this,arguments,void 0,function(r,o){var c=this;let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return(function*(){var u,f,h,g,v,b,T;let _=!0,C=!1;const M=d?{exact:o}:o;if(r==="audioinput"){C=c.localParticipant.audioTrackPublications.size===0;const R=(u=c.getActiveDevice(r))!==null&&u!==void 0?u:c.options.audioCaptureDefaults.deviceId;c.options.audioCaptureDefaults.deviceId=M;const B=Array.from(c.localParticipant.audioTrackPublications.values()).filter(E=>E.source===J.Source.Microphone);try{_=(yield Promise.all(B.map(E=>{var k;return(k=E.audioTrack)===null||k===void 0?void 0:k.setDeviceId(M)}))).every(E=>E===!0)}catch(E){throw c.options.audioCaptureDefaults.deviceId=R,E}const q=B.some(E=>{var k,D;return(D=(k=E.track)===null||k===void 0?void 0:k.isMuted)!==null&&D!==void 0?D:!1});_&&q&&(C=!0)}else if(r==="videoinput"){C=c.localParticipant.videoTrackPublications.size===0;const R=(f=c.getActiveDevice(r))!==null&&f!==void 0?f:c.options.videoCaptureDefaults.deviceId;c.options.videoCaptureDefaults.deviceId=M;const B=Array.from(c.localParticipant.videoTrackPublications.values()).filter(E=>E.source===J.Source.Camera);try{_=(yield Promise.all(B.map(E=>{var k;return(k=E.videoTrack)===null||k===void 0?void 0:k.setDeviceId(M)}))).every(E=>E===!0)}catch(E){throw c.options.videoCaptureDefaults.deviceId=R,E}const q=B.some(E=>{var k,D;return(D=(k=E.track)===null||k===void 0?void 0:k.isMuted)!==null&&D!==void 0?D:!1});_&&q&&(C=!0)}else if(r==="audiooutput"){if(C=!0,!Ff()&&!c.options.webAudioMix||c.options.webAudioMix&&c.audioContext&&!("setSinkId"in c.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");c.options.webAudioMix&&(o=(h=yield Ct.getInstance().normalizeDeviceId("audiooutput",o))!==null&&h!==void 0?h:""),(g=(T=c.options).audioOutput)!==null&&g!==void 0||(T.audioOutput={});const R=(v=c.getActiveDevice(r))!==null&&v!==void 0?v:c.options.audioOutput.deviceId;c.options.audioOutput.deviceId=o;try{c.options.webAudioMix&&((b=c.audioContext)===null||b===void 0||b.setSinkId(o)),yield Promise.all(Array.from(c.remoteParticipants.values()).map(B=>B.setAudioOutput({deviceId:o})))}catch(B){throw c.options.audioOutput.deviceId=R,B}}return C&&(c.localParticipant.activeDeviceMap.set(r,o),c.emit(H.ActiveDeviceChanged,r,o)),_})()})}setupLocalParticipantEvents(){this.localParticipant.on(ee.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(ee.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(ee.AttributesChanged,this.onLocalAttributesChanged).on(ee.TrackMuted,this.onLocalTrackMuted).on(ee.TrackUnmuted,this.onLocalTrackUnmuted).on(ee.LocalTrackPublished,this.onLocalTrackPublished).on(ee.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(ee.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(ee.MediaDevicesError,this.onMediaDevicesError).on(ee.AudioStreamAcquired,this.startAudio).on(ee.ChatMessage,this.onLocalChatMessageSent).on(ee.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===Ie.Connecting||this.state===Ie.Reconnecting){const v=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:n.id,tracksInStream:n.getTracks().map(T=>T.id)}),this.onTrackAdded(e,n,r),b()},b=()=>{this.off(H.Reconnected,v),this.off(H.Connected,v),this.off(H.Disconnected,b)};this.once(H.Reconnected,v),this.once(H.Connected,v),this.once(H.Disconnected,b);return}if(this.state===Ie.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const o=$R(n.id),c=o[0];let d=o[1],u=e.id;if(d&&d.startsWith("TR")&&(u=d),c===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const f=Array.from(this.remoteParticipants.values()).find(v=>v.sid===c);if(!f){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(c),this.logContext);return}if(!u.startsWith("TR")){const v=this.engine.getTrackIdForReceiver(r);if(!v){this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(c),this.logContext);return}u=v}u.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(c,", streamId: ").concat(d,", trackId: ").concat(u),Object.assign(Object.assign({},this.logContext),{rpID:c,streamId:d,trackId:u}));let h;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?h=this.options.adaptiveStream:h={});const g=f.addSubscribedMediaTrack(e,u,n,r,h);g?.isEncrypted&&!this.e2eeManager&&this.emit(H.EncryptionError,new Error("Encrypted ".concat(g.source," track received from participant ").concat(f.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r,o;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearControllers(),this.state!==Ie.Disconnected){this.regionUrl=void 0,this.regionUrlProvider&&this.regionUrlProvider.notifyDisconnected();try{this.remoteParticipants.forEach(c=>{c.trackPublications.forEach(d=>{c.unpublishTrack(d.trackSid)})}),this.localParticipant.trackPublications.forEach(c=>{var d,u,f;c.track&&this.localParticipant.unpublishTrack(c.track,e),e?((d=c.track)===null||d===void 0||d.detach(),(u=c.track)===null||u===void 0||u.stop()):(f=c.track)===null||f===void 0||f.stopMonitor()}),this.localParticipant.off(ee.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(ee.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(ee.AttributesChanged,this.onLocalAttributesChanged).off(ee.TrackMuted,this.onLocalTrackMuted).off(ee.TrackUnmuted,this.onLocalTrackUnmuted).off(ee.LocalTrackPublished,this.onLocalTrackPublished).off(ee.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(ee.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(ee.MediaDevicesError,this.onMediaDevicesError).off(ee.AudioStreamAcquired,this.startAudio).off(ee.ChatMessage,this.onLocalChatMessageSent).off(ee.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Kt()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(o=(r=navigator.mediaDevices)===null||r===void 0?void 0:r.removeEventListener)===null||o===void 0||o.call(r,"devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(Ie.Disconnected),this.emit(H.Disconnected,n)}}}handleParticipantDisconnected(e,n){var r;this.remoteParticipants.delete(e),n&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),n.trackPublications.forEach(o=>{n.unpublishTrack(o.trackSid,!0)}),this.emit(H.ParticipantDisconnected,n),n.setDisconnected(),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(n.identity))}handleIncomingRpcRequest(e,n,r,o,c,d){return w(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,n),d!==1){yield this.engine.publishRpcResponse(e,n,null,st.builtIn("UNSUPPORTED_VERSION"));return}const u=this.rpcHandlers.get(r);if(!u){yield this.engine.publishRpcResponse(e,n,null,st.builtIn("UNSUPPORTED_METHOD"));return}let f=null,h=null;try{const g=yield u({requestId:n,callerIdentity:e,payload:o,responseTimeout:c});Mh(g)>AS?(f=st.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),this.log.warn("RPC Response payload too large for ".concat(r))):h=g}catch(g){g instanceof st?f=g:(this.log.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),g),f=st.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,n,h,f)})}selectDefaultDevices(){return w(this,void 0,void 0,function*(){var e,n,r;const o=Ct.getInstance().previousDevices,c=yield Ct.getInstance().getDevices(void 0,!1),d=Jt();if(d?.name==="Chrome"&&d.os!=="iOS")for(let f of c){const h=o.find(g=>g.deviceId===f.deviceId);h&&h.label!==""&&h.kind===f.kind&&h.label!==f.label&&this.getActiveDevice(f.kind)==="default"&&this.emit(H.ActiveDeviceChanged,f.kind,f.deviceId)}const u=["audiooutput","audioinput","videoinput"];for(let f of u){const h=HR(f),g=this.localParticipant.getTrackPublication(h);if(g&&(!((e=g.track)===null||e===void 0)&&e.isUserProvided))continue;const v=c.filter(T=>T.kind===f),b=this.getActiveDevice(f);if(b===((n=o.filter(T=>T.kind===f)[0])===null||n===void 0?void 0:n.deviceId)&&v.length>0&&((r=v[0])===null||r===void 0?void 0:r.deviceId)!==b){yield this.switchActiveDevice(f,v[0].deviceId);continue}f==="audioinput"&&!to()||f==="videoinput"||v.length>0&&!v.find(T=>T.deviceId===this.getActiveDevice(f))&&(f!=="audiooutput"||!to())&&(yield this.switchActiveDevice(f,v[0].deviceId))}})}acquireAudioContext(){return w(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=SS())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(o=>o.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),At(200)])}catch(o){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:o}))}const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(H.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let o;return n?o=cl.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):o=new cl(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&o.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&o.setAudioOutput(this.options.audioOutput).catch(c=>this.log.warn("Could not set audio output: ".concat(c.message),this.logContext)),o}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const o=this.remoteParticipants.get(e);return n&&o.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),o}const r=this.createParticipant(e,n);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(H.ParticipantConnected,r),r.on(ee.TrackPublished,o=>{this.emitWhenConnected(H.TrackPublished,o,r)}).on(ee.TrackSubscribed,(o,c)=>{o.kind===J.Kind.Audio?(o.on(ne.AudioPlaybackStarted,this.handleAudioPlaybackStarted),o.on(ne.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):o.kind===J.Kind.Video&&(o.on(ne.VideoPlaybackFailed,this.handleVideoPlaybackFailed),o.on(ne.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(H.TrackSubscribed,o,c,r)}).on(ee.TrackUnpublished,o=>{this.emit(H.TrackUnpublished,o,r)}).on(ee.TrackUnsubscribed,(o,c)=>{this.emit(H.TrackUnsubscribed,o,c,r)}).on(ee.TrackMuted,o=>{this.emitWhenConnected(H.TrackMuted,o,r)}).on(ee.TrackUnmuted,o=>{this.emitWhenConnected(H.TrackUnmuted,o,r)}).on(ee.ParticipantMetadataChanged,o=>{this.emitWhenConnected(H.ParticipantMetadataChanged,o,r)}).on(ee.ParticipantNameChanged,o=>{this.emitWhenConnected(H.ParticipantNameChanged,o,r)}).on(ee.AttributesChanged,o=>{this.emitWhenConnected(H.ParticipantAttributesChanged,o,r)}).on(ee.ConnectionQualityChanged,o=>{this.emitWhenConnected(H.ConnectionQualityChanged,o,r)}).on(ee.ParticipantPermissionsChanged,o=>{this.emitWhenConnected(H.ParticipantPermissionsChanged,o,r)}).on(ee.TrackSubscriptionStatusChanged,(o,c)=>{this.emitWhenConnected(H.TrackSubscriptionStatusChanged,o,c,r)}).on(ee.TrackSubscriptionFailed,(o,c)=>{this.emit(H.TrackSubscriptionFailed,o,r,c)}).on(ee.TrackSubscriptionPermissionChanged,(o,c)=>{this.emitWhenConnected(H.TrackSubscriptionPermissionChanged,o,c,r)}).on(ee.Active,()=>{this.emitWhenConnected(H.ParticipantActive,r),r.kind===Zs.AGENT&&this.localParticipant.setActiveAgent(r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,o)=>(r.push(...o.getTrackPublications()),r),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&hw(n)&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=Ot.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Dn.STATE_MISMATCH))):e=0},xO)}clearConnectionReconcile(){this.connectionReconcileInterval&&Ot.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(H.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(this.state===Ie.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===Ie.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return w(this,void 0,void 0,function*(){var n,r,o,c;const d=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),u=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new pl({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:$e.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new Oa({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(H.SignalConnected),this.emit(H.Connected),this.setAndEmitConnectionState(Ie.Connected),d.video){const f=new Xf(J.Kind.Video,new Sr({source:pt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:wn.AUDIO,name:"video-dummy"}),new sl(d.useRealTracks&&(!((n=window.navigator.mediaDevices)===null||n===void 0)&&n.getUserMedia)?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Gy(160*((r=u.aspectRatios[0])!==null&&r!==void 0?r:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(f),this.localParticipant.emit(ee.LocalTrackPublished,f)}if(d.audio){const f=new Xf(J.Kind.Audio,new Sr({source:pt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:wn.AUDIO}),new rl(d.useRealTracks&&(!((o=navigator.mediaDevices)===null||o===void 0)&&o.getUserMedia)?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:lf(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(f),this.localParticipant.emit(ee.LocalTrackPublished,f)}for(let f=0;f<u.count-1;f+=1){let h=new Oa({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(f),state:kr.ACTIVE,tracks:[],joinedAt:$e.parse(Date.now())});const g=this.getOrCreateParticipant(h.identity,h);if(u.video){const v=Gy(160*((c=u.aspectRatios[f%u.aspectRatios.length])!==null&&c!==void 0?c:1),160,!1,!0),b=new Sr({source:pt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:wn.AUDIO});g.addSubscribedMediaTrack(v,b.sid,new MediaStream([v]),new RTCRtpReceiver),h.tracks=[...h.tracks,b]}if(u.audio){const v=lf(),b=new Sr({source:pt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:wn.AUDIO});g.addSubscribedMediaTrack(v,b.sid,new MediaStream([v]),new RTCRtpReceiver),h.tracks=[...h.tracks,b]}g.updateInfo(h)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(e!==H.ActiveSpeakersChanged&&e!==H.TranscriptionReceived){const c=jS(r).filter(d=>d!==void 0);(e===H.TrackSubscribed||e===H.TrackUnsubscribed)&&this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:c})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:c}))}return super.emit(e,...r)}}Nr.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(i=>{i()});function jS(i){return i.map(e=>{if(e)return Array.isArray(e)?jS(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var Rn;(function(i){i[i.IDLE=0]="IDLE",i[i.RUNNING=1]="RUNNING",i[i.SKIPPED=2]="SKIPPED",i[i.SUCCESS=3]="SUCCESS",i[i.FAILED=4]="FAILED"})(Rn||(Rn={}));class ra extends Vn.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Rn.IDLE,this.logs=[],this.options={},this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Nr(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return w(this,void 0,void 0,function*(){if(this.status!==Rn.IDLE)throw Error("check is running already");this.setStatus(Rn.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==Rn.SKIPPED&&this.setStatus(this.isSuccess()?Rn.SUCCESS:Rn.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return w(this,void 0,void 0,function*(){return this.room.state===Ie.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return w(this,void 0,void 0,function*(){this.room&&this.room.state!==Ie.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Rn.SKIPPED)}switchProtocol(e){return w(this,void 0,void 0,function*(){let n=!1,r=!1;if(this.room.on(H.Reconnecting,()=>{n=!0}),this.room.once(H.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(c=>setTimeout(c,1e3)),!n)return;const o=Date.now()+1e4;for(;Date.now()<o;){if(r)return;yield At(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class PO extends ra{get description(){return"Cloud regions"}perform(){return w(this,void 0,void 0,function*(){const e=new Pe(this.url,this.token);if(!e.isCloud()){this.skip();return}const n=[],r=new Set;for(let c=0;c<3;c++){const d=yield e.getNextBestRegionUrl();if(!d)break;if(r.has(d))continue;r.add(d);const u=yield this.checkCloudRegion(d);this.appendMessage("".concat(u.region," RTT: ").concat(u.rtt,"ms, duration: ").concat(u.duration,"ms")),n.push(u)}n.sort((c,d)=>(c.duration-d.duration)*.5+(c.rtt-d.rtt)*.5);const o=n[0];this.bestStats=o,this.appendMessage("best Cloud region: ".concat(o.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return w(this,void 0,void 0,function*(){var n,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const o=(n=this.room.serverInfo)===null||n===void 0?void 0:n.region;if(!o)throw new Error("Region not found");const c=yield this.room.localParticipant.streamText({topic:"test"}),d=1e3,f=1e6/d,h="A".repeat(d),g=Date.now();for(let _=0;_<f;_++)yield c.write(h);yield c.close();const v=Date.now(),b=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),T={region:o,rtt:1e4,duration:v-g};return b?.forEach(_=>{_.type==="candidate-pair"&&_.nominated&&(T.rtt=_.currentRoundTripTime*1e3)}),yield this.disconnect(),T})}}const yf=1e4;class NO extends ra{get description(){return"Connection via UDP vs TCP"}perform(){return w(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),n=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-n.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-n.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=n):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(yf/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(yf/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return w(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const n=document.createElement("canvas");n.width=1280,n.height=720;const r=n.getContext("2d");if(!r)throw new Error("Could not get canvas context");let o=0;const c=()=>{o=(o+1)%360,r.fillStyle="hsl(".concat(o,", 100%, 50%)"),r.fillRect(0,0,n.width,n.height),requestAnimationFrame(c)};c();const u=n.captureStream(30).getVideoTracks()[0],h=(yield this.room.localParticipant.publishTrack(u,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,g={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},v=setInterval(()=>w(this,void 0,void 0,function*(){const b=yield h.getRTCStatsReport();b?.forEach(T=>{T.type==="outbound-rtp"?(g.packetsSent=T.packetsSent,g.qualityLimitationDurations=T.qualityLimitationDurations,g.bitrateTotal+=T.targetBitrate,g.count++):T.type==="remote-inbound-rtp"&&(g.packetsLost=T.packetsLost,g.rttTotal+=T.roundTripTime,g.jitterTotal+=T.jitter)})}),1e3);return yield new Promise(b=>setTimeout(b,yf)),clearInterval(v),u.stop(),n.remove(),yield this.disconnect(),g})}}class LO extends ra{get description(){return"Can publish audio"}perform(){return w(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield OO();if(yield bS(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),n.localParticipant.publishTrack(r),yield new Promise(u=>setTimeout(u,3e3));const c=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!c)throw new Error("Could not get RTCStats");let d=0;if(c.forEach(u=>{u.type==="outbound-rtp"&&(u.kind==="audio"||!u.kind&&u.mediaType==="audio")&&(d=u.packetsSent)}),d===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(d," audio packets"))})}}class UO extends ra{get description(){return"Can publish video"}perform(){return w(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield wO();yield this.checkForVideo(r.mediaStreamTrack),n.localParticipant.publishTrack(r),yield new Promise(d=>setTimeout(d,5e3));const o=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let c=0;if(o.forEach(d=>{d.type==="outbound-rtp"&&(d.kind==="video"||!d.kind&&d.mediaType==="video")&&(c+=d.packetsSent)}),c===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(c," video packets"))})}checkForVideo(e){return w(this,void 0,void 0,function*(){const n=new MediaStream;n.addTrack(e.clone());const r=document.createElement("video");r.srcObject=n,r.muted=!0,r.autoplay=!0,r.playsInline=!0,r.setAttribute("playsinline","true"),document.body.appendChild(r),yield new Promise(o=>{r.onplay=()=>{setTimeout(()=>{var c,d,u,f;const h=document.createElement("canvas"),g=e.getSettings(),v=(d=(c=g.width)!==null&&c!==void 0?c:r.videoWidth)!==null&&d!==void 0?d:1280,b=(f=(u=g.height)!==null&&u!==void 0?u:r.videoHeight)!==null&&f!==void 0?f:720;h.width=v,h.height=b;const T=h.getContext("2d");T.drawImage(r,0,0);const C=T.getImageData(0,0,h.width,h.height).data;let M=!0;for(let R=0;R<C.length;R+=4)if(C[R]!==0||C[R+1]!==0||C[R+2]!==0){M=!1;break}M?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),o()},1e3)},r.play()}),n.getTracks().forEach(o=>o.stop()),r.remove()})}}class IO extends ra{get description(){return"Resuming connection after interruption"}perform(){return w(this,void 0,void 0,function*(){var e;const n=yield this.connect();let r=!1,o=!1,c;const d=new Promise(h=>{setTimeout(h,5e3),c=h}),u=()=>{r=!0};n.on(H.SignalReconnecting,u).on(H.Reconnecting,u).on(H.Reconnected,()=>{o=!0,c(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const f=n.engine.client.onClose;if(f&&f(""),yield d,r){if(!o||n.state!==Ie.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class jO extends ra{get description(){return"Can connect via TURN"}perform(){return w(this,void 0,void 0,function*(){var e,n,r;Pr(new URL(this.url))&&(this.appendMessage("Using region specific url"),this.url=(e=yield new Pe(this.url,this.token).getNextBestRegionUrl())!==null&&e!==void 0?e:this.url);const o=new Rh,c=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0);let d=!1,u=!1,f=!1;for(let h of c.iceServers)for(let g of h.urls)g.startsWith("turn:")?(u=!0,f=!0):g.startsWith("turns:")&&(u=!0,f=!0,d=!0),g.startsWith("stun:")&&(f=!0);f?u&&!d&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield o.close(),!((r=(n=this.connectOptions)===null||n===void 0?void 0:n.rtcConfig)===null||r===void 0)&&r.iceServers||u?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(h=>setTimeout(h,0)))})}}class BO extends ra{get description(){return"Establishing WebRTC connection"}perform(){return w(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(H.SignalConnected,()=>{var r;const o=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(c,d)=>{if(c.candidate){const u=new RTCIceCandidate(c);let f="".concat(u.protocol," ").concat(u.address,":").concat(u.port," ").concat(u.type);u.address&&(zO(u.address)?f+=" (private)":u.protocol==="tcp"&&u.tcpType==="passive"?(e=!0,f+=" (passive)"):u.protocol==="udp"&&(n=!0)),this.appendMessage(f)}o&&o(c,d)},!((r=this.room.engine.pcManager)===null||r===void 0)&&r.subscriber&&(this.room.engine.pcManager.subscriber.onIceCandidateError=c=>{c instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(c.errorCode," ").concat(c.errorText," ").concat(c.url))})});try{yield this.connect(),Te.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function zO(i){const e=i.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class qO extends ra{get description(){return"Connecting to signal connection via WebSocket"}perform(){return w(this,void 0,void 0,function*(){var e,n,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let o=new Rh,c;try{c=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0)}catch(d){if(Pr(new URL(this.url))){this.appendMessage("Initial connection failed with error ".concat(d.message,". Retrying with region fallback"));const f=yield new Pe(this.url,this.token).getNextBestRegionUrl();f&&(c=yield o.join(f,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3},void 0,!0),this.appendMessage("Fallback to region worked. To avoid initial connections failing, ensure you're calling room.prepareConnection() ahead of time"))}}c?(this.appendMessage("Connected to server, version ".concat(c.serverVersion,".")),((e=c.serverInfo)===null||e===void 0?void 0:e.edition)===kb.Cloud&&(!((n=c.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=c.serverInfo)===null||r===void 0?void 0:r.region))):this.appendError("Websocket connection could not be established"),yield o.close()})}}class pM extends Vn.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Rn.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Rn.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return w(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token,this.options),o=d=>{this.updateCheck(n,d)};r.on("update",o);const c=yield r.run();return r.off("update",o),c})}checkWebsocket(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(qO)})}checkWebRTC(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(BO)})}checkTURN(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(jO)})}checkReconnect(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(IO)})}checkPublishAudio(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(LO)})}checkPublishVideo(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(UO)})}checkConnectionProtocol(){return w(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(NO);if(e.data&&"protocol"in e.data){const n=e.data;this.options.protocol=n.protocol}return e})}checkCloudRegion(){return w(this,void 0,void 0,function*(){return this.createAndRunCheck(PO)})}}function we(i,e,n){return(e=FO(e))in i?Object.defineProperty(i,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[e]=n,i}function VO(i,e){if(typeof i!="object"||!i)return i;var n=i[Symbol.toPrimitive];if(n!==void 0){var r=n.call(i,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function FO(i){var e=VO(i,"string");return typeof e=="symbol"?e:e+""}new TextEncoder;new TextDecoder;class It extends Error{constructor(e,n){var r;super(e,n),we(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,this.constructor)}}we(It,"code","ERR_JOSE_GENERIC");class HO extends It{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:o,payload:n}}),we(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),we(this,"claim",void 0),we(this,"reason",void 0),we(this,"payload",void 0),this.claim=r,this.reason=o,this.payload=n}}we(HO,"code","ERR_JWT_CLAIM_VALIDATION_FAILED");class GO extends It{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"unspecified",o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unspecified";super(e,{cause:{claim:r,reason:o,payload:n}}),we(this,"code","ERR_JWT_EXPIRED"),we(this,"claim",void 0),we(this,"reason",void 0),we(this,"payload",void 0),this.claim=r,this.reason=o,this.payload=n}}we(GO,"code","ERR_JWT_EXPIRED");class YO extends It{constructor(){super(...arguments),we(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}}we(YO,"code","ERR_JOSE_ALG_NOT_ALLOWED");class KO extends It{constructor(){super(...arguments),we(this,"code","ERR_JOSE_NOT_SUPPORTED")}}we(KO,"code","ERR_JOSE_NOT_SUPPORTED");class JO extends It{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"decryption operation failed",n=arguments.length>1?arguments[1]:void 0;super(e,n),we(this,"code","ERR_JWE_DECRYPTION_FAILED")}}we(JO,"code","ERR_JWE_DECRYPTION_FAILED");class QO extends It{constructor(){super(...arguments),we(this,"code","ERR_JWE_INVALID")}}we(QO,"code","ERR_JWE_INVALID");class XO extends It{constructor(){super(...arguments),we(this,"code","ERR_JWS_INVALID")}}we(XO,"code","ERR_JWS_INVALID");class ZO extends It{constructor(){super(...arguments),we(this,"code","ERR_JWT_INVALID")}}we(ZO,"code","ERR_JWT_INVALID");class WO extends It{constructor(){super(...arguments),we(this,"code","ERR_JWK_INVALID")}}we(WO,"code","ERR_JWK_INVALID");class $O extends It{constructor(){super(...arguments),we(this,"code","ERR_JWKS_INVALID")}}we($O,"code","ERR_JWKS_INVALID");class eA extends It{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"no applicable key found in the JSON Web Key Set",n=arguments.length>1?arguments[1]:void 0;super(e,n),we(this,"code","ERR_JWKS_NO_MATCHING_KEY")}}we(eA,"code","ERR_JWKS_NO_MATCHING_KEY");class tA extends It{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"multiple matching keys found in the JSON Web Key Set",n=arguments.length>1?arguments[1]:void 0;super(e,n),we(this,Symbol.asyncIterator,void 0),we(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}}we(tA,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");class nA extends It{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"request timed out",n=arguments.length>1?arguments[1]:void 0;super(e,n),we(this,"code","ERR_JWKS_TIMEOUT")}}we(nA,"code","ERR_JWKS_TIMEOUT");class iA extends It{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"signature verification failed",n=arguments.length>1?arguments[1]:void 0;super(e,n),we(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}}we(iA,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");var xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function BS(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Zf={exports:{}},aA=Zf.exports,p0;function rA(){return p0||(p0=1,(function(i){(function(e,n){i.exports?i.exports=n():e.log=n()})(aA,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],c={},d=null;function u(C,M){var R=C[M];if(typeof R.bind=="function")return R.bind(C);try{return Function.prototype.bind.call(R,C)}catch{return function(){return Function.prototype.apply.apply(R,[C,arguments])}}}function f(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function h(C){return C==="debug"&&(C="log"),typeof console===n?!1:C==="trace"&&r?f:console[C]!==void 0?u(console,C):console.log!==void 0?u(console,"log"):e}function g(){for(var C=this.getLevel(),M=0;M<o.length;M++){var R=o[M];this[R]=M<C?e:this.methodFactory(R,C,this.name)}if(this.log=this.debug,typeof console===n&&C<this.levels.SILENT)return"No console available for logging"}function v(C){return function(){typeof console!==n&&(g.call(this),this[C].apply(this,arguments))}}function b(C,M,R){return h(C)||v.apply(this,arguments)}function T(C,M){var R=this,B,q,E,k="loglevel";typeof C=="string"?k+=":"+C:typeof C=="symbol"&&(k=void 0);function D(W){var ie=(o[W]||"silent").toUpperCase();if(!(typeof window===n||!k)){try{window.localStorage[k]=ie;return}catch{}try{window.document.cookie=encodeURIComponent(k)+"="+ie+";"}catch{}}}function L(){var W;if(!(typeof window===n||!k)){try{W=window.localStorage[k]}catch{}if(typeof W===n)try{var ie=window.document.cookie,ve=encodeURIComponent(k),Ne=ie.indexOf(ve+"=");Ne!==-1&&(W=/^([^;]+)/.exec(ie.slice(Ne+ve.length+1))[1])}catch{}return R.levels[W]===void 0&&(W=void 0),W}}function K(){if(!(typeof window===n||!k)){try{window.localStorage.removeItem(k)}catch{}try{window.document.cookie=encodeURIComponent(k)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function G(W){var ie=W;if(typeof ie=="string"&&R.levels[ie.toUpperCase()]!==void 0&&(ie=R.levels[ie.toUpperCase()]),typeof ie=="number"&&ie>=0&&ie<=R.levels.SILENT)return ie;throw new TypeError("log.setLevel() called with invalid level: "+W)}R.name=C,R.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},R.methodFactory=M||b,R.getLevel=function(){return E??q??B},R.setLevel=function(W,ie){return E=G(W),ie!==!1&&D(E),g.call(R)},R.setDefaultLevel=function(W){q=G(W),L()||R.setLevel(W,!1)},R.resetLevel=function(){E=null,K(),g.call(R)},R.enableAll=function(W){R.setLevel(R.levels.TRACE,W)},R.disableAll=function(W){R.setLevel(R.levels.SILENT,W)},R.rebuild=function(){if(d!==R&&(B=G(d.getLevel())),g.call(R),d===R)for(var W in c)c[W].rebuild()},B=G(d?d.getLevel():"WARN");var Q=L();Q!=null&&(E=G(Q)),g.call(R)}d=new T,d.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var M=c[C];return M||(M=c[C]=new T(C,d.methodFactory)),M};var _=typeof window!==n?window.log:void 0;return d.noConflict=function(){return typeof window!==n&&window.log===d&&(window.log=_),d},d.getLoggers=function(){return c},d.default=d,d})})(Zf)),Zf.exports}var sA=rA();const oA=BS(sA);var Wf=function(i,e){return Wf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},Wf(i,e)};function yi(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Wf(i,e);function n(){this.constructor=i}i.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function cA(i,e,n,r){function o(c){return c instanceof n?c:new n(function(d){d(c)})}return new(n||(n=Promise))(function(c,d){function u(g){try{h(r.next(g))}catch(v){d(v)}}function f(g){try{h(r.throw(g))}catch(v){d(v)}}function h(g){g.done?c(g.value):o(g.value).then(u,f)}h((r=r.apply(i,[])).next())})}function zS(i,e){var n={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},r,o,c,d=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return d.next=u(0),d.throw=u(1),d.return=u(2),typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function u(h){return function(g){return f([h,g])}}function f(h){if(r)throw new TypeError("Generator is already executing.");for(;d&&(d=0,h[0]&&(n=0)),n;)try{if(r=1,o&&(c=h[0]&2?o.return:h[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,h[1])).done)return c;switch(o=0,c&&(h=[h[0]&2,c.value]),h[0]){case 0:case 1:c=h;break;case 4:return n.label++,{value:h[1],done:!1};case 5:n.label++,o=h[1],h=[0];continue;case 7:h=n.ops.pop(),n.trys.pop();continue;default:if(c=n.trys,!(c=c.length>0&&c[c.length-1])&&(h[0]===6||h[0]===2)){n=0;continue}if(h[0]===3&&(!c||h[1]>c[0]&&h[1]<c[3])){n.label=h[1];break}if(h[0]===6&&n.label<c[1]){n.label=c[1],c=h;break}if(c&&n.label<c[2]){n.label=c[2],n.ops.push(h);break}c[2]&&n.ops.pop(),n.trys.pop();continue}h=e.call(i,n)}catch(g){h=[6,g],o=0}finally{r=c=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Lr(i){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&i[e],r=0;if(n)return n.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function io(i,e){var n=typeof Symbol=="function"&&i[Symbol.iterator];if(!n)return i;var r=n.call(i),o,c=[],d;try{for(;(e===void 0||e-- >0)&&!(o=r.next()).done;)c.push(o.value)}catch(u){d={error:u}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(d)throw d.error}}return c}function ao(i,e,n){if(arguments.length===2)for(var r=0,o=e.length,c;r<o;r++)(c||!(r in e))&&(c||(c=Array.prototype.slice.call(e,0,r)),c[r]=e[r]);return i.concat(c||Array.prototype.slice.call(e))}function Mr(i){return this instanceof Mr?(this.v=i,this):new Mr(i)}function lA(i,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(i,e||[]),o,c=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",d),o[Symbol.asyncIterator]=function(){return this},o;function d(T){return function(_){return Promise.resolve(_).then(T,v)}}function u(T,_){r[T]&&(o[T]=function(C){return new Promise(function(M,R){c.push([T,C,M,R])>1||f(T,C)})},_&&(o[T]=_(o[T])))}function f(T,_){try{h(r[T](_))}catch(C){b(c[0][3],C)}}function h(T){T.value instanceof Mr?Promise.resolve(T.value.v).then(g,v):b(c[0][2],T)}function g(T){f("next",T)}function v(T){f("throw",T)}function b(T,_){T(_),c.shift(),c.length&&f(c[0][0],c[0][1])}}function uA(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],n;return e?e.call(i):(i=typeof Lr=="function"?Lr(i):i[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(c){n[c]=i[c]&&function(d){return new Promise(function(u,f){d=i[c](d),o(u,f,d.done,d.value)})}}function o(c,d,u,f){Promise.resolve(f).then(function(h){c({value:h,done:u})},d)}}function gt(i){return typeof i=="function"}function Nh(i){var e=function(r){Error.call(r),r.stack=new Error().stack},n=i(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var bf=Nh(function(i){return function(e){i(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(n,r){return r+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function ll(i,e){if(i){var n=i.indexOf(e);0<=n&&i.splice(n,1)}}var co=(function(){function i(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return i.prototype.unsubscribe=function(){var e,n,r,o,c;if(!this.closed){this.closed=!0;var d=this._parentage;if(d)if(this._parentage=null,Array.isArray(d))try{for(var u=Lr(d),f=u.next();!f.done;f=u.next()){var h=f.value;h.remove(this)}}catch(C){e={error:C}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}else d.remove(this);var g=this.initialTeardown;if(gt(g))try{g()}catch(C){c=C instanceof bf?C.errors:[C]}var v=this._finalizers;if(v){this._finalizers=null;try{for(var b=Lr(v),T=b.next();!T.done;T=b.next()){var _=T.value;try{g0(_)}catch(C){c=c??[],C instanceof bf?c=ao(ao([],io(c)),io(C.errors)):c.push(C)}}}catch(C){r={error:C}}finally{try{T&&!T.done&&(o=b.return)&&o.call(b)}finally{if(r)throw r.error}}}if(c)throw new bf(c)}},i.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)g0(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},i.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},i.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},i.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&ll(n,e)},i.prototype.remove=function(e){var n=this._finalizers;n&&ll(n,e),e instanceof i&&e._removeParent(this)},i.EMPTY=(function(){var e=new i;return e.closed=!0,e})(),i})(),qS=co.EMPTY;function VS(i){return i instanceof co||i&&"closed"in i&&gt(i.remove)&&gt(i.add)&&gt(i.unsubscribe)}function g0(i){gt(i)?i():i.unsubscribe()}var dA={Promise:void 0},fA={setTimeout:function(i,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,ao([i,e],io(n)))},clearTimeout:function(i){return clearTimeout(i)},delegate:void 0};function FS(i){fA.setTimeout(function(){throw i})}function v0(){}function Xc(i){i()}var Lh=(function(i){yi(e,i);function e(n){var r=i.call(this)||this;return r.isStopped=!1,n?(r.destination=n,VS(n)&&n.add(r)):r.destination=pA,r}return e.create=function(n,r,o){return new ro(n,r,o)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e})(co),hA=(function(){function i(e){this.partialObserver=e}return i.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(r){Pc(r)}},i.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(r){Pc(r)}else Pc(e)},i.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){Pc(n)}},i})(),ro=(function(i){yi(e,i);function e(n,r,o){var c=i.call(this)||this,d;return gt(n)||!n?d={next:n??void 0,error:r??void 0,complete:o??void 0}:d=n,c.destination=new hA(d),c}return e})(Lh);function Pc(i){FS(i)}function mA(i){throw i}var pA={closed:!0,next:v0,error:mA,complete:v0},Uh=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function Ih(i){return i}function gA(i){return i.length===0?Ih:i.length===1?i[0]:function(e){return i.reduce(function(n,r){return r(n)},e)}}var xt=(function(){function i(e){e&&(this._subscribe=e)}return i.prototype.lift=function(e){var n=new i;return n.source=this,n.operator=e,n},i.prototype.subscribe=function(e,n,r){var o=this,c=yA(e)?e:new ro(e,n,r);return Xc(function(){var d=o,u=d.operator,f=d.source;c.add(u?u.call(c,f):f?o._subscribe(c):o._trySubscribe(c))}),c},i.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},i.prototype.forEach=function(e,n){var r=this;return n=y0(n),new n(function(o,c){var d=new ro({next:function(u){try{e(u)}catch(f){c(f),d.unsubscribe()}},error:c,complete:o});r.subscribe(d)})},i.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},i.prototype[Uh]=function(){return this},i.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return gA(e)(this)},i.prototype.toPromise=function(e){var n=this;return e=y0(e),new e(function(r,o){var c;n.subscribe(function(d){return c=d},function(d){return o(d)},function(){return r(c)})})},i.create=function(e){return new i(e)},i})();function y0(i){var e;return(e=i??dA.Promise)!==null&&e!==void 0?e:Promise}function vA(i){return i&&gt(i.next)&&gt(i.error)&&gt(i.complete)}function yA(i){return i&&i instanceof Lh||vA(i)&&VS(i)}function bA(i){return gt(i?.lift)}function bi(i){return function(e){if(bA(e))return e.lift(function(n){try{return i(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ma(i,e,n,r,o){return new SA(i,e,n,r,o)}var SA=(function(i){yi(e,i);function e(n,r,o,c,d,u){var f=i.call(this,n)||this;return f.onFinalize=d,f.shouldUnsubscribe=u,f._next=r?function(h){try{r(h)}catch(g){n.error(g)}}:i.prototype._next,f._error=c?function(h){try{c(h)}catch(g){n.error(g)}finally{this.unsubscribe()}}:i.prototype._error,f._complete=o?function(){try{o()}catch(h){n.error(h)}finally{this.unsubscribe()}}:i.prototype._complete,f}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;i.prototype.unsubscribe.call(this),!r&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e})(Lh),TA=Nh(function(i){return function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),kl=(function(i){yi(e,i);function e(){var n=i.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var r=new b0(this,this);return r.operator=n,r},e.prototype._throwIfClosed=function(){if(this.closed)throw new TA},e.prototype.next=function(n){var r=this;Xc(function(){var o,c;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var d=Lr(r.currentObservers),u=d.next();!u.done;u=d.next()){var f=u.value;f.next(n)}}catch(h){o={error:h}}finally{try{u&&!u.done&&(c=d.return)&&c.call(d)}finally{if(o)throw o.error}}}})},e.prototype.error=function(n){var r=this;Xc(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=n;for(var o=r.observers;o.length;)o.shift().error(n)}})},e.prototype.complete=function(){var n=this;Xc(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var r=n.observers;r.length;)r.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),i.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var r=this,o=this,c=o.hasError,d=o.isStopped,u=o.observers;return c||d?qS:(this.currentObservers=null,u.push(n),new co(function(){r.currentObservers=null,ll(u,n)}))},e.prototype._checkFinalizedStatuses=function(n){var r=this,o=r.hasError,c=r.thrownError,d=r.isStopped;o?n.error(c):d&&n.complete()},e.prototype.asObservable=function(){var n=new xt;return n.source=this,n},e.create=function(n,r){return new b0(n,r)},e})(xt),b0=(function(i){yi(e,i);function e(n,r){var o=i.call(this)||this;return o.destination=n,o.source=r,o}return e.prototype.next=function(n){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.next)===null||o===void 0||o.call(r,n)},e.prototype.error=function(n){var r,o;(o=(r=this.destination)===null||r===void 0?void 0:r.error)===null||o===void 0||o.call(r,n)},e.prototype.complete=function(){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||r===void 0||r.call(n)},e.prototype._subscribe=function(n){var r,o;return(o=(r=this.source)===null||r===void 0?void 0:r.subscribe(n))!==null&&o!==void 0?o:qS},e})(kl);(function(i){yi(e,i);function e(n){var r=i.call(this)||this;return r._value=n,r}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var r=i.prototype._subscribe.call(this,n);return!r.closed&&n.next(this._value),r},e.prototype.getValue=function(){var n=this,r=n.hasError,o=n.thrownError,c=n._value;if(r)throw o;return this._throwIfClosed(),c},e.prototype.next=function(n){i.prototype.next.call(this,this._value=n)},e})(kl);var CA={now:function(){return Date.now()}},kA=(function(i){yi(e,i);function e(n,r){return i.call(this)||this}return e.prototype.schedule=function(n,r){return this},e})(co),S0={setInterval:function(i,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setInterval.apply(void 0,ao([i,e],io(n)))},clearInterval:function(i){return clearInterval(i)},delegate:void 0},EA=(function(i){yi(e,i);function e(n,r){var o=i.call(this,n,r)||this;return o.scheduler=n,o.work=r,o.pending=!1,o}return e.prototype.schedule=function(n,r){var o;if(r===void 0&&(r=0),this.closed)return this;this.state=n;var c=this.id,d=this.scheduler;return c!=null&&(this.id=this.recycleAsyncId(d,c,r)),this.pending=!0,this.delay=r,this.id=(o=this.id)!==null&&o!==void 0?o:this.requestAsyncId(d,this.id,r),this},e.prototype.requestAsyncId=function(n,r,o){return o===void 0&&(o=0),S0.setInterval(n.flush.bind(n,this),o)},e.prototype.recycleAsyncId=function(n,r,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return r;r!=null&&S0.clearInterval(r)},e.prototype.execute=function(n,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(n,r);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,r){var o=!1,c;try{this.work(n)}catch(d){o=!0,c=d||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),c},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,r=n.id,o=n.scheduler,c=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,ll(c,this),r!=null&&(this.id=this.recycleAsyncId(o,r,null)),this.delay=null,i.prototype.unsubscribe.call(this)}},e})(kA),T0=(function(){function i(e,n){n===void 0&&(n=i.now),this.schedulerActionCtor=e,this.now=n}return i.prototype.schedule=function(e,n,r){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(r,n)},i.now=CA.now,i})(),_A=(function(i){yi(e,i);function e(n,r){r===void 0&&(r=T0.now);var o=i.call(this,n,r)||this;return o.actions=[],o._active=!1,o}return e.prototype.flush=function(n){var r=this.actions;if(this._active){r.push(n);return}var o;this._active=!0;do if(o=n.execute(n.state,n.delay))break;while(n=r.shift());if(this._active=!1,o){for(;n=r.shift();)n.unsubscribe();throw o}},e})(T0);new _A(EA);function RA(i){return i&&gt(i.schedule)}function wA(i){return i[i.length-1]}function HS(i){return RA(wA(i))?i.pop():void 0}var GS=(function(i){return i&&typeof i.length=="number"&&typeof i!="function"});function YS(i){return gt(i?.then)}function KS(i){return gt(i[Uh])}function JS(i){return Symbol.asyncIterator&&gt(i?.[Symbol.asyncIterator])}function QS(i){return new TypeError("You provided "+(i!==null&&typeof i=="object"?"an invalid object":"'"+i+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function OA(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var XS=OA();function ZS(i){return gt(i?.[XS])}function WS(i){return lA(this,arguments,function(){var e,n,r,o;return zS(this,function(c){switch(c.label){case 0:e=i.getReader(),c.label=1;case 1:c.trys.push([1,,9,10]),c.label=2;case 2:return[4,Mr(e.read())];case 3:return n=c.sent(),r=n.value,o=n.done,o?[4,Mr(void 0)]:[3,5];case 4:return[2,c.sent()];case 5:return[4,Mr(r)];case 6:return[4,c.sent()];case 7:return c.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function $S(i){return gt(i?.getReader)}function Pa(i){if(i instanceof xt)return i;if(i!=null){if(KS(i))return AA(i);if(GS(i))return DA(i);if(YS(i))return MA(i);if(JS(i))return eT(i);if(ZS(i))return xA(i);if($S(i))return PA(i)}throw QS(i)}function AA(i){return new xt(function(e){var n=i[Uh]();if(gt(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function DA(i){return new xt(function(e){for(var n=0;n<i.length&&!e.closed;n++)e.next(i[n]);e.complete()})}function MA(i){return new xt(function(e){i.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,FS)})}function xA(i){return new xt(function(e){var n,r;try{for(var o=Lr(i),c=o.next();!c.done;c=o.next()){var d=c.value;if(e.next(d),e.closed)return}}catch(u){n={error:u}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}e.complete()})}function eT(i){return new xt(function(e){NA(i,e).catch(function(n){return e.error(n)})})}function PA(i){return eT(WS(i))}function NA(i,e){var n,r,o,c;return cA(this,void 0,void 0,function(){var d,u;return zS(this,function(f){switch(f.label){case 0:f.trys.push([0,5,6,11]),n=uA(i),f.label=1;case 1:return[4,n.next()];case 2:if(r=f.sent(),!!r.done)return[3,4];if(d=r.value,e.next(d),e.closed)return[2];f.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=f.sent(),o={error:u},[3,11];case 6:return f.trys.push([6,,9,10]),r&&!r.done&&(c=n.return)?[4,c.call(n)]:[3,8];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function wa(i,e,n,r,o){r===void 0&&(r=0),o===void 0&&(o=!1);var c=e.schedule(function(){n(),o?i.add(this.schedule(null,r)):this.unsubscribe()},r);if(i.add(c),!o)return c}function tT(i,e){return e===void 0&&(e=0),bi(function(n,r){n.subscribe(Ma(r,function(o){return wa(r,i,function(){return r.next(o)},e)},function(){return wa(r,i,function(){return r.complete()},e)},function(o){return wa(r,i,function(){return r.error(o)},e)}))})}function nT(i,e){return e===void 0&&(e=0),bi(function(n,r){r.add(i.schedule(function(){return n.subscribe(r)},e))})}function LA(i,e){return Pa(i).pipe(nT(e),tT(e))}function UA(i,e){return Pa(i).pipe(nT(e),tT(e))}function IA(i,e){return new xt(function(n){var r=0;return e.schedule(function(){r===i.length?n.complete():(n.next(i[r++]),n.closed||this.schedule())})})}function jA(i,e){return new xt(function(n){var r;return wa(n,e,function(){r=i[XS](),wa(n,e,function(){var o,c,d;try{o=r.next(),c=o.value,d=o.done}catch(u){n.error(u);return}d?n.complete():n.next(c)},0,!0)}),function(){return gt(r?.return)&&r.return()}})}function iT(i,e){if(!i)throw new Error("Iterable cannot be null");return new xt(function(n){wa(n,e,function(){var r=i[Symbol.asyncIterator]();wa(n,e,function(){r.next().then(function(o){o.done?n.complete():n.next(o.value)})},0,!0)})})}function BA(i,e){return iT(WS(i),e)}function zA(i,e){if(i!=null){if(KS(i))return LA(i,e);if(GS(i))return IA(i,e);if(YS(i))return UA(i,e);if(JS(i))return iT(i,e);if(ZS(i))return jA(i,e);if($S(i))return BA(i,e)}throw QS(i)}function aT(i,e){return e?zA(i,e):Pa(i)}Nh(function(i){return function(e){e===void 0&&(e=null),i(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function zr(i,e){return bi(function(n,r){var o=0;n.subscribe(Ma(r,function(c){r.next(i.call(e,c,o++))}))})}function qA(i,e,n,r,o,c,d,u){var f=[],h=0,g=0,v=!1,b=function(){v&&!f.length&&!h&&e.complete()},T=function(C){return h<r?_(C):f.push(C)},_=function(C){h++;var M=!1;Pa(n(C,g++)).subscribe(Ma(e,function(R){e.next(R)},function(){M=!0},void 0,function(){if(M)try{h--;for(var R=function(){var B=f.shift();d||_(B)};f.length&&h<r;)R();b()}catch(B){e.error(B)}}))};return i.subscribe(Ma(e,T,function(){v=!0,b()})),function(){}}function rT(i,e,n){return n===void 0&&(n=1/0),gt(e)?rT(function(r,o){return zr(function(c,d){return e(r,c,o,d)})(Pa(i(r,o)))},n):(typeof e=="number"&&(n=e),bi(function(r,o){return qA(r,o,i,n)}))}function VA(i){return rT(Ih,i)}function FA(){return VA(1)}function C0(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];return FA()(aT(i,HS(i)))}function HA(i,e){return bi(function(n,r){var o=0;n.subscribe(Ma(r,function(c){return i.call(e,c,o++)&&r.next(c)}))})}function GA(i,e,n,r,o){return function(c,d){var u=n,f=e,h=0;c.subscribe(Ma(d,function(g){var v=h++;f=u?i(f,g,v):(u=!0,g),d.next(f)},o))}}function YA(i,e){return bi(GA(i,e,arguments.length>=2,!0))}function KA(i){i===void 0&&(i={});var e=i.connector,n=e===void 0?function(){return new kl}:e,r=i.resetOnError,o=r===void 0?!0:r,c=i.resetOnComplete,d=c===void 0?!0:c,u=i.resetOnRefCountZero,f=u===void 0?!0:u;return function(h){var g,v,b,T=0,_=!1,C=!1,M=function(){v?.unsubscribe(),v=void 0},R=function(){M(),g=b=void 0,_=C=!1},B=function(){var q=g;R(),q?.unsubscribe()};return bi(function(q,E){T++,!C&&!_&&M();var k=b=b??n();E.add(function(){T--,T===0&&!C&&!_&&(v=Sf(B,f))}),k.subscribe(E),!g&&T>0&&(g=new ro({next:function(D){return k.next(D)},error:function(D){C=!0,M(),v=Sf(R,o,D),k.error(D)},complete:function(){_=!0,M(),v=Sf(R,d),k.complete()}}),Pa(q).subscribe(g))})(h)}}function Sf(i,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(e===!0){i();return}if(e!==!1){var o=new ro({next:function(){o.unsubscribe(),i()}});return Pa(e.apply(void 0,ao([],io(n)))).subscribe(o)}}function qr(){for(var i=[],e=0;e<arguments.length;e++)i[e]=arguments[e];var n=HS(i);return bi(function(r,o){(n?C0(i,r,n):C0(i,r)).subscribe(o)})}function JA(i,e,n){var r=gt(i)||e||n?{next:i,error:e,complete:n}:i;return r?bi(function(o,c){var d;(d=r.subscribe)===null||d===void 0||d.call(r);var u=!0;o.subscribe(Ma(c,function(f){var h;(h=r.next)===null||h===void 0||h.call(r,f),c.next(f)},function(){var f;u=!1,(f=r.complete)===null||f===void 0||f.call(r),c.complete()},function(f){var h;u=!1,(h=r.error)===null||h===void 0||h.call(r,f),c.error(f)},function(){var f,h;u&&((f=r.unsubscribe)===null||f===void 0||f.call(r)),(h=r.finalize)===null||h===void 0||h.call(r)}))}):Ih}var QA=Object.defineProperty,XA=Object.defineProperties,ZA=Object.getOwnPropertyDescriptors,k0=Object.getOwnPropertySymbols,WA=Object.prototype.hasOwnProperty,$A=Object.prototype.propertyIsEnumerable,E0=(i,e,n)=>e in i?QA(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n,sT=(i,e)=>{for(var n in e||(e={}))WA.call(e,n)&&E0(i,n,e[n]);if(k0)for(var n of k0(e))$A.call(e,n)&&E0(i,n,e[n]);return i},eD=(i,e)=>XA(i,ZA(e)),jh=(i,e,n)=>new Promise((r,o)=>{var c=f=>{try{u(n.next(f))}catch(h){o(h)}},d=f=>{try{u(n.throw(f))}catch(h){o(h)}},u=f=>f.done?r(f.value):Promise.resolve(f.value).then(c,d);u((n=n.apply(i,e)).next())}),tD="lk";function Bh(i){return typeof i>"u"?!1:nD(i)||iD(i)}function nD(i){var e;return i?i.hasOwnProperty("participant")&&i.hasOwnProperty("source")&&i.hasOwnProperty("track")&&typeof((e=i.publication)==null?void 0:e.track)<"u":!1}function iD(i){return i?i.hasOwnProperty("participant")&&i.hasOwnProperty("source")&&i.hasOwnProperty("publication")&&typeof i.publication<"u":!1}function aD(i){return i?i.hasOwnProperty("participant")&&i.hasOwnProperty("source")&&typeof i.publication>"u":!1}function rD(i){if(typeof i=="string"||typeof i=="number")return`${i}`;if(aD(i))return`${i.participant.identity}_${i.source}_placeholder`;if(Bh(i))return`${i.participant.identity}_${i.publication.source}_${i.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${i}`)}var sD=[H.ConnectionStateChanged,H.RoomMetadataChanged,H.ActiveSpeakersChanged,H.ConnectionQualityChanged,H.ParticipantConnected,H.ParticipantDisconnected,H.ParticipantPermissionsChanged,H.ParticipantMetadataChanged,H.ParticipantNameChanged,H.ParticipantAttributesChanged,H.TrackMuted,H.TrackUnmuted,H.TrackPublished,H.TrackUnpublished,H.TrackStreamStateChanged,H.TrackSubscriptionFailed,H.TrackSubscriptionPermissionChanged,H.TrackSubscriptionStatusChanged],oT=[...sD,H.LocalTrackPublished,H.LocalTrackUnpublished];ee.TrackPublished,ee.TrackUnpublished,ee.TrackMuted,ee.TrackUnmuted,ee.TrackStreamStateChanged,ee.TrackSubscribed,ee.TrackUnsubscribed,ee.TrackSubscriptionPermissionChanged,ee.TrackSubscriptionFailed,ee.LocalTrackPublished,ee.LocalTrackUnpublished;var oD=[ee.ConnectionQualityChanged,ee.IsSpeakingChanged,ee.ParticipantMetadataChanged,ee.ParticipantPermissionsChanged,ee.TrackMuted,ee.TrackUnmuted,ee.TrackPublished,ee.TrackUnpublished,ee.TrackStreamStateChanged,ee.TrackSubscriptionFailed,ee.TrackSubscriptionPermissionChanged,ee.TrackSubscriptionStatusChanged];[...oD,ee.LocalTrackPublished,ee.LocalTrackUnpublished];var Mt=oA.getLogger("lk-components-js");Mt.setDefaultLevel("WARN");var zh=(i=>(i.AgentState="lk.agent.state",i.PublishOnBehalf="lk.publish_on_behalf",i.TranscriptionFinal="lk.transcription_final",i.TranscriptionSegmentId="lk.segment_id",i.TranscribedTrackId="lk.transcribed_track_id",i))(zh||{});function cT(i){return typeof i=="object"}function lT(i){return Array.isArray(i)&&i.filter(cT).length>0}function cD(i){return`${tD}-${i}`}function lD(i){const e=$f(i),n=fT(i.participant).pipe(zr(()=>$f(i)),qr(e));return{className:cD(i.source===J.Source.Camera||i.source===J.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function $f(i){if(Bh(i))return i.publication;{const{source:e,name:n,participant:r}=i;if(e&&n)return r.getTrackPublications().find(o=>o.source===e&&o.trackName===n);if(n)return r.getTrackPublicationByName(n);if(e)return r.getTrackPublication(e);throw new Error("At least one of source and name needs to be defined")}}function uT(i,...e){return new xt(n=>{const r=()=>{n.next(i)};return e.forEach(o=>{i.on(o,r)}),()=>{e.forEach(o=>{i.off(o,r)})}}).pipe(qr(i))}function dT(i,e){return new xt(n=>{const r=(...o)=>{n.next(o)};return i.on(e,r),()=>{i.off(e,r)}})}function uD(i){return dT(i,H.ConnectionStateChanged).pipe(zr(([e])=>e),qr(i.state))}function dD(i){return dT(i,H.DataReceived)}function fD(i,...e){return new xt(n=>{const r=()=>{n.next(i)};return e.forEach(o=>{i.on(o,r)}),()=>{e.forEach(o=>{i.off(o,r)})}}).pipe(qr(i))}function fT(i){return fD(i,ee.TrackMuted,ee.TrackUnmuted,ee.ParticipantPermissionsChanged,ee.TrackPublished,ee.TrackUnpublished,ee.LocalTrackPublished,ee.LocalTrackUnpublished,ee.MediaDevicesError,ee.TrackSubscriptionStatusChanged).pipe(zr(e=>{const{isMicrophoneEnabled:n,isCameraEnabled:r,isScreenShareEnabled:o}=e,c=e.getTrackPublication(J.Source.Microphone),d=e.getTrackPublication(J.Source.Camera);return{isCameraEnabled:r,isMicrophoneEnabled:n,isScreenShareEnabled:o,cameraTrack:d,microphoneTrack:c,participant:e}}))}function hD(i,e={}){var n;let r;const o=new xt(f=>(r=f,()=>u.unsubscribe())).pipe(qr(Array.from(i.remoteParticipants.values()))),c=(n=e.additionalRoomEvents)!=null?n:oT,d=Array.from(new Set([H.ParticipantConnected,H.ParticipantDisconnected,H.ConnectionStateChanged,...c])),u=uT(i,...d).subscribe(f=>r?.next(Array.from(f.remoteParticipants.values())));return i.remoteParticipants.size>0&&r?.next(Array.from(i.remoteParticipants.values())),o}var mD={TRANSCRIPTION:"lk.transcription"};function pD(i,e){return jh(this,arguments,function*(n,r,o={}){const{reliable:c,destinationIdentities:d,topic:u}=o;yield n.publishData(r,{destinationIdentities:d,topic:u,reliable:c})})}function gD(i,e,n){const r=Array.isArray(e)?e:[e],o=dD(i).pipe(HA(([,,,u])=>u!==void 0&&r.includes(u)),zr(([u,f,,h])=>{const g={payload:u,topic:h,from:f};return n?.(g),g}));let c;const d=new xt(u=>{c=u});return{messageObservable:o,isSendingObservable:d,send:(u,...f)=>jh(this,[u,...f],function*(h,g={}){c.next(!0);try{yield pD(i.localParticipant,h,sT({topic:r[0]},g))}finally{c.next(!1)}})}}function vD(){return{className:"lk-room-container"}}function _0(i,e,n=!0){const r=[i.localParticipant,...Array.from(i.remoteParticipants.values())],o=[];return r.forEach(c=>{e.forEach(d=>{const u=Array.from(c.trackPublications.values()).filter(f=>f.source===d&&(!n||f.track)).map(f=>({participant:c,publication:f,source:f.source}));o.push(...u)})}),{trackReferences:o,participants:r}}function yD(i,e,n){var r,o;const c=(r=n.additionalRoomEvents)!=null?r:oT,d=(o=n.onlySubscribed)!=null?o:!0,u=Array.from(new Set([H.ParticipantConnected,H.ParticipantDisconnected,H.ConnectionStateChanged,H.LocalTrackPublished,H.LocalTrackUnpublished,H.TrackPublished,H.TrackUnpublished,H.TrackSubscriptionStatusChanged,...c]).values());return uT(i,...u).pipe(zr(f=>{const h=_0(f,e,d);return Mt.debug(`TrackReference[] was updated. (length ${h.trackReferences.length})`,h),h}),qr(_0(i,e,d)))}var Tf=null,Cf=null,bD=0;function R0(){return Tf||(Tf=new Map),Tf}function SD(){return Cf||(Cf=new WeakMap),Cf}function TD(i,e){const n=SD();let r=n.get(i);return r||(r=`room_${bD++}`,n.set(i,r)),`${r}:${e}`}function CD(i,e){const n=TD(i,e),r=R0(),o=r.get(n);if(o)return o;const c=new kl;let d=[];const u="lk.segment_id",f=c.pipe(JA({subscribe:()=>{i.registerTextStreamHandler(e,(h,g)=>jh(this,null,function*(){var v;const b=aT(h).pipe(YA((_,C)=>_+C,"")),T=!!((v=h.info.attributes)!=null&&v[u]);b.subscribe(_=>{const C=d.findIndex(M=>{var R,B;return M.streamInfo.id===h.info.id||T&&((R=M.streamInfo.attributes)==null?void 0:R[u])===((B=h.info.attributes)==null?void 0:B[u])});C!==-1?(d[C]=eD(sT({},d[C]),{text:_}),c.next([...d])):(d.push({text:_,participantInfo:g,streamInfo:h.info}),c.next([...d]))})}))},finalize:()=>{i.unregisterTextStreamHandler(e)}}),KA());return r.set(n,f),i.on(H.Disconnected,()=>{R0().delete(n),d=[],c.next([])}),f}A.createContext(void 0);const kD=A.createContext(void 0);function ED(){return A.useContext(kD)}function hT(i){const e=ED(),n=i??e;if(!n)throw new Error("No TrackRef, make sure you are inside a TrackRefContext or pass the TrackRef explicitly");return n}A.createContext(void 0);const qh=A.createContext(void 0);function _D(){const i=A.useContext(qh);if(!i)throw Error("tried to access room context outside of livekit room component");return i}function RD(){return A.useContext(qh)}function lo(i){const e=RD(),n=i??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}A.createContext(void 0);const wD=A.createContext(void 0);function mT(i){var e,n,r="";if(typeof i=="string"||typeof i=="number")r+=i;else if(typeof i=="object")if(Array.isArray(i)){var o=i.length;for(e=0;e<o;e++)i[e]&&(n=mT(i[e]))&&(r&&(r+=" "),r+=n)}else for(n in i)i[n]&&(r&&(r+=" "),r+=n);return r}function OD(){for(var i,e,n=0,r="",o=arguments.length;n<o;n++)(i=arguments[n])&&(e=mT(i))&&(r&&(r+=" "),r+=e);return r}function AD(...i){return(...e)=>{for(const n of i)if(typeof n=="function")try{n(...e)}catch(r){console.error(r)}}}function pT(...i){const e={...i[0]};for(let n=1;n<i.length;n++){const r=i[n];for(const o in r){const c=e[o],d=r[o];typeof c=="function"&&typeof d=="function"&&o[0]==="o"&&o[1]==="n"&&o.charCodeAt(2)>=65&&o.charCodeAt(2)<=90?e[o]=AD(c,d):(o==="className"||o==="UNSAFE_className")&&typeof c=="string"&&typeof d=="string"?e[o]=OD(c,d):e[o]=d!==void 0?d:c}}return e}function DD(i){return i!==void 0}function MD(...i){return pT(...i.filter(DD))}function xD(i,e){return i==="processor"&&e&&typeof e=="object"&&"name"in e?e.name:i==="e2ee"&&e?"e2ee-enabled":e}const PD={connect:!0,audio:!1,video:!1};function ND(i){const{token:e,serverUrl:n,options:r,room:o,connectOptions:c,connect:d,audio:u,video:f,screen:h,onConnected:g,onDisconnected:v,onError:b,onMediaDeviceFailure:T,onEncryptionError:_,simulateParticipants:C,...M}={...PD,...i};r&&o&&Mt.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[R,B]=A.useState(),q=A.useRef(d);A.useEffect(()=>{B(o??new Nr(r))},[o,JSON.stringify(r,xD)]);const E=A.useMemo(()=>{const{className:k}=vD();return pT(M,{className:k})},[M]);return A.useEffect(()=>{if(!R)return;const k=()=>{const Q=R.localParticipant;Mt.debug("trying to publish local tracks"),Promise.all([Q.setMicrophoneEnabled(!!u,typeof u!="boolean"?u:void 0),Q.setCameraEnabled(!!f,typeof f!="boolean"?f:void 0),Q.setScreenShareEnabled(!!h,typeof h!="boolean"?h:void 0)]).catch(W=>{Mt.warn(W),b?.(W)})},D=(Q,W)=>{const ie=$s.getFailure(Q);T?.(ie,W)},L=Q=>{_?.(Q)},K=Q=>{v?.(Q)},G=()=>{g?.()};return R.on(H.SignalConnected,k).on(H.MediaDevicesError,D).on(H.EncryptionError,L).on(H.Disconnected,K).on(H.Connected,G),()=>{R.off(H.SignalConnected,k).off(H.MediaDevicesError,D).off(H.EncryptionError,L).off(H.Disconnected,K).off(H.Connected,G)}},[R,u,f,h,b,_,T,g,v]),A.useEffect(()=>{if(R){if(C){R.simulateParticipants({participants:{count:C},publish:{audio:!0,useRealTracks:!0}});return}if(d){if(q.current=!0,Mt.debug("connecting"),!e){Mt.debug("no token yet");return}if(!n){Mt.warn("no livekit url provided"),b?.(Error("no livekit url provided"));return}R.connect(n,e,c).catch(k=>{Mt.warn(k),q.current===!0&&b?.(k)})}else Mt.debug("disconnecting because connect is false"),q.current=!1,R.disconnect()}},[d,e,JSON.stringify(c),R,b,n,C]),A.useEffect(()=>{if(R)return()=>{Mt.info("disconnecting on onmount"),R.disconnect()}},[R]),{room:R,htmlProps:E}}const LD=A.forwardRef(function(i,e){const{room:n,htmlProps:r}=ND(i);return A.createElement("div",{ref:e,...r},n&&A.createElement(qh.Provider,{value:n},A.createElement(wD.Provider,{value:i.featureFlags},i.children)))});function ul(i,e,n=!0){const[r,o]=A.useState(e);return A.useEffect(()=>{if(n&&o(e),typeof window>"u"||!i)return;const c=i.subscribe(o);return()=>c.unsubscribe()},[i,n]),r}function UD(i){const e=lo(i),n=A.useMemo(()=>uD(e),[e]);return ul(n,e.state)}function gM(i,e){const n=e,r=i,o=_D(),{send:c,messageObservable:d,isSendingObservable:u}=A.useMemo(()=>gD(o,r,n),[o,r,n]),f=ul(d,void 0),h=ul(u,!1);return{message:f,send:c,isSending:h}}function ID(i={}){const e=lo(i.room),[n,r]=A.useState(e.localParticipant),[o,c]=A.useState(n.isMicrophoneEnabled),[d,u]=A.useState(n.isCameraEnabled),[f,h]=A.useState(n.isScreenShareEnabled),[g,v]=A.useState(n.lastMicrophoneError),[b,T]=A.useState(n.lastCameraError),[_,C]=A.useState(void 0),[M,R]=A.useState(void 0),B=q=>{u(q.isCameraEnabled),c(q.isMicrophoneEnabled),h(q.isScreenShareEnabled),R(q.cameraTrack),C(q.microphoneTrack),v(q.participant.lastMicrophoneError),T(q.participant.lastCameraError),r(q.participant)};return A.useEffect(()=>{const q=fT(e.localParticipant).subscribe(B);return()=>q.unsubscribe()},[e]),{isMicrophoneEnabled:o,isScreenShareEnabled:f,isCameraEnabled:d,microphoneTrack:_,cameraTrack:M,lastMicrophoneError:g,lastCameraError:b,localParticipant:n}}function jD(i={}){const e=lo(i.room),[n,r]=A.useState([]);return A.useEffect(()=>{const o=hD(e,{additionalRoomEvents:i.updateOnlyOn}).subscribe(r);return()=>o.unsubscribe()},[e,JSON.stringify(i.updateOnlyOn)]),n}function vM(i={}){const e=jD(i),{localParticipant:n}=ID(i);return A.useMemo(()=>[n,...e],[n,e])}function BD(i=[J.Source.Camera,J.Source.Microphone,J.Source.ScreenShare,J.Source.ScreenShareAudio,J.Source.Unknown],e={}){const n=lo(e.room),[r,o]=A.useState([]),[c,d]=A.useState([]),u=A.useMemo(()=>i.map(f=>cT(f)?f.source:f),[JSON.stringify(i)]);return A.useEffect(()=>{const f=yD(n,u,{additionalRoomEvents:e.updateOnlyOn,onlySubscribed:e.onlySubscribed}).subscribe(({trackReferences:h,participants:g})=>{Mt.debug("setting track bundles",h,g),o(h),d(g)});return()=>f.unsubscribe()},[n,JSON.stringify(e.onlySubscribed),JSON.stringify(e.updateOnlyOn),JSON.stringify(i)]),A.useMemo(()=>{if(lT(i)){const f=qD(i,c),h=Array.from(r);return c.forEach(g=>{f.has(g.identity)&&(f.get(g.identity)??[]).forEach(v=>{if(r.find(({participant:T,publication:_})=>g.identity===T.identity&&_.source===v))return;Mt.debug(`Add ${v} placeholder for participant ${g.identity}.`);const b={participant:g,source:v};h.push(b)})}),h}else return r},[r,c,i])}function zD(i,e){const n=new Set(i);for(const r of e)n.delete(r);return n}function qD(i,e){const n=new Map;if(lT(i)){const r=i.filter(o=>o.withPlaceholder).map(o=>o.source);e.forEach(o=>{const c=o.getTrackPublications().map(u=>{var f;return(f=u.track)==null?void 0:f.source}).filter(u=>u!==void 0),d=Array.from(zD(new Set(r),new Set(c)));d.length>0&&n.set(o.identity,d)})}return n}zh.AgentState;function VD(i,e){const n=lo(e?.room),r=UD(n)===Ie.Disconnected,o=A.useMemo(()=>CD(n,i),[n,i]);return{textStreams:ul(r?void 0:o,[])}}function yM(i){const{participantIdentities:e,trackSids:n}=i??{},{textStreams:r}=VD(mD.TRANSCRIPTION,{room:i?.room});return A.useMemo(()=>r.filter(o=>e?e.includes(o.participantInfo.identity):!0).filter(o=>{var c;return n?n.includes(((c=o.streamInfo.attributes)==null?void 0:c[zh.TranscribedTrackId])??""):!0}),[r,e,n])}var Nc={exports:{}},w0;function FD(){if(w0)return Nc.exports;w0=1;var i=typeof Reflect=="object"?Reflect:null,e=i&&typeof i.apply=="function"?i.apply:function(E,k,D){return Function.prototype.apply.call(E,k,D)},n;i&&typeof i.ownKeys=="function"?n=i.ownKeys:Object.getOwnPropertySymbols?n=function(E){return Object.getOwnPropertyNames(E).concat(Object.getOwnPropertySymbols(E))}:n=function(E){return Object.getOwnPropertyNames(E)};function r(E){console&&console.warn&&console.warn(E)}var o=Number.isNaN||function(E){return E!==E};function c(){c.init.call(this)}Nc.exports=c,Nc.exports.once=R,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var d=10;function u(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(E){if(typeof E!="number"||E<0||o(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");d=E}}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(E){if(typeof E!="number"||E<0||o(E))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+E+".");return this._maxListeners=E,this};function f(E){return E._maxListeners===void 0?c.defaultMaxListeners:E._maxListeners}c.prototype.getMaxListeners=function(){return f(this)},c.prototype.emit=function(E){for(var k=[],D=1;D<arguments.length;D++)k.push(arguments[D]);var L=E==="error",K=this._events;if(K!==void 0)L=L&&K.error===void 0;else if(!L)return!1;if(L){var G;if(k.length>0&&(G=k[0]),G instanceof Error)throw G;var Q=new Error("Unhandled error."+(G?" ("+G.message+")":""));throw Q.context=G,Q}var W=K[E];if(W===void 0)return!1;if(typeof W=="function")e(W,this,k);else for(var ie=W.length,ve=_(W,ie),D=0;D<ie;++D)e(ve[D],this,k);return!0};function h(E,k,D,L){var K,G,Q;if(u(D),G=E._events,G===void 0?(G=E._events=Object.create(null),E._eventsCount=0):(G.newListener!==void 0&&(E.emit("newListener",k,D.listener?D.listener:D),G=E._events),Q=G[k]),Q===void 0)Q=G[k]=D,++E._eventsCount;else if(typeof Q=="function"?Q=G[k]=L?[D,Q]:[Q,D]:L?Q.unshift(D):Q.push(D),K=f(E),K>0&&Q.length>K&&!Q.warned){Q.warned=!0;var W=new Error("Possible EventEmitter memory leak detected. "+Q.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");W.name="MaxListenersExceededWarning",W.emitter=E,W.type=k,W.count=Q.length,r(W)}return E}c.prototype.addListener=function(E,k){return h(this,E,k,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(E,k){return h(this,E,k,!0)};function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(E,k,D){var L={fired:!1,wrapFn:void 0,target:E,type:k,listener:D},K=g.bind(L);return K.listener=D,L.wrapFn=K,K}c.prototype.once=function(E,k){return u(k),this.on(E,v(this,E,k)),this},c.prototype.prependOnceListener=function(E,k){return u(k),this.prependListener(E,v(this,E,k)),this},c.prototype.removeListener=function(E,k){var D,L,K,G,Q;if(u(k),L=this._events,L===void 0)return this;if(D=L[E],D===void 0)return this;if(D===k||D.listener===k)--this._eventsCount===0?this._events=Object.create(null):(delete L[E],L.removeListener&&this.emit("removeListener",E,D.listener||k));else if(typeof D!="function"){for(K=-1,G=D.length-1;G>=0;G--)if(D[G]===k||D[G].listener===k){Q=D[G].listener,K=G;break}if(K<0)return this;K===0?D.shift():C(D,K),D.length===1&&(L[E]=D[0]),L.removeListener!==void 0&&this.emit("removeListener",E,Q||k)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(E){var k,D,L;if(D=this._events,D===void 0)return this;if(D.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):D[E]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete D[E]),this;if(arguments.length===0){var K=Object.keys(D),G;for(L=0;L<K.length;++L)G=K[L],G!=="removeListener"&&this.removeAllListeners(G);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(k=D[E],typeof k=="function")this.removeListener(E,k);else if(k!==void 0)for(L=k.length-1;L>=0;L--)this.removeListener(E,k[L]);return this};function b(E,k,D){var L=E._events;if(L===void 0)return[];var K=L[k];return K===void 0?[]:typeof K=="function"?D?[K.listener||K]:[K]:D?M(K):_(K,K.length)}c.prototype.listeners=function(E){return b(this,E,!0)},c.prototype.rawListeners=function(E){return b(this,E,!1)},c.listenerCount=function(E,k){return typeof E.listenerCount=="function"?E.listenerCount(k):T.call(E,k)},c.prototype.listenerCount=T;function T(E){var k=this._events;if(k!==void 0){var D=k[E];if(typeof D=="function")return 1;if(D!==void 0)return D.length}return 0}c.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function _(E,k){for(var D=new Array(k),L=0;L<k;++L)D[L]=E[L];return D}function C(E,k){for(;k+1<E.length;k++)E[k]=E[k+1];E.pop()}function M(E){for(var k=new Array(E.length),D=0;D<k.length;++D)k[D]=E[D].listener||E[D];return k}function R(E,k){return new Promise(function(D,L){function K(Q){E.removeListener(k,G),L(Q)}function G(){typeof E.removeListener=="function"&&E.removeListener("error",K),D([].slice.call(arguments))}q(E,k,G,{once:!0}),k!=="error"&&B(E,K,{once:!0})})}function B(E,k,D){typeof E.on=="function"&&q(E,"error",k,D)}function q(E,k,D,L){if(typeof E.on=="function")L.once?E.once(k,D):E.on(k,D);else if(typeof E.addEventListener=="function")E.addEventListener(k,function K(G){L.once&&E.removeEventListener(k,K),D(G)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return Nc.exports}FD();function gT(i,e={}){const[n,r]=A.useState($f(i)),[o,c]=A.useState(n?.isMuted),[d,u]=A.useState(n?.isSubscribed),[f,h]=A.useState(n?.track),[g,v]=A.useState("landscape"),b=A.useRef(),{className:T,trackObserver:_}=A.useMemo(()=>lD(i),[i.participant.sid??i.participant.identity,i.source,Bh(i)&&i.publication.trackSid]);return A.useEffect(()=>{const C=_.subscribe(M=>{Mt.debug("update track",M),r(M),c(M?.isMuted),u(M?.isSubscribed),h(M?.track)});return()=>C?.unsubscribe()},[_]),A.useEffect(()=>{var C,M;return f&&(b.current&&f.detach(b.current),(C=e.element)!=null&&C.current&&!(i.participant.isLocal&&f?.kind==="audio")&&f.attach(e.element.current)),b.current=(M=e.element)==null?void 0:M.current,()=>{b.current&&f?.detach(b.current)}},[f,e.element]),A.useEffect(()=>{var C,M;if(typeof((C=n?.dimensions)==null?void 0:C.width)=="number"&&typeof((M=n?.dimensions)==null?void 0:M.height)=="number"){const R=n.dimensions.width>n.dimensions.height?"landscape":"portrait";v(R)}},[n]),{publication:n,isMuted:o,isSubscribed:d,track:f,elementProps:MD(e.props,{className:T,"data-lk-local-participant":i.participant.isLocal,"data-lk-source":n?.source,...n?.kind==="video"&&{"data-lk-orientation":g}})}}var kf,O0;function HD(){if(O0)return kf;O0=1;var i="Expected a function",e=NaN,n="[object Symbol]",r=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,d=/^0o[0-7]+$/i,u=parseInt,f=typeof xc=="object"&&xc&&xc.Object===Object&&xc,h=typeof self=="object"&&self&&self.Object===Object&&self,g=f||h||Function("return this")(),v=Object.prototype,b=v.toString,T=Math.max,_=Math.min,C=function(){return g.Date.now()};function M(k,D,L){var K,G,Q,W,ie,ve,Ne=0,tt=!1,V=!1,ae=!0;if(typeof k!="function")throw new TypeError(i);D=E(D)||0,R(L)&&(tt=!!L.leading,V="maxWait"in L,Q=V?T(E(L.maxWait)||0,D):Q,ae="trailing"in L?!!L.trailing:ae);function ue(me){var Ze=K,Ge=G;return K=G=void 0,Ne=me,W=k.apply(Ge,Ze),W}function Me(me){return Ne=me,ie=setTimeout(X,D),tt?ue(me):W}function xe(me){var Ze=me-ve,Ge=me-Ne,Si=D-Ze;return V?_(Si,Q-Ge):Si}function P(me){var Ze=me-ve,Ge=me-Ne;return ve===void 0||Ze>=D||Ze<0||V&&Ge>=Q}function X(){var me=C();if(P(me))return se(me);ie=setTimeout(X,xe(me))}function se(me){return ie=void 0,ae&&K?ue(me):(K=G=void 0,W)}function oe(){ie!==void 0&&clearTimeout(ie),Ne=0,K=ve=G=ie=void 0}function pe(){return ie===void 0?W:se(C())}function ge(){var me=C(),Ze=P(me);if(K=arguments,G=this,ve=me,Ze){if(ie===void 0)return Me(ve);if(V)return ie=setTimeout(X,D),ue(ve)}return ie===void 0&&(ie=setTimeout(X,D)),W}return ge.cancel=oe,ge.flush=pe,ge}function R(k){var D=typeof k;return!!k&&(D=="object"||D=="function")}function B(k){return!!k&&typeof k=="object"}function q(k){return typeof k=="symbol"||B(k)&&b.call(k)==n}function E(k){if(typeof k=="number")return k;if(q(k))return e;if(R(k)){var D=typeof k.valueOf=="function"?k.valueOf():k;k=R(D)?D+"":D}if(typeof k!="string")return k===0?k:+k;k=k.replace(r,"");var L=c.test(k);return L||d.test(k)?u(k.slice(2),L?2:8):o.test(k)?e:+k}return kf=M,kf}var GD=HD();const A0=BS(GD);function YD(i){const e=A.useRef(i);e.current=i,A.useEffect(()=>()=>{e.current()},[])}function KD(i,e=500,n){const r=A.useRef();YD(()=>{r.current&&r.current.cancel()});const o=A.useMemo(()=>{const c=A0(i,e,n),d=(...u)=>c(...u);return d.cancel=()=>{c.cancel()},d.isPending=()=>!!r.current,d.flush=()=>c.flush(),d},[i,e,n]);return A.useEffect(()=>{r.current=A0(i,e,n)},[i,e,n]),o}function JD(i,e,n){const r=((h,g)=>h===g),o=i instanceof Function?i():i,[c,d]=A.useState(o),u=A.useRef(o),f=KD(d,e,n);return r(u.current,o)||(f(o),u.current=o),[c,f]}function QD({threshold:i=0,root:e=null,rootMargin:n="0%",freezeOnceVisible:r=!1,initialIsIntersecting:o=!1,onChange:c}={}){var d;const[u,f]=A.useState(null),[h,g]=A.useState(()=>({isIntersecting:o,entry:void 0})),v=A.useRef();v.current=c;const b=((d=h.entry)==null?void 0:d.isIntersecting)&&r;A.useEffect(()=>{if(!u||!("IntersectionObserver"in window)||b)return;const C=new IntersectionObserver(M=>{const R=Array.isArray(C.thresholds)?C.thresholds:[C.thresholds];M.forEach(B=>{const q=B.isIntersecting&&R.some(E=>B.intersectionRatio>=E);g({isIntersecting:q,entry:B}),v.current&&v.current(q,B)})},{threshold:i,root:e,rootMargin:n});return C.observe(u),()=>{C.disconnect()}},[u,JSON.stringify(i),e,n,b,r]);const T=A.useRef(null);A.useEffect(()=>{var C;!u&&(C=h.entry)!=null&&C.target&&!r&&!b&&T.current!==h.entry.target&&(T.current=h.entry.target,g({isIntersecting:o,entry:void 0}))},[u,h.entry,r,b,o]);const _=[f,!!h.isIntersecting,h.entry];return _.ref=_[0],_.isIntersecting=_[1],_.entry=_[2],_}const bM=A.forwardRef(function({onTrackClick:i,onClick:e,onSubscriptionStatusChanged:n,trackRef:r,manageSubscription:o,...c},d){const u=hT(r),f=A.useRef(null);A.useImperativeHandle(d,()=>f.current);const h=QD({root:f.current}),[g]=JD(h,3e3);A.useEffect(()=>{o&&u.publication instanceof ol&&g?.isIntersecting===!1&&h?.isIntersecting===!1&&u.publication.setSubscribed(!1)},[g,u,o]),A.useEffect(()=>{o&&u.publication instanceof ol&&h?.isIntersecting===!0&&u.publication.setSubscribed(!0)},[h,u,o]);const{elementProps:v,publication:b,isSubscribed:T}=gT(u,{element:f,props:c});A.useEffect(()=>{n?.(!!T)},[T,n]);const _=C=>{e?.(C),i?.({participant:u?.participant,track:b})};return A.createElement("video",{ref:f,...v,muted:!0,onClick:_})}),XD=A.forwardRef(function({trackRef:i,onSubscriptionStatusChanged:e,volume:n,...r},o){const c=hT(i),d=A.useRef(null);A.useImperativeHandle(o,()=>d.current);const{elementProps:u,isSubscribed:f,track:h,publication:g}=gT(c,{element:d,props:r});return A.useEffect(()=>{e?.(!!f)},[f,e]),A.useEffect(()=>{h===void 0||n===void 0||(h instanceof US?h.setVolume(n):Mt.warn("Volume can only be set on remote audio tracks."))},[n,h]),A.useEffect(()=>{g===void 0||r.muted===void 0||(g instanceof ol?g.setEnabled(!r.muted):Mt.warn("Can only call setEnabled on remote track publications."))},[r.muted,g,h]),A.createElement("audio",{ref:d,...u})});function ZD({room:i,volume:e,muted:n}){const r=BD([J.Source.Microphone,J.Source.ScreenShareAudio,J.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0,room:i}).filter(o=>!o.participant.isLocal&&o.publication.kind===J.Kind.Audio);return A.createElement("div",{style:{display:"none"}},r.map(o=>A.createElement(XD,{key:rD(o),trackRef:o,volume:e,muted:n})))}const WD=i=>{const e=Ur.c(10),{dotColor:n}=i,r=n===void 0?"white":n;let o;e[0]!==r?(o=Ce.jsx("div",{className:"w-[14px] h-[14px] rounded-full animate-flashing",style:{animationDelay:"0s",backgroundColor:r}}),e[0]=r,e[1]=o):o=e[1];let c;e[2]!==r?(c=Ce.jsx("div",{className:"w-[14px] h-[14px] rounded-full animate-flashing",style:{animationDelay:"0.3s",backgroundColor:r}}),e[2]=r,e[3]=c):c=e[3];let d;e[4]!==r?(d=Ce.jsx("div",{className:"w-[14px] h-[14px] rounded-full animate-flashing",style:{animationDelay:"0.6s",backgroundColor:r}}),e[4]=r,e[5]=d):d=e[5];let u;return e[6]!==o||e[7]!==c||e[8]!==d?(u=Ce.jsxs("div",{className:"flex gap-[5px] items-center justify-center h-6",children:[o,c,d]}),e[6]=o,e[7]=c,e[8]=d,e[9]=u):u=e[9],u},$D=A.lazy(()=>na(()=>import("./Welcome-DC8ELD-4.js"),__vite__mapDeps([0,1,2,3]))),eM=A.lazy(()=>na(()=>import("./CompanionSelection-DyEOJyFV.js"),[])),tM=A.lazy(()=>na(()=>import("./DeviceSetup-oJ8QZgtE.js"),__vite__mapDeps([4,2,3]))),nM=A.lazy(()=>na(()=>import("./Interview-F-x5qzTf.js"),__vite__mapDeps([5,3,6,2,7]))),iM=A.lazy(()=>na(()=>import("./TimeoutScreen-BstQl5j9.js").then(i=>i.a),__vite__mapDeps([6,2,7]))),aM=A.lazy(()=>na(()=>import("./GuidelinesScreen-BwtHJYIp.js"),__vite__mapDeps([8,2,7]))),rM=A.lazy(()=>na(()=>import("./Feedback-B2fP9KGz.js"),__vite__mapDeps([9,1,2,3]))),sM=A.lazy(()=>na(()=>import("./NotFound-BGpl-8_9.js"),[])),oM=()=>{const i=Ur.c(3),e=ih();let n,r;return i[0]!==e?(n=()=>{e(-1)},r=[e],i[0]=e,i[1]=n,i[2]=r):(n=i[1],r=i[2]),A.useEffect(n,r),null};let vT=!0;const cM=i=>{const e=Ur.c(1),{children:n}=i;if(vT){let r;return e[0]===Symbol.for("react.memo_cache_sentinel")?(r=Ce.jsx(oM,{}),e[0]=r):r=e[0],r}return n},lM=()=>{const i=Ur.c(26),{sessionData:e,selectedDevices:n}=aE();let r;i[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],i[0]=r):r=i[0],A.useEffect(uM,r);let o;i[1]===Symbol.for("react.memo_cache_sentinel")?(o=Ce.jsx("div",{className:"flex items-center justify-center h-screen bg-(--color-bg)",children:Ce.jsx(WD,{dotColor:"var(--color-primary)"})}),i[1]=o):o=i[1];let c;i[2]===Symbol.for("react.memo_cache_sentinel")?(c=Ce.jsx(ci,{path:"/interview/:sessionCode",element:Ce.jsx($D,{})}),i[2]=c):c=i[2];let d;i[3]!==e?(d=Ce.jsx(ci,{path:"/companion",element:e?Ce.jsx(eM,{}):Ce.jsx(oy,{to:"/",replace:!0})}),i[3]=e,i[4]=d):d=i[4];let u;i[5]!==e?(u=Ce.jsx(ci,{path:"/setup",element:e?Ce.jsx(tM,{}):Ce.jsx(oy,{to:"/",replace:!0})}),i[5]=e,i[6]=u):u=i[6];const f=e?.connection?.token,h=e?.connection?.serverUrl,g=n.mic?.deviceId;let v;i[7]!==g?(v={deviceId:g},i[7]=g,i[8]=v):v=i[8];const b=n.camera?.deviceId;let T;i[9]!==b?(T={deviceId:b},i[9]=b,i[10]=T):T=i[10];let _,C;i[11]===Symbol.for("react.memo_cache_sentinel")?(_=Ce.jsx(nM,{}),C=Ce.jsx(ZD,{}),i[11]=_,i[12]=C):(_=i[11],C=i[12]);let M;i[13]!==T||i[14]!==f||i[15]!==h||i[16]!==v?(M=Ce.jsx(ci,{path:"/interview",element:Ce.jsx(cM,{children:Ce.jsxs(LD,{token:f,serverUrl:h,connect:!0,audio:v,video:T,children:[_,C]})})}),i[13]=T,i[14]=f,i[15]=h,i[16]=v,i[17]=M):M=i[17];let R;i[18]===Symbol.for("react.memo_cache_sentinel")?(R=Ce.jsx(ci,{path:"/timeout",element:Ce.jsx(iM,{})}),i[18]=R):R=i[18];let B;i[19]===Symbol.for("react.memo_cache_sentinel")?(B=Ce.jsx(ci,{path:"/guidelines",element:Ce.jsx(aM,{})}),i[19]=B):B=i[19];let q;i[20]===Symbol.for("react.memo_cache_sentinel")?(q=Ce.jsx(ci,{path:"/feedback",element:Ce.jsx(rM,{})}),i[20]=q):q=i[20];let E;i[21]===Symbol.for("react.memo_cache_sentinel")?(E=Ce.jsx(ci,{path:"*",element:Ce.jsx(sM,{})}),i[21]=E):E=i[21];let k;return i[22]!==M||i[23]!==d||i[24]!==u?(k=Ce.jsx(A.Suspense,{fallback:o,children:Ce.jsxs(r1,{children:[c,d,u,M,R,B,q,E]})}),i[22]=M,i[23]=d,i[24]=u,i[25]=k):k=i[25],k};function uM(){vT=!1}function dM(){const i=Ur.c(1);let e;return i[0]===Symbol.for("react.memo_cache_sentinel")?(e=Ce.jsx(iE,{children:Ce.jsx(lM,{})}),i[0]=e):e=i[0],e}Zk.createRoot(document.getElementById("root")).render(Ce.jsx(A1,{basename:"/hireright-interview",children:Ce.jsx(dM,{})}));export{gM as A,bM as B,WD as D,ID as O,Nr as R,tE as S,J as T,vM as W,BD as Y,ih as a,aE as b,Ur as c,nE as d,eE as e,Cl as f,yM as g,_D as h,qk as i,Ce as j,Jk as k,fM as l,jD as p,A as r,hM as u};
